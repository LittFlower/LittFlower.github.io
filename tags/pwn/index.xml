<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Pwn on ä¸€åªèŠ±ç›†.</title>
    <link>http://littflower.github.io/tags/pwn/</link>
    <description>Recent content in Pwn on ä¸€åªèŠ±ç›†.</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Sun, 27 Apr 2025 15:50:55 +0800</lastBuildDate><atom:link href="http://littflower.github.io/tags/pwn/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>ACTF2025 WriteUps</title>
      <link>http://littflower.github.io/posts/actf2025-writeups/</link>
      <pubDate>Sun, 27 Apr 2025 15:50:55 +0800</pubDate>
      
      <guid>http://littflower.github.io/posts/actf2025-writeups/</guid>
      <description>æœ¬æ¬¡ ACTF æˆ‘åŸºæœ¬ä¸Š 24 h æ‰“æ»¡äº†ï¼Œé˜Ÿä¼é‡Œä¸€å…±å‡ºäº†ä¸‰é“ pwnï¼Œæˆ‘å‚ä¸åšäº†ä¸¤é“ï¼Œå¦å¤–ä¸€é“ qemu pwn æ²¡å‡ºï¼Œè¿™é‡Œå†™ä¸€ä¸‹ WriteUpã€‚
only_read é¢˜ç›®å¾ˆç®€æ´ï¼Œåªç»™äº†ä¸€ä¸ªä¸é™é•¿åº¦çš„ readï¼Œä¿æŠ¤å¦‚ä¸‹ï¼š
Arch: amd64-64-little RELRO: Partial RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x3fe000) RUNPATH: b&amp;#39;.&amp;#39; SHSTK: Enabled IBT: Enabled Stripped: No çœ‹åˆ°è¿™ä¸ªä¿æŠ¤è‚¯å®šæ˜¯æƒ³æ‰“ ret2dlresolve çš„ï¼Œä½†æ˜¯é¢˜ç›®é‡Œæ²¡æœ‰ pop rdi; ret è¿™ç§ gadgetï¼Œæ‰€ä»¥æˆ‘è¿™è¾¹çš„æ€è·¯æ˜¯æ‰“ magic gadgetã€‚
æˆ‘é€‰æ‹©äº†ä¸‹é¢è¿™ä¸¤æ¡ gadgetï¼š
libc é‡Œï¼š0x0000000000110a46: pop rbx; pop rbp; pop r12; pop r13; pop r14; ret; ç¨‹åºä¸­ï¼š0x000000000040111c : add dword ptr [rbp - 0x3d], ebx ; nop ; ret å…¶ä¸­ç¬¬ä¸€æ¡æ˜¯å› ä¸ºå€’æ•°ç¬¬ä¸‰å­—èŠ‚å’Œ libc ä¸­ read çš„åç§»æ˜¯ä¸€æ ·çš„ï¼Œä¸éœ€è¦æ›´å¤šçš„çˆ†ç ´ï¼Œç¬¬äºŒæ¡åˆ™æ˜¯ç»å…¸çš„ magic_gadgetï¼Œä¸¤æ¡é…åˆèµ·æ¥å¯ä»¥åšä¸€ä¸ªä»»æ„åœ°å€å†™åŸè¯­ã€‚</description>
    </item>
    
    <item>
      <title>RITsecCTF2025 WriteUp</title>
      <link>http://littflower.github.io/posts/ritsecctf2025-writeup/</link>
      <pubDate>Tue, 08 Apr 2025 10:28:47 +0800</pubDate>
      
      <guid>http://littflower.github.io/posts/ritsecctf2025-writeup/</guid>
      <description>è·Ÿ n1 junior çš„å¸ˆå‚…ä»¬ä¸€èµ·æ‰“äº†è¿™åœºæ¯”èµ›ï¼Œ4 é“å‡ºäº† 3 é“ï¼Œç®€å•è®°å½•ä¸€ä¸‹ã€‚
bit_burger æ€è·¯æ¯”è¾ƒç®€å•ï¼Œåˆ©ç”¨äº†å‡½æ•°è°ƒç”¨/è¿”å›åä¸ä¼šæ¸…ç†æ ˆç©ºé—´çš„ç‰¹æ€§ï¼Œå…ˆé€šè¿‡ç¬¬ä¸€ä¸ªä½æ“ä½œåœ¨æ ˆä¸Šæ„é€ ä¸€ä¸ª backdoor åœ°å€å‡ºæ¥ï¼Œç¬¬äºŒæ­¥ç›´æ¥è°ƒç”¨å°±å¯ä»¥äº†ã€‚
#!/usr/bin/env python3 from pwn import * from sys import argv proc = &amp;#34;bit_burger.bin_patched&amp;#34; context.log_level = &amp;#34;debug&amp;#34; context.binary = proc elf = ELF(proc, checksec=False) libc = ELF(&amp;#34;./libc.so.6&amp;#34;, checksec=False) io = remote(&amp;#34;binex-bitburger.ctf.ritsec.club&amp;#34;, 32200) if argv[1] == &amp;#39;r&amp;#39; else process(proc) if args.G: gdb.attach(io, &amp;#34;b *0x401598&amp;#34;) ogg = 0x401355 s = &amp;#34;0&amp;#34; + bin(ogg)[2:] for i in range(len(s)): if s[len(s) - i - 1] == &amp;#34;1&amp;#34;: io.</description>
    </item>
    
    <item>
      <title>Glibc Exit å‡½æ•°åˆ†æä¸åˆ©ç”¨</title>
      <link>http://littflower.github.io/posts/glibc-exit-function-analyze-and-attack/</link>
      <pubDate>Tue, 01 Apr 2025 00:59:36 +0800</pubDate>
      
      <guid>http://littflower.github.io/posts/glibc-exit-function-analyze-and-attack/</guid>
      <description>æºç åˆ†æ ç”¨çš„æºç æ˜¯ glibc 2.35 çš„ï¼Œå…·ä½“ç‰ˆæœ¬æ˜¯ Ubuntu GLIBC 2.35-0ubuntu3.9ï¼Œåœ¨ glibc all in one é‡Œå¯ä»¥ä¸‹è½½åˆ°ã€‚
è°ƒè¯•ä¿¡æ¯æˆ‘æ˜¯ç”¨ docker ä¸‹è½½çš„ï¼Œç„¶åæ‹·å‡ºæ¥åœ¨æˆ‘çš„ arch linux ä¸Šæ…¢æ…¢è°ƒè¯•ã€‚
exit å‡½æ•°å®šä¹‰åœ¨ glibc çš„ stdlib/exit.c ä¸­ï¼Œå¦‚ä¸‹ï¼š
void exit (int status) { __run_exit_handlers (status, &amp;amp;__exit_funcs, true, true); } libc_hidden_def (exit) æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„ç»“æ„ __exit_funcsï¼Œå¦‚ä¸‹ï¼š
enum { ef_free,	/* `ef_free&amp;#39; MUST be zero! */ ef_us, ef_on, ef_at, ef_cxa }; struct exit_function // ææ„å‡½æ•°çš„ç±»å‹ï¼Œå¯ä»¥æ˜¯ {ef_free, ef_us, ef_on, ef_at, ef_cxa} ä¹‹ä¸€ { // ef_free è¡¨ç¤ºæ­¤ä½ç½®ç©ºé—² // ef_us è¡¨ç¤ºæ­¤ä½ç½®è¢«å ç”¨ï¼Œä½†æ˜¯ä¸çŸ¥é“å‡½æ•°ç±»å‹ // ef_on ef_at ef_cxa éƒ½è¡¨ç¤ºäº†å…·ä½“çš„å‡½æ•°ç±»å‹ï¼Œå·®åˆ«åœ¨å‚æ•°ä¸Š /* `flavour&amp;#39; should be of type of the `enum&amp;#39; above but since we need this element in an atomic operation we have to use `long int&amp;#39;.</description>
    </item>
    
    <item>
      <title>UTCTF2025 Writeup</title>
      <link>http://littflower.github.io/posts/utctf2025-writeup/</link>
      <pubDate>Sun, 16 Mar 2025 00:44:32 +0800</pubDate>
      
      <guid>http://littflower.github.io/posts/utctf2025-writeup/</guid>
      <description>å›½èµ›å‰ä¸€å¤©çš„ä¸€ä¸ªå›½é™…èµ›ï¼Œè·Ÿ N1 junior çš„å¸ˆå‚…ä»¬ä¸€èµ·æ‰“ä¸€ä¸‹ã€‚
Tic Tac Toe å…¨éƒ½æ˜¯ getsï¼Œbaby pwn
æ— é™åˆ¶çš„æ ˆæº¢å‡ºå¯ä»¥éšä¾¿æ‰“ï¼Œæº¢å‡ºä¸€ä¸‹ï¼Œè¦†ç›–æ‰ player çš„é‚£ä¸ª int å°±å¯ä»¥ win äº†
æ²¡å†™ expï¼Œå°±ä¸è´´äº†ã€‚
RETirement Plan å­˜åœ¨ä¸€ä¸ªå¯¹å­—æ¯çš„æ£€æŸ¥ï¼Œ__ctype_b_loc è¿™ä¸ªå‡½æ•°è§åˆ°å‡ æ¬¡äº†ï¼Œå®ƒè¿”å›çš„æ˜¯æŒ‡å‘å­—ç¬¦å±æ€§è¡¨çš„æŒ‡é’ˆï¼Œä¸€èˆ¬å†™æ³•æ˜¯ (*__ctype_b_loc())[v5[i]] &amp;amp; 0x100ï¼Œå¯ä»¥ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚
é¢˜ç›®æœ‰ä¸ªæ— é™åˆ¶çš„ getsï¼Œè¿˜æœ‰ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œè€Œä¸”æ²¡å¼€ NXï¼Œæ‰€ä»¥å¯ä»¥å…ˆæ‰“å°ä¸€ä¸ªæ ˆåœ°å€ç„¶åè¿”å› mainï¼Œå†è¯»å…¥ shellcode åœ¨æ ˆä¸Šæ‰§è¡Œã€‚
#!/usr/bin/env python3 from pwn import * from sys import argv proc = &amp;#34;./shellcode_patched&amp;#34; context.log_level = &amp;#34;debug&amp;#34; context.binary = proc elf = ELF(proc, checksec=False) libc = ELF(&amp;#34;./libc.so.6&amp;#34;, checksec=False) io = remote(&amp;#39;challenge.utctf.live&amp;#39;,9009) if argv[1] == &amp;#39;r&amp;#39; else process(proc) if args.G: gdb.</description>
    </item>
    
    <item>
      <title>WinjaCTF2025 WriteUp</title>
      <link>http://littflower.github.io/posts/winjactf2025-writeup/</link>
      <pubDate>Mon, 03 Mar 2025 16:27:41 +0800</pubDate>
      
      <guid>http://littflower.github.io/posts/winjactf2025-writeup/</guid>
      <description>é€†å¤©æ¯”èµ›æ²¡æœ‰ pwn é¢˜ï¼Œæ— æ•Œäº†ã€‚
Aura å‰ä¸€å¤©é—®æˆ‘æ¥ä¸æ¥æ‰“ï¼Œæˆ‘ä¸€çœ‹ ctftime æƒé‡æœ‰ 13ï¼Œæ„Ÿè§‰è¿˜è¡Œï¼Œå°±æ¥æ‰“äº†ã€‚
ç»“æœä¸€ä¸Šå·
ğŸ‘´ï¼šæˆ‘ Pwn é¢˜å‘¢ï¼Ÿ
ğŸ‘´ï¼šåƒåœ¾æ¯”èµ›ã€‚
Auraï¼šåƒåœ¾æ¯”èµ›ã€‚
åæ¥ä» Reverse çš„åˆ†åŒºé‡Œç¿»å‡ºæ¥ä¸€é“ Pwn é¢˜ï¼Œé‚£å°±åšä¸€ä¸‹å§ã€‚
TheChamberofSecrets ç¨‹åºæ¯”è¾ƒç®€å•ï¼Œç»™äº†ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ²¡ç»™ libc ä¹‹ç±»çš„ï¼Œè¿™å…¶å®å¾ˆé€†å¤©ï¼Œåé¢ä¼šè€ƒã€‚
ida æ‰“å¼€ï¼š
__int64 __fastcall main(int a1, char **a2, char **a3) { _BYTE v4[36]; // [rsp+0h] [rbp-30h] BYREF _BYTE v5[4]; // [rsp+24h] [rbp-Ch] BYREF size_t len; // [rsp+28h] [rbp-8h] printf(&amp;#34;Say the Magic Word: &amp;#34;); __isoc99_scanf(&amp;#34;%s&amp;#34;, v5); len = getpagesize(); if ( mprotect((-len &amp;amp; &amp;amp;func1), len, 7) == -1 || mprotect((-len &amp;amp; &amp;amp;func2), len, 7) == -1 ) { perror(&amp;#34;mprotect&amp;#34;); return 1LL; } else { xor(&amp;amp;func1, xor, v5); if ( (func1)(v4) ) { xor(&amp;amp;func2, xor, v4); (func2)(); } else { puts(&amp;#34;Door remains locked!</description>
    </item>
    
    <item>
      <title>è¥¿æ¹–è®ºå‰‘ 2025 Pwn WriteUp</title>
      <link>http://littflower.github.io/posts/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91-2025-pwn-writeup/</link>
      <pubDate>Thu, 20 Feb 2025 08:22:27 +0800</pubDate>
      
      <guid>http://littflower.github.io/posts/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91-2025-pwn-writeup/</guid>
      <description>äººç”Ÿç¬¬ä¸€æ¬¡æ‰“è¥¿æ¹–è®ºå‰‘ï¼Œè™½ç„¶æ˜¯è·Ÿç€ 401 çš„å¸ˆå‚…åªçœ‹äº†çœ‹é¢˜ï¼Œä½†æ˜¯æ„Ÿè§‰è¿˜æ˜¯æœ‰ä¸€ç‚¹æ”¶è·çš„ã€‚
èµ›åå¤ç° ak äº†æœ¬åœºï¼Œåœ¨è¿™é‡Œè®°å½•ä¸€ä¸‹ã€‚
Vpwn æ¯”è¾ƒç®€å•çš„æ ˆè™šæ‹Ÿæœºï¼Œé€†å‘æ— éš¾åº¦ï¼Œç»™äº†ä»»æ„æ ˆåœ°å€è¯»å†™åŸè¯­ï¼Œå…ˆæ³„æ¼ libc ç„¶åä¿®æ”¹è¿”å›åœ°å€å³å¯ã€‚
#!/usr/bin/env python3 from pwn import * from sys import argv proc = &amp;#34;./Vpwn_patched&amp;#34; context.log_level = &amp;#34;debug&amp;#34; context.binary = proc elf = ELF(proc, checksec=False) libc = ELF(&amp;#34;./libc.so.6&amp;#34;, checksec=False) io = remote(&amp;#34;&amp;#34;, ) if argv[1] == &amp;#39;r&amp;#39; else process(proc) if args.G: gdb.attach(io, &amp;#34;&amp;#34;&amp;#34; decompiler connect ida --host localhost --port 3662 breakrva 0x17d0 &amp;#34;&amp;#34;&amp;#34;) def choose(op): io.sendlineafter(b&amp;#34;Enter your choice: &amp;#34;, str(op).encode()) def edit(idx, value): choose(1) io.</description>
    </item>
    
    <item>
      <title>Pwn éšæœºæ•°æ”»å‡»</title>
      <link>http://littflower.github.io/posts/pwn-random-attack/</link>
      <pubDate>Sat, 14 Dec 2024 18:09:23 +0800</pubDate>
      
      <guid>http://littflower.github.io/posts/pwn-random-attack/</guid>
      <description>ä»‹ç» éšæœºæ•°æ”»å‡»
ä¸»è¦é˜…è¯»äº† glibc rand ç›¸å…³çš„æºä»£ç ï¼Œæ€»ç»“ä¸€ä¸‹ CTF ä¸­å¸¸è§éšæœºæ•°æ”»å‡»æ‰‹æ³•ï¼Œä¸»è¦è¿˜æ˜¯æ‰“ä¼ªéšæœºæ•°é¢„æµ‹ã€‚
å¸¸è§å†™æ³• ä»¥ C è¯­è¨€çš„ rand() ä¸ºä¾‹ï¼Œä¸»è¦å†™æ³•å¦‚ä¸‹ï¼š
#include &amp;lt;stdlib.h&amp;gt; #include &amp;lt;stdio.h&amp;gt; #include &amp;lt;time.h&amp;gt; void gen_random_plus() { srand(time(0)); printf(&amp;#34;%d\n&amp;#34;, rand()); return; } int main() { int seed; srand(seed); printf(&amp;#34;%d\n&amp;#34;, rand()); return 0; } è°ƒç”¨ rand() å‡½æ•°ä¼šè¿”å›ä¸€ä¸ª [0,RAND_MAX] ä¸­çš„éšæœºéè´Ÿæ•´æ•°ï¼Œå…¶ä¸­ RAND_MAX æ˜¯æ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªå®ï¼Œåœ¨ Linux ç³»ç»Ÿä¸‹ RAND_MAX ç­‰äº $2^{31}-1$ã€‚å¯ä»¥ç”¨å–æ¨¡æ¥é™åˆ¶æ‰€ç”Ÿæˆçš„æ•°çš„å¤§å°ã€‚
ä½¿ç”¨ rand() éœ€è¦ä¸€ä¸ªéšæœºæ•°ç§å­ï¼Œå¯ä»¥ä½¿ç”¨ srand(seed) å‡½æ•°æ¥å°†éšæœºç§å­æ›´æ”¹ä¸º seedï¼Œå½“ç„¶ä¸åˆå§‹åŒ–ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚
åŒä¸€ç¨‹åºä½¿ç”¨ç›¸åŒçš„ seed ä¸¤æ¬¡è¿è¡Œï¼Œåœ¨åŒä¸€æœºå™¨ã€åŒä¸€ç¼–è¯‘å™¨ä¸‹ï¼Œéšæœºå‡ºçš„ç»“æœå°†ä¼šæ˜¯ç›¸åŒçš„ã€‚
æœ‰ä¸€ä¸ªé€‰æ‹©æ˜¯ä½¿ç”¨å½“å‰ç³»ç»Ÿæ—¶é—´æ¥ä½œä¸ºéšæœºç§å­ï¼šsrand(time(0))ã€‚
è¿˜æœ‰ç”¨ linux çš„ random å’Œ urandom è®¾å¤‡çš„ï¼Œå†™æ³•å¤§æ¦‚å¦‚ä¸‹ï¼š
#include &amp;lt;sys/types.h&amp;gt; #include &amp;lt;sys/stat.</description>
    </item>
    
    <item>
      <title>2024 å¼ºç½‘æ¯é’å°‘èµ›çº¿ä¸‹æ¸¸è®°</title>
      <link>http://littflower.github.io/posts/2024-qwbqs-final-travels/</link>
      <pubDate>Mon, 09 Dec 2024 16:23:39 +0800</pubDate>
      
      <guid>http://littflower.github.io/posts/2024-qwbqs-final-travels/</guid>
      <description>å»éƒ‘å·ç©äº†ä¸¤å¤©ï¼Œçº¿ä¸‹é¢äº†ä¸€å †å¸ˆå‚…
Day-? æœ¬æ¥éƒ½ä¸è®°å¾—è¿™ä¸ªäº‹æƒ…äº†ï¼Œä½†æ˜¯ Aura ä¸Šç¦»æ•£æ•°å­¦è¯¾çš„æ—¶å€™çªç„¶é—®æˆ‘æ¥ç€ï¼Œäºæ˜¯è·Ÿ Aura å’Œæ ‘æœ¨ä¸€èµ·ç»„é˜Ÿæ‰“äº†çº¿ä¸Šèµ›ã€‚
ä½†æ˜¯è¯åˆè¯´å›æ¥äº†ï¼ŒAura æ‰“çº¿ä¸Šé‚£å¤©å’•å’•äº†ï¼Œå»æ‰“ä»–é‚£ä¸ª b é¹åŸæ¯äº†ï¼Œå¯¼è‡´æˆ‘è·Ÿæ ‘æœ¨ 2 æ‰“ 3ï¼Œweb åŸºæœ¬ä¸Šæ²¡åšï¼Œå¥½åœ¨ä¸å½±å“è¿›çº¿ä¸‹ã€‚è¿™æ˜¯å‰è¯ã€‚
Day -1 æå‰ä¹°äº†é£å»éƒ‘å·çš„æœºç¥¨ï¼Œç”±äºæˆ‘ä¸æƒ³åœ¨é£æœºä¸Šåƒé‚£ä¸ª b é£æœºé¤ï¼Œæ‰€ä»¥ç‰¹æ„ä¹°äº†æ—©ä¸€ç‚¹çš„é£æœºï¼Œä½†æ˜¯æ—¶é—´éå¸¸é˜´é—´ï¼Œæ—©ä¸Š 7 ç‚¹å°±å¾—èµ°ï¼ŒAura è¯´è®©æˆ‘ 6 ç‚¹èµ·ï¼Œæœ‰ç‚¹å¹½é»˜å“ˆã€‚
æ™šä¸Šä¸¤ç‚¹ç¡çš„ã€‚
Day 0 ç»“æœå½“ç„¶æ˜¯èµ·ä¸äº†ä¸€ç‚¹
å®šäº†ä¸ªé—¹é“ƒï¼Œæ—©ä¸Šä¸ƒç‚¹çš„æ—¶å€™æŠŠå…¨å®¿èˆäººåµé†’äº†ï¼ˆï¼ˆ é—¹éº»äº†ã€‚
æå‰ä¸€ä¸ªå¤šå°æ—¶å°±æŠŠå€¼æœºä»€ä¹ˆçš„åŠå¥½äº†ï¼Œå’Œ Aura åœ¨æœºåœºé‡Œæ‰¾äº†ä¸€å®¶ KFCï¼Œåƒäº†é¡¿æ—©é¤ï¼ˆå¥½åƒè€Œä¸”ä»·æ ¼æ­£å¸¸ï¼‰ï¼Œæ‰“äº†ä¸¤æŠŠç‚‰çŸ³ï¼ŒæœŸé—´è¢«å·æ‹äº†ï¼ˆ
æ²¡äº‹ï¼Œæˆ‘ä¹Ÿæ‹äº† Auraï¼š
é—¹éº»äº†ã€‚
é£æœºä¸Šæ¯”è¾ƒæ— èŠï¼Œæˆ‘å› ä¸ºå®Œå…¨æ²¡ç¡é†’ï¼Œé£æœºä¸Šç»§ç»­ç¡ï¼Œaura åº”è¯¥ä¹Ÿåœ¨ç¡ã€‚
ä¸­åˆ 12 ç‚¹å·¦å³å‡ºæœºåœºï¼Œåå‡ºç§Ÿè½¦å»é…’åº—ã€‚æ¯”è¾ƒéš¾ç»·çš„æ˜¯é…’åº—ä½ç½®å¾ˆç¦»è°±ï¼Œä¸åœ¨å¸‚åŒºï¼Œæ‰“å‡ºç§Ÿè½¦è¿‡å»è¦ 160ã€‚
æˆ‘è·Ÿå¸æœºå¸ˆå‚…è¯´è¦å¼€å‘ç¥¨ï¼ˆä¸»åŠæ–¹æŠ¥é”€ï¼‰ï¼Œå¸ˆå‚…è¯´è½¦è´¹ 160 ç»™æˆ‘å¼€ 200 çš„ï¼Œç»™æˆ‘æ•´ä¹äº†ï¼ˆï¼ˆï¼ˆ
ä¸‹åˆåœ¨é…’åº—é‡Œæ”¶æ‹¾äº†ä¸€ä¸‹ã€‚è¿™ä¸ªæ—¶å€™åœºé¦†é‡Œè¿˜åœ¨æ‰“å¼ºç½‘æ¯ï¼Œæ‰“ç®—ç­‰ä»–ä»¬æ‰“å®Œäº†è¿‡å»æ‰¾å¸ˆå‚…ä»¬é¢åŸºã€‚äºæ˜¯æˆåŠŸé¢åŸºåˆ°äº† GZ å¸ˆå‚…ï¼Œç©ºç™½ï¼Œè¿˜æœ‰ miaotony å’Œ gets å¸ˆå‚…ï¼ˆ
æ²¡é¢åˆ° n1 çš„å¸ˆå‚…çœŸå¯æƒœ&amp;hellip;.
æ™šä¸Šåƒé¥­çš„æ—¶å€™ï¼Œæ²¾ Aura çš„å…‰ï¼Œé¢åˆ°äº†æ˜Ÿç›Ÿçš„å¸ˆå‚…ä»¬ï¼Œè¿˜è¦åˆ°äº†å¾®ä¿¡ï¼ˆï¼ˆä½†æ˜¯é¢çš„å¾ˆå°´å°¬ï¼Œå› ä¸ºå®Œå…¨ä¸ç†Ÿï¼ˆï¼ˆï¼ˆ
è¿˜æœ‰ä¸€äº›é€†å¤©å·æ‹å“¥ï¼ˆè¯´çš„å°±æ˜¯ä½ ï¼Œå¤šå¤šï¼
æ™šä¸Šç‰¹åˆ«éš¾ç»·ï¼Œå› ä¸ºæˆ‘å‘ç°æˆ‘è·Ÿæ ‘æœ¨ä»–ä»¬å­¦æ ¡çš„æŒ‡å¯¼è€å¸ˆä¸€ä¸ªæˆ¿é—´
ğŸ‘´ï¼šèƒ½ä¸èƒ½ç»™æˆ‘æ¢ä¸ªæˆ¿é—´å•Š&amp;hellip; çœŸæ˜¯ä¸€ç§’é’Ÿéƒ½å¾…ä¸ä¸‹å»äº†
æ™šç§‹ï¼šæ¥æˆ‘æˆ¿é—´ï¼Œæ•™ä½  awdp
ğŸ‘´ï¼šæˆ‘è¶…ä¹‰çˆ¶ï¼
å¥½å¥½å¥½ï¼Œäºæ˜¯å»æ™šç§‹å’Œ zjl çš„æˆ¿é—´ï¼Œå­¦äº†ä¸€ä¼š awdpï¼Œç„¶åèŠäº†ä¸€ä¸‹å‘å±•è§„åˆ’ï¼ˆï¼ˆ</description>
    </item>
    
    <item>
      <title>Qemu Pwn å…¥é—¨ä¸è°ƒè¯•</title>
      <link>http://littflower.github.io/posts/qemu-pwn-debug-trick/</link>
      <pubDate>Sat, 30 Nov 2024 17:44:58 +0800</pubDate>
      
      <guid>http://littflower.github.io/posts/qemu-pwn-debug-trick/</guid>
      <description>å‰ç½®çŸ¥è¯† MMIO å’Œ PMIO æ˜¯ CPU å’Œå¤–éƒ¨è®¾å¤‡ä¹‹é—´ä¸¤ç§äº’ä¸ºè¡¥å……çš„ I/O æ–¹æ³•ã€‚
MMIO (Memory-mapped I/O) PMIO (Port-mapped I/O) MMIO è®© CPU è®¿é—®å¤–éƒ¨è®¾å¤‡å°±åƒè®¿é—®ç£ç›˜è™šæ‹Ÿå†…å­˜ç©ºé—´ä¸€æ ·æ–¹ä¾¿ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå†…å­˜å’Œ I/O è®¾å¤‡å…±äº«åŒä¸€ä¸ªåœ°å€ç©ºé—´ã€‚å½“ CPU ä½¿ç”¨ MMU å°†è™šæ‹Ÿå†…å­˜ç©ºé—´åœ°å€è½¬åŒ–æ—¶ï¼Œå¯ä»¥è½¬åŒ–æˆç‰©ç†å†…å­˜ç©ºé—´åœ°å€ã€ä¹Ÿå¯ä»¥è½¬åŒ–æˆ I/O è®¾å¤‡çš„å†…å­˜ã€‚å› æ­¤ï¼Œç”¨äºè®¿é—®å†…å­˜çš„CPUæŒ‡ä»¤ä¹Ÿå¯æ¥è®¿é—®I/Oè®¾å¤‡ã€‚æ¯ä¸ªI/Oè®¾å¤‡ç›‘è§†CPUçš„åœ°å€æ€»çº¿ï¼Œä¸€æ—¦CPUè®¿é—®åˆ†é…ç»™å®ƒçš„åœ°å€ï¼Œå®ƒå°±åšå‡ºå“åº”ï¼Œå°†æ•°æ®æ€»çº¿è¿æ¥åˆ°éœ€è¦è®¿é—®çš„è®¾å¤‡ç¡¬ä»¶å¯„å­˜å™¨ã€‚ä¸ºäº†å®¹çº³ I/O è®¾å¤‡ï¼ŒCPU å¿…é¡»é¢„ç•™ç»™ I/O ä¸€ä¸ªåœ°å€åŒºåŸŸï¼Œè¯¥åœ°å€åŒºåŸŸä¸èƒ½ç»™ç‰©ç†å†…å­˜ä½¿ç”¨ã€‚
PMIO åœ¨ç«¯å£æ˜ å°„ IO ä¸­ï¼Œå†…å­˜å’Œ I/O è®¾å¤‡æœ‰å„è‡ªçš„åœ°å€ç©ºé—´ï¼ŒPMIO ä¼šä½¿ç”¨ç‰¹æ®Šçš„ CPU æŒ‡ä»¤ä¸“é—¨æ‰§è¡Œ I/O æ“ä½œï¼ŒI/Oè®¾å¤‡æœ‰ä¸€ä¸ªä¸å†…å­˜ä¸åŒçš„åœ°å€ç©ºé—´ï¼Œä¸ºäº†å®ç°åœ°å€ç©ºé—´çš„éš”ç¦»ï¼Œè¦ä¹ˆåœ¨CPUç‰©ç†æ¥å£ä¸Šå¢åŠ ä¸€ä¸ªI/Oå¼•è„šï¼Œè¦ä¹ˆå¢åŠ ä¸€æ¡ä¸“ç”¨çš„I/Oæ€»çº¿ã€‚ç”±äºI/Oåœ°å€ç©ºé—´ä¸å†…å­˜åœ°å€ç©ºé—´æ˜¯éš”ç¦»çš„ï¼Œæ‰€ä»¥æœ‰æ—¶å°† PMIO ç§°ä¸ºè¢«éš”ç¦»çš„ IO(Isolated I/O)ã€‚
å¦‚ä½•å®ç° MMIO åœ¨Linuxä¸­ï¼Œ å†…æ ¸ä½¿ç”¨ioremap()å°†IOè®¾å¤‡çš„ç‰©ç†å†…å­˜åœ°å€æ˜ å°„åˆ°å†…æ ¸ç©ºé—´çš„è™šæ‹Ÿåœ°å€ä¸Šï¼› ç”¨æˆ·ç©ºé—´ç¨‹åºä½¿ç”¨mmap(2)ç³»ç»Ÿè°ƒç”¨å°†IOè®¾å¤‡çš„ç‰©ç†å†…å­˜åœ°å€æ˜ å°„åˆ°ç”¨æˆ·ç©ºé—´çš„è™šæ‹Ÿå†…å­˜åœ°å€ä¸Šï¼Œä¸€æ—¦æ˜ å°„å®Œæˆï¼Œç”¨æˆ·ç©ºé—´çš„ä¸€æ®µå†…å­˜å°±ä¸IOè®¾å¤‡çš„å†…å­˜å…³è”èµ·æ¥ï¼Œå½“ç”¨æˆ·è®¿é—®ç”¨æˆ·ç©ºé—´çš„è¿™æ®µå†…å­˜åœ°å€èŒƒå›´æ—¶ï¼Œå®é™…ä¸Šä¼šè½¬åŒ–ä¸ºå¯¹IOè®¾å¤‡çš„è®¿é—®ã€‚
å¦‚ä½•å¯åŠ¨ ä»¥ä¸‹æ˜¯ä¸€ä¸ªå¯åŠ¨è„šæœ¬ start.sh:
./qemu-system-x86_64 \ -m 1G \ -device strng \ -hda my-disk.img \ -hdb my-seed.img \ -nographic \ -L pc-bios/ \ -enable-kvm \ -device e1000,netdev=net0 \ -netdev user,id=net0,hostfwd=tcp::5555-:22 å…¶ä¸­ -device åé¢çš„æ˜¯è®¾å¤‡åã€‚</description>
    </item>
    
    <item>
      <title>2024 å¼ºç½‘æ¯é’å°‘èµ›çº¿ä¸Šèµ›é¢˜è§£</title>
      <link>http://littflower.github.io/posts/2024-qwbqs-writeup/</link>
      <pubDate>Mon, 25 Nov 2024 16:55:35 +0800</pubDate>
      
      <guid>http://littflower.github.io/posts/2024-qwbqs-writeup/</guid>
      <description>å‰è¨€ æˆ˜é˜Ÿåï¼šcrazyNAN
æˆ˜é˜Ÿæ’åï¼š6
æˆ˜é˜Ÿæ•´ä½“ç­”é¢˜æƒ…å†µï¼šé™¤ web æ–¹å‘ cyberboard mysqlprobe å¤–å‡è§£å‡ºã€‚
è¿™è¾ˆå­æœ€åä¸€æ¬¡æ‰“å¼ºç½‘æ¯é’å°‘èµ›äº†ï¼Œå› ä¸ºæˆ‘ä»Šå¹´åˆšæ»¡ 18 å²ï¼ˆï¼ˆï¼ˆ
ä¸€å¼€å§‹æŠŠè¿™äº‹æƒ…éƒ½å¿˜äº†ï¼Œè¿˜æ˜¯ Aura å¸ˆå‚…æ‹‰æˆ‘æˆ‘æ‰æƒ³èµ·æ¥ï¼Œæ‰“ç€ç©ç©ï¼Œè¯åˆè¯´å›æ¥åˆèµ›å’Œè¿™ b Aura æœ‰ä¸ªğŸ¥šçš„å…³ç³»å•Šï¼ˆï¼ˆ
å…¨é  ğŸ‘´ å’Œ ğŸŒ³ å¸¦é£ï¼ˆ
æ‚é±¼ Aura
Wp èµ›æ—¶å¼€äº†ä¸ªé£ä¹¦äº‘æ–‡æ¡£ï¼Œè¾¹æ‰“è¾¹å†™ wpï¼Œæ„Ÿè§‰ç¡®å®ä¸é”™ï¼Œä¸ç”¨èµ›åä¸“é—¨æ•´ç† wp äº†ã€‚
æˆ‘è¿™é‡Œå°±æŠŠæˆ‘åšçš„ pwn é¢˜å‘ä¸€ä¸‹ï¼Œå‰©ä¸‹çš„å¯ä»¥æˆ³è¿™ä¸ªé“¾æ¥çœ‹ exp
Pwn clock_in æ¿å­ ret2libcï¼Œexp:
from pwn import * from sys import argv proc = &amp;#34;./clock_in&amp;#34; context.log_level = &amp;#34;debug&amp;#34; context.binary = proc elf = ELF(proc, checksec=False) libc = ELF(&amp;#34;./libc.so.6&amp;#34;) io = remote(&amp;#34;101.200.61.16&amp;#34;, 34841) if argv[1] == &amp;#39;r&amp;#39; else process(proc) if args.</description>
    </item>
    
    <item>
      <title>è®ºæ–‡ç¬”è®°ã€ŠAddressSanitizer: A Fast Address Sanity Checkerã€‹</title>
      <link>http://littflower.github.io/posts/paper-notes-of-addresssanitizer-a-fast-address-sanity-checker/</link>
      <pubDate>Mon, 21 Oct 2024 19:14:44 +0800</pubDate>
      
      <guid>http://littflower.github.io/posts/paper-notes-of-addresssanitizer-a-fast-address-sanity-checker/</guid>
      <description>0x00. Abstract å¯¹äº C å’Œ C++ ç­‰ç¼–ç¨‹è¯­è¨€æ¥è¯´ï¼Œå†…å­˜è®¿é—®é”™è¯¯ï¼ˆåŒ…æ‹¬ç¼“å†²åŒºæº¢å‡ºå’Œ use after freeï¼‰ä»ç„¶æ˜¯ä¸€ä¸ªä¸¥é‡é—®é¢˜ã€‚å­˜åœ¨è®¸å¤šå†…å­˜é”™è¯¯æ£€æµ‹å™¨ï¼Œä½†å¤§å¤šæ•°æ£€æµ‹å™¨è¦ä¹ˆé€Ÿåº¦æ…¢ï¼Œè¦ä¹ˆå±€é™äºæœ‰é™çš„é”™è¯¯é›†ï¼Œæˆ–è€…ä¸¤è€…å…¼è€Œæœ‰ä¹‹ã€‚æœ¬æ–‡ä»‹ç»äº† AddressSanitizerï¼Œä¸€ç§æ–°çš„å†…å­˜é”™è¯¯æ£€æµ‹å™¨ã€‚è¿™ä¸ªå·¥å…·å¯ä»¥æŸ¥æ‰¾å¯¹å †ã€å †æ ˆå’Œå…¨å±€å˜é‡çš„è¶Šç•Œè®¿é—®ï¼Œä»¥åŠ use after freeã€‚å®ƒé‡‡ç”¨ä¸“é—¨çš„å†…å­˜åˆ†é…å™¨å’Œä»£ç å·¥å…·ï¼Œè¶³å¤Ÿç®€å•ï¼Œå¯ä»¥åœ¨ä»»ä½•ç¼–è¯‘å™¨ã€äºŒè¿›åˆ¶ç¿»è¯‘ç³»ç»Ÿç”šè‡³ç¡¬ä»¶ä¸­å®ç°ã€‚AddressSanitizer åœ¨ä¸ç‰ºç‰²å…¨é¢æ€§çš„æƒ…å†µä¸‹å®ç°äº†æ•ˆç‡ã€‚å®ƒçš„å¹³å‡é€Ÿåº¦ä»…ä¸º 73%ï¼Œä½†å®ƒå¯ä»¥åœ¨é”™è¯¯å‘ç”Ÿæ—¶å‡†ç¡®åœ°æ£€æµ‹åˆ°é”™è¯¯ã€‚å®ƒåœ¨ Chromium æµè§ˆå™¨ä¸­å‘ç°äº† 300 å¤šä¸ªä»¥å‰æœªçŸ¥çš„é”™è¯¯ï¼Œä»¥åŠå…¶ä»–è½¯ä»¶ä¸­çš„è®¸å¤šé”™è¯¯ã€‚
0x01. Introduction AddressSanitizer ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šæ£€æµ‹æ¨¡å—å’Œè¿è¡Œæ—¶åº“ã€‚æ£€æµ‹æ¨¡å—ä¿®æ”¹ä»£ç ä»¥æ£€æŸ¥æ¯æ¬¡å†…å­˜è®¿é—®çš„å½±å­æ€ (shadow state)ï¼Œå¹¶åœ¨å †æ ˆå’Œå…¨å±€å¯¹è±¡å‘¨å›´åˆ›å»ºä¸­æ¯’çº¢åŒºä»¥æ£€æµ‹å‘ä¸Šæˆ–å‘ä¸‹æº¢å‡ºã€‚å½“å‰çš„å®ç°åŸºäº LLVM ç¼–è¯‘å™¨åŸºç¡€è®¾æ–½ã€‚è¿è¡Œæ—¶åº“æ›¿æ¢äº† mallocã€free å’Œç›¸å…³å‡½æ•°ï¼Œåœ¨åˆ†é…çš„å †åŒºåŸŸå‘¨å›´åˆ›å»ºä¸­æ¯’çº¢åŒºï¼Œå»¶è¿Ÿå·²é‡Šæ”¾å †åŒºåŸŸçš„é‡ç”¨ï¼Œå¹¶è¿›è¡Œé”™è¯¯æŠ¥å‘Šã€‚
æ€»çš„æ¥è¯´ï¼Œè¿™ç¯‡æ–‡ç« åšäº†ä»¥ä¸‹å‡ ä»¶äº‹ï¼š
è¯´æ˜äº†å†…å­˜é”™è¯¯æ£€æµ‹å™¨å¯ä»¥åˆ©ç”¨å½±å­å†…å­˜ shadow memoryçš„å…¨é¢æ€§ï¼Œå¹¶ä¸”å¼€é”€æ¯”ä¼ ç»Ÿæ–¹æ³•ä½å¾—å¤šï¼› æå‡ºä¸€ç§æ–°é¢–çš„å½±å­æ€ç¼–ç æ–¹å¼ï¼Œå¯å®ç°ç´§å‡‘çš„å½±å­å†…å­˜ï¼ˆé«˜è¾¾ 128-to-1ï¼‰ï¼Œç”¨äºæ£€æµ‹è¶Šç•Œå’Œ use-after-free é”™è¯¯ï¼› æè¿°ä¸€ä¸ªé’ˆå¯¹æ–°å®ç°çš„å½±å­ç¼–ç çš„ä¸“ç”¨å†…å­˜åˆ†é…å™¨ï¼› è¯„ä¼°ä¸€ä¸ªæ–°çš„å…¬å¼€å¯ç”¨çš„å·¥å…·ï¼Œè¯¥å·¥å…·å¯ä»¥æœ‰æ•ˆåœ°è¯†åˆ«å†…å­˜é”™è¯¯ã€‚ 0x02. Related work å½±å­å†…å­˜ï¼ˆshadow memoryï¼‰ æ€»çš„æ¥è¯´ï¼ŒæŒ‰ç…§å¯¹åº”ç”¨ç¨‹åºåœ°å€çš„å¤„ç†å¯ä»¥æŠŠç°æœ‰çš„å·¥å…·åˆ†ä¸ºä¸¤ç§ï¼š
é€šè¿‡ç›´æ¥ç¼©æ”¾å’Œåç§»ï¼ˆå…¶ä¸­å®Œæ•´åº”ç”¨ç¨‹åºåœ°å€ç©ºé—´æ˜ å°„åˆ°å•ä¸ªå½±å­åœ°å€ç©ºé—´ï¼‰ï¼› é€šè¿‡æ¶‰åŠæŸ¥è¡¨çš„é¢å¤–è½¬æ¢æ¥æ˜ å°„åˆ°å½±å­åœ°å€ç©ºé—´ã€‚ ç›´æ¥ç¼©æ”¾å’Œåç§»çš„ä¾‹å­æœ‰ï¼š
TaintTrace LIFT ä½¿ç”¨å¤šçº§è½¬æ¢çš„ä¾‹å­æœ‰ï¼š
Valgrind Dr.Memory è¿˜æœ‰ä¸€äº›æ¯”è¾ƒ trick çš„å·¥å…·ï¼š
Umbraï¼šå…¼é¡¾å¸ƒå±€çµæ´»æ€§å’Œæ•ˆç‡ï¼Œä½¿ç”¨å¯åŠ¨æ€è°ƒæ•´çš„ç¼©æ”¾å’Œåç§»æ¥ç›´æ¥æ˜ å°„åœ°å€è€Œéä½¿ç”¨æŸ¥è¡¨çš„æ–¹å¼ï¼› BoundLessï¼šåˆ©ç”¨ 64 ä½å¯„å­˜å™¨çš„é«˜ 16 ä½æ¥åšåˆ°å†…å­˜å¤ç”¨ï¼Œä½†æ˜¯åœ¨æ…¢é€Ÿè·¯å¾„ä¸‹ä¼šé€€åŒ–ï¼› LBCï¼šä½¿ç”¨å­˜å‚¨åœ¨åº”ç”¨ç¨‹åºå†…å­˜ä¸­çš„ç‰¹æ®Šå€¼æ‰§è¡Œå¿«é€Ÿè·¯å¾„çš„æ£€æŸ¥ï¼Œå¹¶åœ¨æ…¢é€Ÿè·¯å¾„ä¸Šä¾èµ–äºä¸¤çº§å½±å­å†…å­˜ã€‚ å®ç° å¤§éƒ¨åˆ†å†…å­˜æ£€æµ‹å·¥å…·éƒ½åŸºäºäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè¿™äº›å·¥å…·å¯ä»¥å‘ç°å †å†…å­˜çš„è¶Šç•Œå’Œ UAFï¼Œè¿˜å¯ä»¥è¯†åˆ«æœªåˆå§‹åŒ–çš„è¯»å–ï¼Œä¸è¿‡æ²¡åŠæ³•è¯†åˆ«å †æ ˆå’Œå…¨å±€å˜é‡çš„è¶Šç•Œé”™è¯¯ï¼Œå¥½æ¶ˆæ¯æ˜¯åŸºæœ¬ä¸ä¼šè¯¯æŠ¥ã€‚ä¾‹å¦‚ï¼šValgrindï¼ŒDr.Memoryï¼ŒDiscoverï¼ŒBoundsChecker ç­‰ç­‰
è€Œä½¿ç”¨ç¼–è¯‘æ—¶æ£€æµ‹çš„å·¥å…·è™½ç„¶å¯ä»¥æ£€æµ‹å †æ ˆå¯¹è±¡çš„è¶Šç•Œè®¿é—®ï¼Œä½†æ˜¯æ— æ³•æ£€æµ‹æ‰€æœ‰çš„å †æ ˆç¼“å†²åŒºæº¢å‡ºé”™è¯¯ï¼Œè€Œä¸”å¯èƒ½è¯¯æŠ¥ï¼Œä¾‹å¦‚ Mudflapã€‚</description>
    </item>
    
    <item>
      <title>T1DCTF2024 WriteUp</title>
      <link>http://littflower.github.io/posts/t1dctf2024-writeup/</link>
      <pubDate>Tue, 14 May 2024 14:36:43 +0800</pubDate>
      
      <guid>http://littflower.github.io/posts/t1dctf2024-writeup/</guid>
      <description>è¡¥ä¸€ä¸‹äºŒé˜Ÿå†…æµ‹é¢˜ã€‚
repeater [easy] Repeater
As is well known, CTFers are all repeaters!
æ ˆæº¢å‡ºé¢˜ç›®ï¼Œsub_11C9() å¯ä»¥æ ˆæº¢å‡ºï¼Œåªä¿®æ”¹è¿”å›åœ°å€çš„ 1 å­—èŠ‚ï¼Œå¯ä»¥åšåˆ° partial overwrite æ— é™å¾ªç¯ sub_11C9() è¯»å…¥ payloadã€‚
è¿™é‡Œè®²ä¸€ä¸‹ fread ç­‰ FILE ç›¸å…³å‡½æ•°ï¼Œåé¢ä¹Ÿä¼šç”¨åˆ°ã€‚
C è¯­è¨€ FILE å‡½æ•°
æ—¢ç„¶æ²¡æœ‰ç©ºå­—ç¬¦é˜¶æ®µï¼Œprintf å°±ä¼šæŠŠ retaddr æ‰“å°å‡ºæ¥ï¼Œä»è€Œè·å¾— pie baseã€‚
æ¥ä¸‹æ¥çš„é—®é¢˜æ˜¯æ€ä¹ˆæ³„æ¼ libcï¼Œropper å‘ç°ç¨‹åºæ²¡æœ‰ä¸€ä¸ªèƒ½ç”¨æ¥æ§åˆ¶ rdi çš„ gadgetsï¼Œç»†å¿ƒä¼šå‘ç°ç¨‹åºåœ¨ç»“æŸ printf åå¯„å­˜å™¨ rdi ä¸Šå±…ç„¶è¿˜ä¿å­˜ç€ libc å‡½æ•°çš„åœ°å€ï¼Œé‚£ç›´æ¥ call puts å°±å¯ä»¥æ³„æ¼äº†ã€‚
from pwn import * proc = &amp;#34;./pwn&amp;#34; context.binary = proc context.log_level = &amp;#34;debug&amp;#34; io = process(proc) # io = remote(&amp;#34;tld1027.</description>
    </item>
    
    <item>
      <title>foolctf 2024 WriteUp å’Œä¸€äº›å…³äº shellcode çš„åæ€</title>
      <link>http://littflower.github.io/posts/t1d_foolctf-2024-writeups/</link>
      <pubDate>Tue, 09 Apr 2024 18:49:09 +0800</pubDate>
      
      <guid>http://littflower.github.io/posts/t1d_foolctf-2024-writeups/</guid>
      <description>æ„šäººèŠ‚çš„æ—¶å€™ t1d åœ¨ç¾¤é‡Œæ‰”äº†ä¸¤é“é¢˜ï¼Œè¯´æ˜¯æ„šäººèŠ‚ctf&amp;hellip;
åšäº†ä¹‹åå‘ç°è‡ªå·±æ˜¯æ„šäººäº†
facker é¢˜ç›®åˆ†æ å…ˆæ¥çœ‹çœ‹ç¨‹åºä¸»ä½“é€»è¾‘ï¼š
en&amp;hellip;. å¤§æ¦‚è¯»ä¸€éå¯ä»¥ç¡®å®šè¿™æ˜¯ä¸ª orw é¢˜ï¼Œä¸è¿‡ä¸€ä¸ªå·¨å¤§çš„ random ç³Šåœ¨è„¸ä¸Šé¢„ç¤ºç€è¿™é¢˜å¯èƒ½ä¸å¤ªå¥½æ‰“ï¼Œä¸‹é¢æœ‰ä¸ª encrypt å‡½æ•°ï¼Œä¼šä¸€æ¬¡åŠ å¯† 16 å­—èŠ‚ï¼Œè·Ÿè¿›å»çœ‹çœ‹ï¼š
è¿™ä¸ªåŠ å¯†ç®—æ³•åˆ†ä¸¤éƒ¨åˆ†ï¼Œå‰åŠéƒ¨åˆ†å¯ä»¥è¯†åˆ«å‡ºæ˜¯ä¸ª base64 çš„ decodeï¼ŒååŠéƒ¨åˆ†æ˜¯ç”¨åˆšæ‰è¯»çš„éšæœºæ•°å¼‚æˆ–ç¼–ç  16 å­—èŠ‚çš„å‰ 12 å­—èŠ‚ã€‚
ä¸€å¼€å§‹æƒ³ç€èƒ½ä¸èƒ½æŠŠ random ç»™ç»•äº†ï¼Œä½†æ˜¯ t1d è‚¯å®šé˜²äº†è¿™ä¸ªï¼š
fd = open(&amp;#34;/dev/random&amp;#34;, 0); for ( i = 0; i != 16; i = strlen(buf) ) read(fd, buf, 0x10uLL); è¿™ä¸ªå†™æ³•ä¼šé˜²æ­¢è¯» random æ—¶é¦–å­—èŠ‚ä¸ºç©ºå­—èŠ‚å¯¼è‡´çš„æˆªæ–­é—®é¢˜ã€‚æ‰€ä»¥è¿™ä¸œè¥¿è‚¯å®šæ˜¯ç»•ä¸äº†äº†ã€‚
å†è€…ï¼Œå…³äºè¿™ä¸ª base64ï¼Œå¯ä»¥æ³¨æ„åˆ°è¿™ä¸ª decode å¹¶æ²¡æœ‰ç›´æ¥åœ¨ a1 ä¸Šåšï¼Œä¹Ÿå°±æ˜¯å¹¶æ²¡æœ‰ä¿®æ”¹æˆ‘ä»¬è¾“è¿›å»çš„ orwï¼ŒçœŸæ­£ä¿®æ”¹ orw çš„æ˜¯åé¢çš„å¼‚æˆ–è¿ç®—ã€‚
ï¼ˆè¿™é‡Œæˆ‘ç‹ ç‹ è¸©å‘äº†ï¼Œåšé¢˜çš„æ—¶å€™å¤„äºé€†å‘ä¹ æƒ¯ä¸€ç›´åœ¨æƒ³ç€æ€ä¹ˆé€†è¿™ä¸œè¥¿ï¼Œå…¶å®ä»å®è§‚ä¸€ç‚¹çš„è§’åº¦æ€è€ƒå°±ä¼šå‘ç°æ²¡æœ‰ä¿®æ”¹ orw çš„ base64 decode() æˆ‘ä»¬æ˜¯å®Œå…¨å¯ä»¥ä¸ç”¨ç†ä¼šçš„ï¼‰
æ€»ç»“ä¸€ä¸‹ï¼Œå¯ä»¥è¾“å…¥ 66 ä¸ªå­—èŠ‚ï¼Œå‰ 2 ä¸ªå­—èŠ‚ä¸ä½œå¤„ç†ï¼Œä¹‹åçš„ 64 ä¸ªå­—èŠ‚åˆ†ä¸º 4 ç»„ï¼Œæ¯ç»„åªä¿®æ”¹äº† 16 ä¸ªå­—èŠ‚çš„å‰ 12 ä¸ªå­—èŠ‚ã€‚</description>
    </item>
    
    <item>
      <title>Unbreakable CTF 2024é¢˜è§£åŠåæ€</title>
      <link>http://littflower.github.io/posts/unbreakablectf2024-writeup/</link>
      <pubDate>Mon, 08 Apr 2024 22:33:57 +0800</pubDate>
      
      <guid>http://littflower.github.io/posts/unbreakablectf2024-writeup/</guid>
      <description>Unbreakable CTF 2024 Pwn WriteUps å’Œ NAN çš„é˜Ÿå‹ä¸€èµ·æ‰“äº† UnbreakableCTF 2024 çš„äºŒè¿›åˆ¶æ–¹å‘ï¼ŒåŠ¨æ‰‹åšäº†ä¸¤é“é¢˜ï¼Œå£èƒ¡äº†ä¸€é“å †é¢˜ï¼Œæœ‰ä¸€äº›æ„Ÿæ‚Ÿå’Œåæ€æ”¾åœ¨è¿™é‡Œã€‚
harder_assembly æ€è·¯ ä¸€é“ x64 çš„shellcode é¢˜ï¼Œéš¾ç‚¹æ˜¯ç¦æ­¢åœ¨ shellcode é‡Œä½¿ç”¨ syscall ä»¥åŠshellcode é•¿åº¦åªæœ‰ 15 å­—èŠ‚ã€‚
åè€…æ¯”è¾ƒå¥½è§£å†³ï¼Œå¯ä»¥è€ƒè™‘ç›´æ¥è°ƒç”¨ read æ„é€ äºŒæ¬¡è¾“å…¥ï¼Œè¿™æ ·äºŒæ¬¡è¾“å…¥çš„æ—¶å€™å°±æ²¡æœ‰é•¿åº¦é™åˆ¶äº†ï¼Œæ„é€  orw å³å¯ã€‚
è¿™é‡Œæˆ‘é‡åˆ°çš„çŸ¥è¯†ç›²åŒºä¸»è¦æ˜¯ç¦ç”¨äº† syscallï¼Œè§£å†³æ–¹æ³•æ˜¯ä½¿ç”¨ int 0x80ï¼ˆå³ç»§ç»­ä½¿ç”¨ x32 APIï¼‰
ç¿»äº†ä¸€ä¸‹ stackoverflowï¼Œæ³¨æ„åˆ°è¿™æ ·ä¸€æ®µè¯ï¼š
When called from a 64-bit program it behaves the same way it would behave like if it has been called from a 32-bit program (using the 32-bit calling convention).
This also means that the parameters for &amp;ldquo;int 0x80&amp;rdquo; will be passed in 32-bit registers and the upper 32 bits of the 64-bit registers are ignored.</description>
    </item>
    
    <item>
      <title>AsisCTF2016 b00ks å¤ç°ç¬”è®°</title>
      <link>http://littflower.github.io/posts/asisctf2016-b00ks/</link>
      <pubDate>Tue, 23 Jan 2024 00:25:35 +0800</pubDate>
      
      <guid>http://littflower.github.io/posts/asisctf2016-b00ks/</guid>
      <description>è®°ä¸€é“ offbyone å †é¢˜çš„å¤ç°ã€åæ€ä¸æ€»ç»“ å¤ç° é¢˜ç›®ä»‹ç» é¢˜ç›®é“¾æ¥
èœå•é¢˜ï¼Œé€‰å•å¦‚ä¸‹ï¼Œå…¶ä¸­ create åŠŸèƒ½ä¼šåˆ›å»ºä¸€ä¸ª bookï¼Œedit åŠŸèƒ½åªèƒ½ä¿®æ”¹ book çš„ descriptionï¼Œprint åŠŸèƒ½ä¼šæ‰“å° book çš„ id/name/description/author, delete åŠŸèƒ½ä¼š free æ‰ book name/book description/book self ï¼š
1. Create a book 2. Delete a book 3. Edit a book 4. Print book detail 5. Change current author name 6. Exit é¢˜ç›®æ¯åˆ›å»ºä¸€ä¸ª bookï¼Œä¼šæ¶‰åŠåˆ°ä¸¤ä¸ªç”¨äºç»´æŠ¤çš„æ•°æ®ç»“æ„ï¼šä¸€ä¸ªæ˜¯ book struct æœ¬èº«ï¼Œä¸€ä¸ªæ˜¯ book listã€‚
book struct ç»“æ„å¦‚ä¸‹ï¼Œæ¯ä¸ª book struct è€—ç”¨å†…å­˜ç©ºé—´å¤§å°ä¸º 0x20ï¼š
struct book { int id; char *name; char *description; int size; } book list åˆ™æ˜¯ç”¨æ¥å­˜æ”¾ book çš„æ•°ç»„ï¼Œä¸»è¦ç”¨åœ¨ delete a book å’Œ edit a book åŠŸèƒ½ä¸­ã€‚</description>
    </item>
    
    <item>
      <title>MoeCTF 2023 Pwn é¢˜ç›®å¤ç°</title>
      <link>http://littflower.github.io/posts/moectf-2023-pwn-writeup/</link>
      <pubDate>Sun, 12 Nov 2023 18:08:44 +0800</pubDate>
      
      <guid>http://littflower.github.io/posts/moectf-2023-pwn-writeup/</guid>
      <description>MoeCTF2023 Pwn WriteUp å‰è¨€ ä»Šå¹´æš‘å‡æ¯”è¾ƒæ‘†çƒ‚&amp;hellip; æœ€åä¹Ÿæ²¡åšå®Œ MoeCTF çš„ pwn é¢˜, åªèƒ½èµ›åæŠ½æ—¶é—´å¤ç°ä¸€é. å¤ç°ä¸€éä¹‹åè¿˜æ˜¯å¤ä¹ äº†ä¸å°‘çŸ¥è¯†ç‚¹, å†™ä¸€ç¯‡ wp ä»¥ä½œç¬”è®°.
é¢˜ç›®å¤ç° test_nc è¿æ¥å³å¯.
baby_calculator emmm æ‰“ä¸€ä¸ªäº¤äº’å°±å¯ä»¥äº†.
fd fd å³ file descripter, åˆå«æ–‡ä»¶æè¿°ç¬¦, å®ƒæ˜¯ä¸€ä¸ªæŠ½è±¡çš„æŒ‡ç¤ºç¬¦, ç”¨ä¸€ä¸ªéè´Ÿæ•´æ•°è¡¨ç¤º.å®ƒæŒ‡å‘äº†ç”±ç³»ç»Ÿå†…æ ¸ç»´æŠ¤çš„ä¸€ä¸ª file table ä¸­çš„æŸä¸ªæ¡ç›® ( entry ), åè€…åˆæŒ‡å‘å‚¨å­˜æ–‡ä»¶çœŸå®åœ°å€çš„ inode table.
ä¸€èˆ¬æ¥è¯´æ“ä½œç³»ç»Ÿä¼šä¸ºæ¯ä¸ªç”¨æˆ·è¿›ç¨‹é¢„ç•™ä¸‰ä¸ªé»˜è®¤çš„ fd: stdin, stdout, stderr. å®ƒä»¬å¯¹åº”çš„éè´Ÿæ•´æ•°å€¼åˆ†åˆ«ä¸º 0, 1, 2. ä¹‹åçš„ fd ä» 3 å¼€å§‹åˆ†é….
åç¼–è¯‘å¾—åˆ°æ ¸å¿ƒä»£ç :
fd = open(&amp;#34;./flag&amp;#34;, 0, 0LL); new_fd = (4 * fd) | 0x29A; dup2(fd, new_fd); // å°† new_fd é‡å®šå‘åˆ° fd close(fd); puts(&amp;#34;Which file do you want to read?</description>
    </item>
    
    <item>
      <title>2022å¼ºç½‘æ¯é’å°‘èµ›é¢˜è§£</title>
      <link>http://littflower.github.io/posts/2022-qwbqs-writeup/</link>
      <pubDate>Fri, 03 Feb 2023 21:27:43 +0000</pubDate>
      
      <guid>http://littflower.github.io/posts/2022-qwbqs-writeup/</guid>
      <description>Qwb-é’å°‘èµ›-2022-WP å‰è¨€ è’Ÿè’»æ¥å†™ WP äº†&amp;hellip;&amp;hellip; æœ¬æ¥åº”è¯¥æ˜¯å¯ä»¥è¿›çº¿ä¸‹çš„&amp;hellip;å¥ˆä½•å·¥å…·å¤ªè€æ—§&amp;hellip;æ˜å¹´å†åŠªåŠ›å§.
é¡ºå¸¦ä¸€æï¼Œæ²¡è¡¥ pwn é¢˜ï¼ˆï¼ˆï¼ˆ
åˆ«é—®æˆ‘ä¸ºä»€ä¹ˆç°åœ¨æ‰å‘
Misc miscé¢˜å®åœ¨æ˜¯åšéº»äº†
misc é¢˜æ€è·¯éƒ½æ˜¯å¯¹çš„&amp;hellip;è„šæœ¬å‡äº†&amp;hellip;
Misc1 é¢˜ç›®é“¾æ¥ï¼šLink
é¦–å…ˆæ‹¿åˆ°ä¸€ä¸ª png å›¾ç‰‡ï¼Œç”¨ 010 editor æŸ¥çœ‹ï¼Œæ ¹æ®æ–‡ä»¶å¤´å¯ä»¥å‘ç°å®ƒæ˜¯äº¤æ¢äº†å¥‡å¶æ•°ä½é¡ºåºåçš„åŠ å¯†å›¾ç‰‡ã€‚
50 89 47 4E 0A 0D 0A 1A 00 00 0D 00 48 49 52 44 00 00 BD 02 00 00 6D 02 06 08 00 00 3B 00 C8 1A 00 F7 00 01 49 00 41 44 78 54 EC 9C D9 FD 1C 93 äºæ˜¯ç¬¬ä¸€æ­¥è§£å¯†ï¼š</description>
    </item>
    
    <item>
      <title>TPCTF2025 WriteUp</title>
      <link>http://littflower.github.io/posts/tpctf2025-writeup/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://littflower.github.io/posts/tpctf2025-writeup/</guid>
      <description>å’Œ n1 çš„å¸ˆå‚…ä¸€èµ·æ‰“äº†è¿™åœºæ¯”èµ›ï¼Œç”±äºä¸ä¼š web pwn å’Œ iotï¼Œè¿™åœºåŸºæœ¬ä¸Šåªèƒ½æ‰“ç­¾åˆ°å †é¢˜wwww
å¸ˆå‚…ä»¬ tql
ezdb Glibc 2.35ï¼Œæ´åœ¨è¿™é‡Œï¼š
__int16 __fastcall TablePage::InsertRecord(TablePage *this, Record *record) { int Size; // [rsp+10h] [rbp-10h] int v4; // [rsp+14h] [rbp-Ch] Size = Record::GetSize(record); if ( TablePage::GetFreeSpaceSize(this) &amp;lt; (Size + 4LL) ) return -1; LOWORD(v4) = this-&amp;gt;end - Size - this-&amp;gt;page; HIWORD(v4) = Size; *this-&amp;gt;start = v4; this-&amp;gt;start = (this-&amp;gt;start + 4); memcpy(this-&amp;gt;end - Size, record-&amp;gt;content, Size); // off by one this-&amp;gt;end = (this-&amp;gt;end - Size); return (LOWORD(this-&amp;gt;start) - 4 - LOWORD(this-&amp;gt;page)) &amp;gt;&amp;gt; 2; } è¿™ä¸ªåœ°æ–¹æœ‰ä¸€ä¸ªæº¢å‡ºï¼Œå¯ä»¥ä¿®æ”¹ Page çš„ lengthï¼Œè¿™ä¸ª length ä¼šè¢«ç”¨åœ¨åé¢ show å’Œ edit åŠŸèƒ½é‡Œï¼Œä¾‹å¦‚ editï¼š</description>
    </item>
    
  </channel>
</rss>
